import{d as P,r as g,a as J,a2 as K,o as M,J as h,e as f,f as y,g as d,h as r,j as N,k as O,y as t,l as a,E as z,F as B,m as T,K as V,I as G,_ as H}from"./index-BGgofOm4.js";import{B as k}from"./BusinessData-Dur53bjV.js";import{a as Q,c as W}from"./productAttributesTpl-BtbeavO4.js";const X={class:"container"},Y={class:"content_wrapper"},Z={class:"lyecs-form-table"},ee={class:"attr-warp-box"},te=["onClick"],ae={class:"attr-warp-box"},le=["onClick"],oe={class:"attr-warp-box"},se=["onClick"],ne=P({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(S,{expose:R,emit:F}){const v=F,_=S,b=g(!0),U=J().currentRoute.value.query,x=g(_.isDialog?_.act:String(U.act)),$=g(_.isDialog?_.id:Number(U.id)),I=x.value==="add"?"create":"update",A=K(),l=g({});M(()=>{x.value==="detail"?j():b.value=!1});const j=async()=>{try{const o=await Q(x.value,{id:$.value});Object.assign(l.value,o)}catch(o){h.error(o.message),v("close")}finally{b.value=!1}},C=(o,e)=>{l.value.tplData[o].splice(e,1)},D=o=>{if(l.value.tplData)Array.isArray(l.value.tplData[o])||(l.value.tplData[o]=[]);else{let e={};e[o]=[],l.value.tplData=e}l.value.tplData[o].push({attrName:""})},L=async()=>{await A.value.validate();try{console.log(l.value),v("update:confirmLoading",!0);const o=await W(I,{id:$.value,...l.value});v("submitCallback",o),h.success("操作成功")}catch(o){h.error(o.message)}finally{v("update:confirmLoading",!1)}};return R({onFormSubmit:()=>{L()}}),(o,e)=>{const m=f("el-form-item"),c=f("el-space"),w=f("el-button"),q=f("el-form"),E=f("a-spin");return d(),y("div",X,[r("div",Y,[r("div",Z,[b.value?O("",!0):(d(),N(q,{key:0,ref_key:"formRef",ref:A,model:l.value,"label-width":"auto"},{default:a(()=>[t(m,{rules:[{required:!0,message:"属性模板名称不能为空!"}],label:"属性模板名称",prop:"tplName"},{default:a(()=>[t(k,{modelValue:l.value.tplName,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.tplName=s),width:"350px",dataType:8},null,8,["modelValue"])]),_:1}),t(m,{label:"属性名称",prop:"brandLogo"},{default:a(()=>{var s,u;return[r("div",ee,[(d(!0),y(B,null,T((u=(s=l.value)==null?void 0:s.tplData)==null?void 0:u.normal,(n,p)=>(d(),N(c,{class:"attr-row"},{default:a(()=>[t(k,{modelValue:n.attrName,"onUpdate:modelValue":i=>n.attrName=i,width:"260px",dataType:8},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>C("normal",Number(p))},null,8,te)]),_:2},1024))),256)),t(c,{class:"attr-row"},{default:a(()=>[t(w,{onClick:e[1]||(e[1]=n=>D("normal"))},{default:a(()=>e[5]||(e[5]=[r("i",{class:"btn-ico"},"+",-1),V("增加新属性",-1)])),_:1,__:[5]})]),_:1})])]}),_:1}),t(m,{label:"规格名称"},{default:a(()=>{var s,u;return[r("div",ae,[(d(!0),y(B,null,T((u=(s=l.value)==null?void 0:s.tplData)==null?void 0:u.spe,(n,p)=>(d(),N(c,{class:"attr-row"},{default:a(()=>[t(k,{modelValue:n.attrName,"onUpdate:modelValue":i=>n.attrName=i,width:"260px",dataType:8},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>C("spe",Number(p))},null,8,le)]),_:2},1024))),256)),t(c,{class:"attr-row"},{default:a(()=>[t(w,{onClick:e[2]||(e[2]=n=>D("spe"))},{default:a(()=>e[6]||(e[6]=[r("i",{class:"btn-ico"},"+",-1),V("增加新规格",-1)])),_:1,__:[6]})]),_:1})])]}),_:1}),t(m,{label:"附加规格"},{default:a(()=>{var s,u;return[r("div",oe,[(d(!0),y(B,null,T((u=(s=l.value)==null?void 0:s.tplData)==null?void 0:u.extra,(n,p)=>(d(),N(c,{class:"attr-row"},{default:a(()=>[t(k,{modelValue:n.attrName,"onUpdate:modelValue":i=>n.attrName=i,width:"260px",dataType:8},null,8,["modelValue","onUpdate:modelValue"]),r("div",{class:"iconfont icon-cha1 btn-remove",onClick:i=>C("extra",Number(p))},null,8,se)]),_:2},1024))),256)),t(c,{class:"attr-row"},{default:a(()=>[t(w,{onClick:e[3]||(e[3]=n=>D("extra"))},{default:a(()=>e[7]||(e[7]=[r("i",{class:"btn-ico"},"+",-1),V("增加附加规格",-1)])),_:1,__:[7]})]),_:1})])]}),_:1}),z(t(m,{"wrapper-col":{offset:4,span:16}},{default:a(()=>[t(w,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:e[4]||(e[4]=s=>L())},{default:a(()=>e[8]||(e[8]=[V("提交 ",-1)])),_:1,__:[8]},512)]),_:1},512),[[G,!S.isDialog]])]),_:1},8,["model"])),t(E,{spinning:b.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),ce=H(ne,[["__scopeId","data-v-ef74de50"]]);export{ce as default};
