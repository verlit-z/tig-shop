import{d as S,a as x,r as f,a2 as N,e as d,f as I,g as R,h as s,y as r,l as u,K as T,t as h,J as m}from"./index-BGgofOm4.js";import{a as q,d as A}from"./accountManage-BXSZXCSO.js";const B={class:"container"},M={class:"content_wrapper"},k={class:"lyecs-form-table"},F=S({__name:"Password",props:{id:{type:Number,default:0},adminId:{type:Number,default:0},act:{type:String,default:""},type:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(_,{expose:y,emit:v}){const l=v,n=_,w=x().currentRoute.value.query,g=f(n.isDialog?n.id:Number(w.id)),p=N(),e=f({});(async()=>{try{const t=await q({id:g.value,adminId:n.adminId,type:n.type});e.value=t}catch(t){m.error(t.message),l("close")}})();const b=(t,a,o)=>{if(a)if(a!==e.value.password){o(new Error("两次密码输入不一致"));return}else o();else{o(new Error("请输入确认密码"));return}},C=async()=>{await p.value.validate();try{l("update:confirmLoading",!0);const t=await A(e.value);l("submitCallback",t),m.success("操作成功")}catch(t){m.error(t.message)}finally{l("update:confirmLoading",!1)}};return y({onFormSubmit:()=>{C()}}),(t,a)=>{const o=d("el-form-item"),c=d("TigInput"),V=d("el-form");return R(),I("div",B,[s("div",M,[s("div",k,[r(V,{ref_key:"formRef",ref:p,model:e.value,"label-width":"auto"},{default:u(()=>[r(o,{label:"账号名称"},{default:u(()=>[T(h(e.value.username),1)]),_:1}),r(o,{label:"修改密码",prop:"password",rules:[{required:!0,message:"请输入密码"}]},{default:u(()=>[r(c,{classType:"tig-form-input",modelValue:e.value.password,"onUpdate:modelValue":a[0]||(a[0]=i=>e.value.password=i),type:"password"},null,8,["modelValue"])]),_:1}),r(o,{label:"确认密码",prop:"pwdConfirm",rules:[{required:!0,validator:b}]},{default:u(()=>[s("div",null,[s("div",null,[r(c,{classType:"tig-form-input",modelValue:e.value.pwdConfirm,"onUpdate:modelValue":a[1]||(a[1]=i=>e.value.pwdConfirm=i),type:"password"},null,8,["modelValue"])]),a[2]||(a[2]=s("div",{class:"extra"},"注意：修改密码会影响到此账号登录后台的所有角色账号（比如管理员、店铺、门店、供应商等）",-1))])]),_:1},8,["rules"])]),_:1},8,["model"])])])])}}});export{F as default};
