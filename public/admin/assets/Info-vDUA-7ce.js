import{d as H,r as v,a as P,a2 as Q,a9 as W,o as X,e as i,f as b,g as s,h as x,j as p,k as f,y as l,l as o,E as Y,i as A,F as k,m as Z,K as w,t as I,I as $,z as ee,J as h,_ as ae}from"./index-BGgofOm4.js";import{i as te}from"./format-CpNC4fsQ.js";import"./index-BdoKLCH8.js";import"./vuedraggable.umd-CLczY9wy.js";import"./BusinessImg-Dt_2PeVb.js";import"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-CloSefEz.js";import{U as le}from"./UploadAvatar-D_DE6J2b.js";import{a as oe,c as re,u as se}from"./adminUser-CQS10PSg.js";import ne from"./AuthoritySelect-CCBB3oup.js";import"./index-BS7Hjr9I.js";import"./Image.vue_vue_type_script_setup_true_lang-oDjiJjwB.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-BTf40oxg.js";import"./avatar-D6FT3s3w.js";const de={class:"container"},ue={class:"content_wrapper"},ie={class:"lyecs-form-table"},me={class:"empty-warp"},pe={key:0,class:"empty-bg"},fe=H({__name:"Info",props:{id:{type:Number,default:0},suppliersId:{type:Number,default:0},act:{type:String,default:""},type:{type:String,default:""},adminType:{type:String,default:"admin"},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(m,{expose:D,emit:F}){const g=F,c=m,y=v(!0),L=P().currentRoute.value.query,U=v(c.isDialog?c.act:String(L.act)),N=v(c.isDialog?c.id:Number(L.id)),T=U.value==="add"?"create":"update",q=Q(),e=W({userId:""}),C=v(),R=v({}),S=v(!0),j=async()=>{var d,t;try{const n=await oe(U.value,{id:N.value});R.value=n.user,Object.assign(e,n),(d=C.value)!=null&&d.some(V=>V.roleId===e.roleId)||(e.roleId=0),e.mobile=((t=n.adminUser)==null?void 0:t.mobile)||n.mobile;let r=ee(String(e.avatar));r=="one"?S.value=!0:r=="def"&&(S.value=!1)}catch(n){h.error(n.message),g("close")}finally{y.value=!1}},z=async()=>{try{const d=await re();C.value=d}catch(d){h.error(d.message)}};X(()=>{z(),U.value==="detail"?j():y.value=!1,T!="update"&&c.type==="suppliers"&&(e.roleId=2,e.suppliersId=c.suppliersId)});const B=async()=>{await q.value.validate();try{g("update:confirmLoading",!0);let d={avatar:""};!e.avatar&&e.defAvatar?d.avatar=e.defAvatar:d.avatar=e.avatar;const t=await se(T,{id:N.value,...e,avatar:d.avatar});g("submitCallback",t),h.success("操作成功")}catch(d){h.error(d.message)}finally{g("update:confirmLoading",!1)}};return D({onFormSubmit:()=>{B()}}),(d,t)=>{const n=i("TigInput"),r=i("el-form-item"),V=i("el-option"),E=i("el-select"),J=i("el-avatar"),_=i("el-table-column"),K=i("el-table"),M=i("el-button"),O=i("el-form"),G=i("a-spin");return s(),b("div",de,[x("div",ue,[x("div",ie,[y.value?f("",!0):(s(),p(O,{key:0,ref_key:"formRef",ref:q,model:e,"label-width":"auto"},{default:o(()=>[l(r,{rules:[{required:!0,message:"管理员名称不能为空!"}],label:"管理员名称",prop:"username"},{default:o(()=>[l(n,{width:"100%",modelValue:e.username,"onUpdate:modelValue":t[0]||(t[0]=a=>e.username=a)},null,8,["modelValue"])]),_:1}),m.adminType=="admin"?(s(),p(r,{key:0,label:"手机号",prop:"mobile",rules:[{required:!0,message:"手机号不能为空!"}]},{default:o(()=>[l(n,{width:"100%",modelValue:e.mobile,"onUpdate:modelValue":t[1]||(t[1]=a=>e.mobile=a)},null,8,["modelValue"])]),_:1})):f("",!0),m.adminType=="admin"?(s(),p(r,{key:1,label:"邮箱",prop:"email"},{default:o(()=>[l(n,{width:"100%",modelValue:e.email,"onUpdate:modelValue":t[2]||(t[2]=a=>e.email=a)},null,8,["modelValue"])]),_:1})):f("",!0),m.adminType==="admin"?(s(),p(r,{key:2,label:"头像",prop:"avatar"},{default:o(()=>[l(A(le),{avatar:e.avatar,"onUpdate:avatar":t[3]||(t[3]=a=>e.avatar=a),avatarType:S.value,loading:y.value},null,8,["avatar","avatarType","loading"])]),_:1})):f("",!0),A(T)=="create"&&m.adminType=="admin"?(s(),b(k,{key:3},[l(r,{rules:[{required:!0,message:"设置密码不能为空!"}],label:"设置密码",prop:"password"},{default:o(()=>[l(n,{width:"100%",modelValue:e.password,"onUpdate:modelValue":t[4]||(t[4]=a=>e.password=a),type:"password"},null,8,["modelValue"])]),_:1}),l(r,{rules:[{required:!0,message:"确认密码不能为空!"}],label:"确认密码",prop:"pwdConfirm"},{default:o(()=>[l(n,{width:"100%",modelValue:e.pwdConfirm,"onUpdate:modelValue":t[5]||(t[5]=a=>e.pwdConfirm=a),type:"password"},null,8,["modelValue"])]),_:1})],64)):m.adminType=="shop"?(s(),b(k,{key:4},[l(r,{label:"修改密码",prop:"password"},{default:o(()=>[l(n,{width:"100%",modelValue:e.password,"onUpdate:modelValue":t[6]||(t[6]=a=>e.password=a),type:"password"},null,8,["modelValue"])]),_:1}),l(r,{label:"确认密码",prop:"pwdConfirm"},{default:o(()=>[l(n,{width:"100%",modelValue:e.pwdConfirm,"onUpdate:modelValue":t[7]||(t[7]=a=>e.pwdConfirm=a),type:"password"},null,8,["modelValue"])]),_:1})],64)):f("",!0),m.adminType=="admin"?(s(),p(r,{key:5,label:"管理员权限组",prop:"roleId"},{default:o(()=>[e.roleId!=2?(s(),p(E,{key:0,modelValue:e.roleId,"onUpdate:modelValue":t[8]||(t[8]=a=>e.roleId=a),style:{width:"100%"}},{default:o(()=>[l(V,{value:0,label:"自定义权限"}),(s(!0),b(k,null,Z(C.value,a=>(s(),p(V,{label:a.roleName,value:a.roleId},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])):(s(),b(k,{key:1},[w(" 供应商")],64))]),_:1})):f("",!0),e.roleId===0&&m.adminType=="admin"?(s(),p(r,{key:6,label:"",prop:"authList"},{default:o(()=>[l(ne,{modelValue:e.authList,"onUpdate:modelValue":t[9]||(t[9]=a=>e.authList=a)},null,8,["modelValue"])]),_:1})):f("",!0),m.adminType=="shop"?(s(),p(r,{key:7,label:"店铺列表",prop:"userShop"},{default:o(()=>[l(K,{data:e.userShop,"row-key":"id"},{empty:o(()=>[x("div",me,[y.value?f("",!0):(s(),b("div",pe,"暂无数据"))])]),default:o(()=>[l(_,{label:"店铺logo",prop:"username"},{default:o(({row:a})=>{var u;return[l(J,{size:40,src:A(te)((u=a.shop)==null?void 0:u.shopLogo)},null,8,["src"])]}),_:1}),l(_,{label:"所属店铺",prop:"username"},{default:o(({row:a})=>{var u;return[w(I((u=a.shop)==null?void 0:u.shopTitle),1)]}),_:1}),l(_,{width:"100",label:"状态",prop:"username"},{default:o(({row:a})=>{var u;return[w(I((u=a.shop)==null?void 0:u.statusText),1)]}),_:1}),l(_,{width:"100",label:"员工昵称",prop:"username"},{default:o(({row:a})=>[w(I(a.username||e.username||"-"),1)]),_:1}),l(_,{label:"联系方式",prop:"username"},{default:o(({row:a})=>{var u;return[w(I(((u=a.user)==null?void 0:u.mobile)||"-"),1)]}),_:1})]),_:1},8,["data"])]),_:1})):f("",!0),Y(l(r,{"wrapper-col":{offset:4,span:16}},{default:o(()=>[l(M,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:B},{default:o(()=>t[10]||(t[10]=[w("提交",-1)])),_:1,__:[10]},512)]),_:1},512),[[$,!c.isDialog]])]),_:1},8,["model"])),l(G,{spinning:y.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),Se=ae(fe,[["__scopeId","data-v-5be6f823"]]);export{Se as default};
