import{d as H,r as m,a as q,a2 as U,o as j,e as n,f as E,g as w,h as V,j as F,k as J,y as a,l,E as K,K as f,I as M,J as c}from"./index-BGgofOm4.js";import{c as O,a as z,e as A}from"./region-BHgAbnXc.js";import{u as G}from"./region-Dqu2emUz.js";const P={class:"container"},Q={class:"content_wrapper"},W={class:"lyecs-form-table"},ee=H({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean,regionId:{type:Number,default:0}},emits:["submitCallback","update:confirmLoading","close"],setup(R,{expose:I,emit:k}){const S=G(),i=k,s=R,u=m(!0),g=q().currentRoute.value.query,p=m(s.isDialog?s.act:String(g.act)),_=m(s.isDialog?s.id:Number(g.id)),C=p.value==="add"?"create":"update",v=U(),t=m({isHot:0}),h=async()=>{try{const e=await O(p.value,{id:_.value});Object.assign(t.value,e)}catch(e){c.error(e.message),i("close")}finally{u.value=!1}},x=async()=>{try{const e=await z({regionId:s.regionId});e.records&&e.records.length>0?(t.value.parentId=e.records[0].regionId,t.value.parentName=e.records[0].regionName):(t.value.parentId=0,t.value.parentName="顶级地区")}catch(e){c.error(e.message)}};j(()=>{p.value==="detail"?h():u.value=!1,x()});const y=async()=>{await v.value.validate();try{i("update:confirmLoading",!0);const e=await A(C,{id:_.value,...t.value});S.clearRegion(),i("submitCallback",e),c.success("操作成功")}catch(e){c.error(e.message)}finally{i("update:confirmLoading",!1)}};return I({onFormSubmit:()=>{y()}}),(e,o)=>{const b=n("TigInput"),d=n("el-form-item"),N=n("el-radio"),B=n("el-radio-group"),D=n("el-button"),L=n("el-form"),T=n("a-spin");return w(),E("div",P,[V("div",Q,[V("div",W,[u.value?J("",!0):(w(),F(L,{key:0,ref_key:"formRef",ref:v,model:t.value,"label-width":"auto"},{default:l(()=>[a(d,{rules:[{required:!0,message:"地区名称不能为空!"}],label:"地区名称",prop:"regionName"},{default:l(()=>[a(b,{classType:"tig-form-input",modelValue:t.value.regionName,"onUpdate:modelValue":o[0]||(o[0]=r=>t.value.regionName=r)},null,8,["modelValue"])]),_:1}),a(d,{label:"上级地区",prop:"parentName"},{default:l(()=>[a(b,{classType:"tig-form-input",disabled:"",modelValue:t.value.parentName,"onUpdate:modelValue":o[1]||(o[1]=r=>t.value.parentName=r)},null,8,["modelValue"])]),_:1}),a(d,{label:"是否热门",prop:"isHot"},{default:l(()=>[a(B,{modelValue:t.value.isHot,"onUpdate:modelValue":o[2]||(o[2]=r=>t.value.isHot=r),style:{width:"100%"}},{default:l(()=>[a(N,{value:1},{default:l(()=>o[3]||(o[3]=[f("是",-1)])),_:1,__:[3]}),a(N,{value:0},{default:l(()=>o[4]||(o[4]=[f("否",-1)])),_:1,__:[4]})]),_:1},8,["modelValue"])]),_:1}),K(a(d,{"wrapper-col":{offset:4,span:16}},{default:l(()=>[a(D,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:y},{default:l(()=>o[5]||(o[5]=[f("提交",-1)])),_:1,__:[5]},512)]),_:1},512),[[M,!s.isDialog]])]),_:1},8,["model"])),a(T,{spinning:u.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{ee as default};
