/* empty css             */import"./index-BdoKLCH8.js";import{d as ae,a as re,L as le,v as se,r as c,a9 as $,Q as oe,o as ne,J as S,e as m,f as y,g as u,h as s,y as r,l,j as q,k as f,K as _,i as n,t as b,F as ie,_ as de}from"./index-BGgofOm4.js";import{D as B}from"./DeleteRecord-C3QKVgd9.js";/* empty css                                                                    */import{P as pe}from"./Pagination-Nz0PhK3s.js";import{P as D}from"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-DhDNvZWl.js";import{a as A,u as O,d as L,b as ce}from"./articleCategory-CLgK1IN2.js";import{_ as V}from"./DialogForm.vue_vue_type_script_setup_true_lang-BTf40oxg.js";import"./index-BS7Hjr9I.js";const ue=["href"],ge={class:"container"},me={class:"content_wrapper"},_e={class:"lyecs-table-list-warp"},ye={class:"list-table-tool lyecs-search-warp"},fe={class:"list-table-tool-row"},ve={class:"list-table-tool-col"},Ce={key:1},Ie={class:"table-container"},be={style:{position:"relative"}},he=["onClick"],ke={key:1},xe={class:"empty-warp"},ze={key:0,class:"empty-bg"},Ae={key:0,class:"pagination-con"},Ne=ae({__name:"List",setup(Se){const{currentRoute:M}=re(),T=le(),F=se(),E=c(F.icoDefinedCss),U=c([]),h=c(!0),k=c(0),v=c([]),j=c([]),i=$({page:1,size:F.get("pageSize"),sortField:"",sortOrder:"",keyword:"",parentId:0}),x=c([0]),H=c(),w=oe();ne(()=>{const a=M.value.query;a.id>0&&(i.parentId=a.id),w.meta.title="",d()});const d=async()=>{h.value=!0;try{const a=await A({...i});U.value=a.records,k.value=a.total,H.value=a.parentName,a.parentName?T.setHeaderTitle("文章分类列表 - "+a.parentName):T.setHeaderTitle("文章分类列表")}catch(a){S.error(a.message)}finally{h.value=!1}},C=$({}),J=async(a,e,o)=>{C[a.articleCategoryId]={},C[a.articleCategoryId].resolve=o,C[a.articleCategoryId].expandCount=0;const g=await A({page:1,parentId:a.articleCategoryId,size:1e3});o(g.records),a.children=g.records},K=async(a,e)=>{const o=C[a.articleCategoryId];if(o.expandCount++,e&&o.expandCount>1&&!o.prevStatus){const g=await A({page:1,parentId:a.articleCategoryId,size:1e3});o.resolve(g.records)}o.prevStatus=e},z=c(null),N=async(a,e)=>{const o=C[e.parentId];if(o){const g=await A({page:1,parentId:e.parentId,size:1e3});z.value.store.states.lazyTreeNodeMap.value[e.parentId].length>1?z.value.store.states.lazyTreeNodeMap[e.parentId]=[]:z.value.store.states.lazyTreeNodeMap.value[e.parentId]=[],o.resolve(g.records)}d()},Q=a=>{x.value.push(a),i.parentId=a,d()},G=()=>{x.value.pop(),i.parentId=x.value[x.value.length-1],d()},W=async a=>{try{const e=await ce(a,{ids:v.value});S.success("操作成功"),await d()}catch(e){S.error(e.message)}},X=({prop:a,order:e})=>{i.sortField=a,i.sortOrder=e=="ascending"?"asc":e=="descending"?"desc":"",d()},Y=a=>{v.value=a.map(e=>e.articleCategoryId)};return(a,e)=>{const o=m("el-button"),g=m("el-popconfirm"),R=m("el-space"),Z=m("el-form"),I=m("el-table-column"),P=m("el-divider"),ee=m("el-table"),te=m("a-spin");return u(),y(ie,null,[s("link",{href:E.value,rel:"stylesheet"},null,8,ue),s("div",ge,[s("div",me,[s("div",_e,[s("div",ye,[e[8]||(e[8]=s("div",{class:"list-table-tips"},[s("div",null,"分类编号对应了系统一些内置分类"),s("div",null," 帮助中心：[bzzx]     客服中心：[kfzx]     热门问题：[rmwt]     本站公告：[bzgg]    资讯中心：[zxzx]    卖家中心：[mjzx] ")],-1)),r(Z,{model:i,name:"form"},{default:l(()=>[s("div",fe,[s("div",ve,[r(R,null,{default:l(()=>[i.parentId>0?(u(),q(o,{key:0,onClick:G},{default:l(()=>e[3]||(e[3]=[s("i",{class:"iconfont icon-fanhui",style:{"font-size":"14px","padding-right":"5px"}},null,-1),_(" 返回上一级 ",-1)])),_:1,__:[3]})):f("",!0),r(n(V),{params:{act:"add",parentId:i.parentId},isDrawer:"",path:"content/articleCategory/Info",title:"添加文章分类",width:"580px",onOkCallback:d},{default:l(()=>[r(o,{type:"primary"},{default:l(()=>e[4]||(e[4]=[_("添加文章分类",-1)])),_:1,__:[4]})]),_:1},8,["params"]),r(g,{title:"您确认要批量删除所选数据吗？",onConfirm:e[0]||(e[0]=t=>W("del"))},{reference:l(()=>[r(o,{disabled:v.value.length===0},{default:l(()=>e[5]||(e[5]=[_("批量删除",-1)])),_:1,__:[5]},8,["disabled"])]),_:1}),v.value.length>0?(u(),y("span",Ce,[e[6]||(e[6]=_(" 已选择：",-1)),s("b",null,b(v.value.length),1),e[7]||(e[7]=_(" 项 ",-1))])):f("",!0)]),_:1})])])]),_:1},8,["model"])]),s("div",Ie,[r(te,{spinning:h.value},{default:l(()=>[r(ee,{onSortChange:X,data:U.value,"expand-row-keys":j.value,indent:30,load:J,total:k.value,"tree-props":{children:"children",hasChildren:"hasChildren"},lazy:"","row-key":"articleCategoryId",onSelectionChange:Y,onExpandChange:K,ref_key:"tableRef",ref:z},{empty:l(()=>[s("div",xe,[h.value?f("",!0):(u(),y("div",ze,"暂无数据"))])]),default:l(()=>[r(I,{type:"selection",width:"32"}),r(I,{width:200,label:"文章分类名称"},{default:l(({row:t})=>[r(R,{style:{height:"30px"}},{default:l(()=>[s("div",be,[r(n(D),{"org-value":t.articleCategoryName,"onUpdate:orgValue":p=>t.articleCategoryName=p,params:{id:t.articleCategoryId,field:"articleCategoryName"},requestApi:n(O),label:"权限名称",type:"textarea"},{default:l(()=>[t.hasChildren?(u(),y("a",{key:0,onClick:p=>Q(t.articleCategoryId)},b(t.articleCategoryName),9,he)):(u(),y("span",ke,b(t.articleCategoryName),1))]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])])]),_:2},1024)]),_:1}),r(I,{label:"分类编号"},{default:l(({row:t})=>[r(n(D),{"org-value":t.categorySn,"onUpdate:orgValue":p=>t.categorySn=p,params:{id:t.articleCategoryId,field:"categorySn"},requestApi:n(O),label:"分类编号",type:"textarea"},{default:l(()=>[s("div",null,b(t.categorySn||"-"),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),r(I,{key:"sortOrder",sortable:"custom",label:"排序"},{default:l(({row:t})=>[r(n(D),{"org-value":t.sortOrder,"onUpdate:orgValue":p=>t.sortOrder=p,params:{id:t.articleCategoryId,field:"sortOrder"},requestApi:n(O),label:"排序",type:"integer"},{default:l(()=>[s("div",null,b(t.sortOrder),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),r(I,{width:220,fixed:"right",label:"操作"},{default:l(({row:t})=>[r(n(V),{params:{act:"detail",id:t.articleCategoryId,parentId:t.parentId},data:{parentId:t.parentId},isDrawer:"",path:"content/articleCategory/Info",title:"编辑分类",width:"580px",onOkCallback:p=>N({},{parentId:t.parentId})},{default:l(()=>e[9]||(e[9]=[s("a",{class:"btn-link"},"编辑",-1)])),_:2,__:[9]},1032,["params","data","onOkCallback"]),r(P,{direction:"vertical"}),r(n(V),{params:{act:"add",parentId:t.articleCategoryId},data:{parentId:t.parentId||t.articleCategoryId},isDrawer:"",path:"content/articleCategory/Info",title:"编辑分类",width:"580px",onOkCallback:p=>N({},{parentId:t.parentId})},{default:l(()=>e[10]||(e[10]=[s("a",{class:"btn-link"},"添加子分类",-1)])),_:2,__:[10]},1032,["params","data","onOkCallback"]),r(P,{direction:"vertical"}),t.parentId?(u(),q(n(B),{key:0,params:{id:t.articleCategoryId},requestApi:n(L),onAfterDelete:p=>N({},{parentId:t.parentId})},{default:l(()=>e[11]||(e[11]=[_("删除",-1)])),_:2,__:[11]},1032,["params","requestApi","onAfterDelete"])):f("",!0),t.parentId?f("",!0):(u(),q(n(B),{key:1,params:{id:t.articleCategoryId},requestApi:n(L),onAfterDelete:d},{default:l(()=>e[12]||(e[12]=[_("删除",-1)])),_:2,__:[12]},1032,["params","requestApi"]))]),_:1})]),_:1},8,["data","expand-row-keys","total"])]),_:1},8,["spinning"]),k.value>0?(u(),y("div",Ae,[r(n(pe),{page:i.page,"onUpdate:page":e[1]||(e[1]=t=>i.page=t),size:i.size,"onUpdate:size":e[2]||(e[2]=t=>i.size=t),total:k.value,onCallback:d},null,8,["page","size","total"])])):f("",!0)])])])])],64)}}}),Be=de(Ne,[["__scopeId","data-v-6f83dc6e"]]);export{Be as default};
