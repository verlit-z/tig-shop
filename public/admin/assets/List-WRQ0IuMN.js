import{i as q}from"./index-Bb6yjXMn.js";import{Z as M,d as R,a9 as k,r as _,o as j,q as I,aa as J,x as K,e as c,f as E,g as p,h as x,y as r,l as d,F as P,m as X,j as h,k as w,K as A,J as U,_ as Z}from"./index-BGgofOm4.js";import{r as G}from"./export-BTRfiJpP.js";const H=m=>M({url:"panel/statisticsUser/addUserTrends",method:"get",params:m}),Q=m=>M({url:"panel/statisticsUser/addUserTrends",method:"get",responseType:"arraybuffer",params:m}),W={class:"container"},$={class:"content_wrapper"},ee={class:"filtrate-menu"},te=R({__name:"List",setup(m){const l=k({1:"",2:"",3:""}),T=_();let s;const f=_({title:{text:"新增会员趋势",left:"center"},grid:{left:"3%",right:"4%"},tooltip:{trigger:"axis"},legend:{data:["新增会员数"],left:"center",bottom:"bottom"},xAxis:{type:"category",data:[]},yAxis:{type:"value",name:"(人)"},series:[{name:"新增会员数",data:[],type:"line",smooth:!0,lineStyle:{color:"#F7DD32"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(247,221,50,0.25)"},{offset:1,color:"rgba(247,221,50,0)"}],global:!1}},color:"#F7DD32",emphasis:{scale:!1},tooltip:{valueFormatter:function(e){return e+"人"}}}]}),a=k({dateType:"1",startEndTime:"",isExport:"0"});_();const D=async()=>{try{a.startEndTime=l[a.dateType];const e=await H({dateType:a.dateType,startEndTime:a.startEndTime}),{horizontalAxis:t,longitudinalAxis:o}=e,g=t.map(u=>{let i="月";return a.dateType==="2"&&(i="日"),a.dateType==="3"&&(i="时"),u+i});f.value.xAxis.data=g,f.value.series[0].data=o,s.setOption(f.value)}catch(e){U.error(e.message),console.error(e)}},Y=()=>{D()},v=_(!1),F=async()=>{v.value=!0;try{const e=await Q({...a,isExport:"1"});v.value=!1,G(e,"新增会员数导出")}catch(e){U.error(e.message)}finally{v.value=!1}},b=()=>{s==null||s.resize()},S=()=>{s=q(T.value),s.setOption(f.value),window.addEventListener("resize",b)},z=[{label:"按年筛选",value:"1"},{label:"按月筛选",value:"2"},{label:"按日筛选",value:"3"}],L=[{text:"本年",value:()=>y(0)},{text:"去年",value:()=>y(1)},{text:"三年前",value:()=>y(3)},{text:"五年前",value:()=>y(5)}],C=[{text:"本月",value:new Date},{text:"上月",value:()=>{const e=new Date;return e.setTime(e.getTime()-3600*1e3*24*30),e}},{text:"本年一月",value:()=>{const e=new Date;return new Date(e.getFullYear(),0,1)}}],O=[{text:"今天",value:new Date},{text:"昨天",value:()=>{const e=new Date;return e.setTime(e.getTime()-3600*1e3*24),e}},{text:"本月第一天",value:()=>{const e=new Date,t=e.getFullYear(),o=e.getMonth();return new Date(t,o,1)}}],y=e=>{const t=new Date;return new Date(t.getFullYear()-e,t.getMonth(),t.getDate())};return j(()=>{I(()=>{S()}),window.onresize=()=>{s==null||s.resize()};const e=J(new Date);if(e){const t=e.split("-");for(const o in l)o==="3"&&(l[o]=e),o==="1"&&(l[o]=t[0]),o==="2"&&(l[o]=t[0]+"-"+t[1])}D()}),K(()=>{s==null||s.dispose(),window.removeEventListener("resize",b)}),(e,t)=>{const o=c("el-option"),g=c("el-select"),u=c("el-form-item"),i=c("el-date-picker"),V=c("el-button"),B=c("el-form");return p(),E("div",W,[x("div",$,[x("div",null,[r(B,{model:a},{default:d(()=>[x("div",ee,[r(u,{class:"mr-10"},{default:d(()=>[r(g,{modelValue:a.dateType,"onUpdate:modelValue":t[0]||(t[0]=n=>a.dateType=n),placeholder:"Select",style:{width:"94.5px"},onChange:Y},{default:d(()=>[(p(),E(P,null,X(z,(n,N)=>r(o,{key:N,label:n.label,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),r(u,{class:"mr-10"},{default:d(()=>[a.dateType==="3"?(p(),h(i,{key:0,style:{width:"200px"},shortcuts:O,modelValue:l[3],"onUpdate:modelValue":t[1]||(t[1]=n=>l[3]=n),"value-format":"YYYY-MM-DD",editable:!1,type:"date"},null,8,["modelValue"])):w("",!0),a.dateType==="2"?(p(),h(i,{key:1,style:{width:"200px"},shortcuts:C,modelValue:l[2],"onUpdate:modelValue":t[2]||(t[2]=n=>l[2]=n),"value-format":"YYYY-MM",editable:!1,type:"month"},null,8,["modelValue"])):w("",!0),a.dateType==="1"?(p(),h(i,{key:2,modelValue:l[1],"onUpdate:modelValue":t[3]||(t[3]=n=>l[1]=n),type:"year","value-format":"YYYY",style:{width:"200px"},shortcuts:L,editable:!1},null,8,["modelValue"])):w("",!0)]),_:1}),r(u,{class:"mr-10"},{default:d(()=>[r(V,{plain:"",onClick:Y},{default:d(()=>t[4]||(t[4]=[A("搜索",-1)])),_:1,__:[4]})]),_:1}),r(u,null,{default:d(()=>[r(V,{plain:"",onClick:F,loading:v.value},{default:d(()=>t[5]||(t[5]=[A("导出EXCEL",-1)])),_:1,__:[5]},8,["loading"])]),_:1})])]),_:1},8,["model"])]),x("div",{class:"chart",ref_key:"chartRef",ref:T},null,512)])])}}}),le=Z(te,[["__scopeId","data-v-1baf640a"]]);export{le as default};
