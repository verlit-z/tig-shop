import{d as P,r as y,a as j,a2 as q,o as J,e as u,f as K,g,h as n,j as L,k as S,y as l,l as r,E as M,i as C,K as v,I as $,J as b}from"./index-BGgofOm4.js";import{a as z,c as G}from"./pcCatFloor-CQhxgggQ.js";import{D as x}from"./DynamicList-nuD9M0w0.js";import{S as H}from"./SelectBrand-DSwX5rvc.js";import{_ as Q}from"./SelectCategory.vue_vue_type_script_setup_true_lang-DH07CGtZ.js";import"./index-BdoKLCH8.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-CdQ8MEGg.js";/* empty css                                                                    *//* empty css                                                                              */import{S as W}from"./SelectIco-BgzhplF-.js";import"./brand-JXPhU1RM.js";import"./category-0ZzOrTFu.js";import"./index-BS7Hjr9I.js";import"./time-BL_Iz6xX.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-BTf40oxg.js";const X={class:"container"},Y={class:"content_wrapper"},Z={class:"lyecs-form-table"},ee={class:"dynamic-div"},ae={class:"dynamic-div"},be=P({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:{type:Boolean,default:!1}},emits:["submitCallback","update:confirmLoading","close"],setup(B,{expose:U,emit:k}){const c=k,i=B,m=y(!0),I=j().currentRoute.value.query,f=y(i.isDialog?i.act:String(I.act)),_=y(i.isDialog?i.id:Number(I.id)),T=f.value==="add"?"create":"update",V=q(),a=y({isShow:1,sortOrder:50}),F=async()=>{try{const t=await z(f.value,{id:_.value});Object.assign(a.value,t),t.categoryIds&&t.categoryNames&&t.categoryIds.length===t.categoryNames.length&&(a.value.categoryList=t.categoryIds.map((e,d)=>{var s;return{categoryId:Number(e),categoryName:((s=t.categoryNames)==null?void 0:s[d])||""}}),t.brandIds&&t.brandIds.length>0&&(a.value.brandList=t.brandIds.map((e,d)=>({brandId:Number(e)}))))}catch(t){b.error(t.message),c("close")}finally{m.value=!1}};J(()=>{f.value==="detail"?F():m.value=!1});const N=async()=>{await V.value.validate();try{c("update:confirmLoading",!0),A(),D();const t=await G(T,{id:_.value,...a.value});c("submitCallback",t),b.success("操作成功")}catch(t){b.error(t.message)}finally{c("update:confirmLoading",!1)}};function A(){var t;a.value.categoryIds=a.value.categoryIds||[],a.value.categoryNames=a.value.categoryNames||[],a.value.categoryIds.length=0,a.value.categoryNames.length=0,(t=a.value.categoryList)==null||t.forEach(e=>{var d,s;typeof e.categoryId=="number"&&typeof e.categoryName=="string"&&((d=a.value.categoryIds)==null||d.push(e.categoryId),(s=a.value.categoryNames)==null||s.push(e.categoryName))})}function D(){var t;a.value.brandIds=a.value.brandIds||[],a.value.brandIds.length=0,(t=a.value.brandList)==null||t.forEach(e=>{var d;typeof e.brandId=="number"&&((d=a.value.brandIds)==null||d.push(e.brandId))})}return U({onFormSubmit:()=>{N()}}),(t,e)=>{const d=u("TigInput"),s=u("el-form-item"),w=u("el-radio"),O=u("el-radio-group"),R=u("el-button"),h=u("el-form"),E=u("a-spin");return g(),K("div",X,[n("div",Y,[n("div",Z,[m.value?S("",!0):(g(),L(h,{key:0,ref_key:"formRef",ref:V,model:a.value,"label-width":"auto"},{default:r(()=>[l(s,{label:"添加分类",prop:"brandName"},{default:r(()=>[l(x,{modelValue:a.value.categoryList,"onUpdate:modelValue":e[0]||(e[0]=o=>a.value.categoryList=o),templateList:["categoryId","categoryName"],templateListType:["number","string"],buttonName:"增加",buttonType:"primary",style:{width:"100%"}},{dynamicSlot:r(({item:o})=>[n("div",ee,[m.value?S("",!0):(g(),L(C(Q),{key:0,categoryId:o.categoryId,"onUpdate:categoryId":p=>o.categoryId=p,multiple:!1,style:{width:"100%"}},null,8,["categoryId","onUpdate:categoryId"])),e[5]||(e[5]=n("span",null,"重命名：",-1)),l(d,{classType:"tig-form-input",modelValue:o.categoryName,"onUpdate:modelValue":p=>o.categoryName=p},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["modelValue"]),e[6]||(e[6]=n("div",{class:"extra"},"提示：只能设置为一级或二级分类，且必须含有一个一级分类，如果存在二级分类，则必须存在该二级分类上一级分类；",-1)),e[7]||(e[7]=n("div",{class:"extra"},"重命名为空则显示原分类名称，重命名的作用为方便排列",-1)),e[8]||(e[8]=n("div",{class:"extra"},"设置规则如下：",-1)),e[9]||(e[9]=n("div",{class:"extra"},"1、如果添加的分类为一级分类A、B、C，则抽屉一级会显示：A/B/C三个链接，二级为A、B、C下的所有二级分类",-1)),e[10]||(e[10]=n("div",{class:"extra"}," 2、如果添加的分类为一级分类A和A下面的二级分类a1、a2，则，会显示A/a1/a2三个链接，二级为A下的所有二级分类（包含了a1、a2） ",-1)),e[11]||(e[11]=n("div",{class:"extra"},"3、如果重命名为“-”符号，则不会显示",-1))]),_:1,__:[6,7,8,9,10,11]}),l(s,{label:"热门品牌",prop:"brandList"},{default:r(()=>[l(x,{modelValue:a.value.brandList,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.brandList=o),templateList:["brandId"],templateListType:["number"],buttonName:"增加",buttonType:"primary",style:{width:"100%"}},{dynamicSlot:r(({item:o})=>[n("div",ae,[l(C(H),{modelValue:o.brandId,"onUpdate:modelValue":p=>o.brandId=p,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"ICO编码",prop:"floorIcoFont"},{default:r(()=>[l(W,{modelValue:a.value.floorIcoFont,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.floorIcoFont=o)},null,8,["modelValue"]),e[12]||(e[12]=n("div",{class:"extra"},'请先在Tigshop设置中的"接口设置"中设置"ico图标库地址"',-1))]),_:1,__:[12]}),l(s,{label:"排序",prop:"sortOrder"},{default:r(()=>[l(d,{type:"integer",modelValue:a.value.sortOrder,"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.sortOrder=o)},null,8,["modelValue"])]),_:1}),l(s,{label:"是否显示",prop:"isShow"},{default:r(()=>[l(O,{modelValue:a.value.isShow,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.isShow=o)},{default:r(()=>[l(w,{value:1},{default:r(()=>e[13]||(e[13]=[v("是",-1)])),_:1,__:[13]}),l(w,{value:0},{default:r(()=>e[14]||(e[14]=[v("否",-1)])),_:1,__:[14]})]),_:1},8,["modelValue"])]),_:1}),M(l(s,{"wrapper-col":{offset:4,span:16}},{default:r(()=>[l(R,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:N},{default:r(()=>e[15]||(e[15]=[v("提交",-1)])),_:1,__:[15]},512)]),_:1},512),[[$,!i.isDialog]])]),_:1},8,["model"])),l(E,{spinning:m.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}});export{be as default};
