import{d as B,r as c,a as D,a2 as O,o as R,J as f,e as i,f as I,g as V,h as w,k as U,y as a,l as n,E as h,K as q,I as L}from"./index-BGgofOm4.js";import{c as E,e as F}from"./articleCategory-CLgK1IN2.js";import{S as j}from"./SelectArticleCategory-BZqt2_5P.js";/* empty css                                                                              */const J={class:"container"},K={class:"content_wrapper"},M={key:0,class:"lyecs-form-table"},W=B({__name:"Info",props:{id:{type:Number,default:0},parentId:{type:Array,default:[]},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(v,{expose:C,emit:k}){const u=k,l=v,d=c(!0),y=D().currentRoute.value.query,p=c(l.isDialog?l.act:String(y.act)),g=c(l.isDialog?l.id:Number(y.id)),N=p.value==="add"?"create":"update",_=O(),e=c({articleCategoryName:"",parentId:l.parentId,keywords:"",description:"",sortOrder:50});R(()=>{p.value==="detail"?x():d.value=!1});const x=async()=>{try{d.value=!0;const r=await E(p.value,{id:g.value});Object.assign(e.value,r),l.parentId&&(e.value.parentId=l.parentId)}catch(r){f.error(r.message),u("close")}finally{d.value=!1}},b=async()=>{await _.value.validate();try{u("update:confirmLoading",!0),Array.isArray(e.value.parentId)&&e.value.parentId.length>0?e.value.parentId=e.value.parentId[e.value.parentId.length-1]:(e.value.parentId=0,l.parentId&&l.act==="add"&&(e.value.parentId=l.parentId));const r=await F(N,{id:g.value,...e.value});u("submitCallback",r),f.success("操作成功")}catch(r){f.error(r.message)}finally{u("update:confirmLoading",!1)}};return C({onFormSubmit:()=>{b()}}),(r,t)=>{const m=i("TigInput"),s=i("el-form-item"),S=i("el-button"),A=i("el-form"),T=i("a-spin");return V(),I("div",J,[w("div",K,[d.value?U("",!0):(V(),I("div",M,[a(A,{ref_key:"formRef",ref:_,model:e.value,"label-width":"auto"},{default:n(()=>[a(s,{rules:[{required:!0,message:"文章分类名称不能为空!"}],extra:"sfs",label:"文章分类名称",prop:"articleCategoryName"},{default:n(()=>[a(m,{classType:"tig-form-input",modelValue:e.value.articleCategoryName,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.articleCategoryName=o)},null,8,["modelValue"])]),_:1}),a(s,{label:"上级分类",prop:"parentId"},{default:n(()=>[a(j,{"min-width":"100%",modelValue:e.value.parentId,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.parentId=o),disabled:p.value=="add"||v.parentId.length>0},null,8,["modelValue","disabled"])]),_:1}),a(s,{label:"关键字",prop:"keywords"},{default:n(()=>[a(m,{classType:"tig-form-input",modelValue:e.value.keywords,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.keywords=o)},null,8,["modelValue"])]),_:1}),a(s,{label:"描述",prop:"description"},{default:n(()=>[a(m,{classType:"tig-form-input",modelValue:e.value.description,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.description=o),row:2,type:"textarea"},null,8,["modelValue"]),t[5]||(t[5]=w("div",{class:"extra"},"关键字为选填项，其目的在于方便外部搜索引擎搜索",-1))]),_:1,__:[5]}),a(s,{prop:"sortOrder",label:"排序"},{default:n(()=>[a(m,{type:"integer",modelValue:e.value.sortOrder,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.sortOrder=o)},null,8,["modelValue"])]),_:1}),h(a(s,{"wrapper-col":{offset:4,span:16}},{default:n(()=>[a(S,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:b},{default:n(()=>t[6]||(t[6]=[q("提交 ",-1)])),_:1,__:[6]},512)]),_:1},512),[[L,!l.isDialog]])]),_:1},8,["model"])])),a(T,{spinning:d.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])}}});export{W as default};
