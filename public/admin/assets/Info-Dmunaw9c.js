import{d as J,r as f,a as W,a2 as Q,o as X,J as U,e as m,f as b,g as i,h as v,k as _,j as c,y as l,l as a,E as Z,i as T,K as s,F,m as h,t as w,a0 as ee,I as te,q as le,_ as ae}from"./index-BGgofOm4.js";import"./index-BdoKLCH8.js";import{F as q}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-CloSefEz.js";import"./vuedraggable.umd-CLczY9wy.js";import{a as oe,c as se}from"./comment-BCOa_18j.js";import"./SelectTimeInterval.vue_vue_type_style_index_0_scoped_207fe586_lang-CdQ8MEGg.js";import{S as ne}from"./SelectProduct-DqHrlW58.js";/* empty css                                                                    *//* empty css                                                                              */import{_ as ue}from"./DialogForm.vue_vue_type_script_setup_true_lang-BTf40oxg.js";import"./index-BS7Hjr9I.js";import"./Image.vue_vue_type_script_setup_true_lang-oDjiJjwB.js";import"./format-CpNC4fsQ.js";import"./BusinessImg-Dt_2PeVb.js";import"./time-BL_Iz6xX.js";import"./product-DiKWBvyV.js";import"./Pagination-Nz0PhK3s.js";const de={class:"container"},ie={class:"content_wrapper"},re={class:"lyecs-form-table"},me={class:"flex flex-wrap"},pe={key:0,class:"container-card"},fe={class:"title"},ve={key:0},be={key:1},ce={style:{"text-align":"end","margin-top":"10px"}},ye=J({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},examine:{type:Number,default:0},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(n,{expose:L,emit:H}){const x=H,y=n,p=f(!0),S=W().currentRoute.value.query,k=f(y.isDialog?y.act:String(S.act)),I=f(y.isDialog?y.id:Number(S.id)),P=k.value==="add"?"create":"update",Y=Q(),t=f({commentRank:5,isRecommend:1,isTop:0,sortOrder:50,productIds:[],commentTag:[]}),g=f(""),C=f(!1),B=f(),z=u=>{t.value.commentTag.splice(t.value.commentTag.indexOf(u),1)},E=()=>{C.value=!0,le(()=>{B.value.input.focus()})},M=()=>{g.value&&t.value.commentTag.push(g.value),C.value=!1,g.value=""};X(()=>{k.value==="detail"?N():p.value=!1});const N=async()=>{try{const u=await oe(k.value,{id:I.value});let e=[];u.productId&&(e=[u.productId]),Object.assign(t.value,u,{productIds:e})}catch(u){U.error(u.message),x("close")}finally{p.value=!1}},K=()=>{N()},O=async()=>{await Y.value.validate();try{x("update:confirmLoading",!0);let u=0;t.value.productIds.length>0&&(u=t.value.productIds[0]);const e=await se(P,{id:I.value,...t.value,productId:u});x("submitCallback",e),U.success("操作成功")}catch(u){U.error(u.message)}finally{x("update:confirmLoading",!1)}};return L({onFormSubmit:()=>{O()}}),(u,e)=>{const d=m("el-form-item"),V=m("TigInput"),r=m("el-radio"),R=m("el-radio-group"),$=m("el-tag"),D=m("el-button"),j=m("el-date-picker"),A=m("el-form"),G=m("a-spin");return i(),b("div",de,[v("div",ie,[v("div",re,[p.value?_("",!0):(i(),c(A,{key:0,ref_key:"formRef",ref:Y,model:t.value,"label-width":"auto"},{default:a(()=>[l(d,{label:"评论商品",prop:"productIds"},{default:a(()=>[p.value?_("",!0):(i(),c(T(ne),{key:0,isMultiple:!1,ids:t.value.productIds,"onUpdate:ids":e[0]||(e[0]=o=>t.value.productIds=o),disabled:n.examine==1},null,8,["ids","disabled"]))]),_:1}),l(d,{rules:[{required:!0,message:"会员名称不能为空!"}],label:"会员名称",prop:"username"},{default:a(()=>[l(V,{classType:"tig-form-input",modelValue:t.value.username,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.username=o),disabled:n.examine==1},null,8,["modelValue","disabled"])]),_:1}),l(d,{label:"会员头像",prop:"avatar"},{default:a(()=>[l(T(q),{photo:t.value.avatar,"onUpdate:photo":e[2]||(e[2]=o=>t.value.avatar=o),disabled:n.examine==1},null,8,["photo","disabled"]),e[12]||(e[12]=v("div",{class:"extra"},"请统一上传比例为1:1的图片，宽100px，高100px（高清））",-1))]),_:1,__:[12]}),l(d,{label:"评论星级",prop:"commentRank"},{default:a(()=>[l(R,{modelValue:t.value.commentRank,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.commentRank=o),disabled:n.examine==1},{default:a(()=>[l(r,{value:1},{default:a(()=>e[13]||(e[13]=[s("一星",-1)])),_:1,__:[13]}),l(r,{value:2},{default:a(()=>e[14]||(e[14]=[s("二星",-1)])),_:1,__:[14]}),l(r,{value:3},{default:a(()=>e[15]||(e[15]=[s("三星",-1)])),_:1,__:[15]}),l(r,{value:4},{default:a(()=>e[16]||(e[16]=[s("四星",-1)])),_:1,__:[16]}),l(r,{value:5},{default:a(()=>e[17]||(e[17]=[s("五星",-1)])),_:1,__:[17]})]),_:1},8,["modelValue","disabled"])]),_:1}),l(d,{label:"标签",prop:"commentTag"},{default:a(()=>[v("div",me,[(i(!0),b(F,null,h(t.value.commentTag,o=>(i(),c($,{style:{margin:"5px"},key:o,closable:n.examine!=1,"disable-transitions":!1,onClose:_e=>z(o)},{default:a(()=>[s(w(o),1)]),_:2},1032,["closable","onClose"]))),128)),n.examine!=1?(i(),b(F,{key:0},[C.value?(i(),c(V,{key:0,classType:"tig-form-input",ref_key:"InputRef",ref:B,modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=o=>g.value=o),class:"w-20",size:"small",onKeyup:ee(M,["enter"]),onBlur:M},null,8,["modelValue"])):(i(),c(D,{key:1,style:{margin:"5px"},class:"button-new-tag",size:"small",onClick:E},{default:a(()=>e[18]||(e[18]=[s(" + 新增标签 ",-1)])),_:1,__:[18]}))],64)):_("",!0)])]),_:1}),l(d,{rules:[{required:!0,message:"评论内容不能为空!"}],label:"评论内容",prop:"content"},{default:a(()=>[l(V,{classType:"tig-form-input",modelValue:t.value.content,"onUpdate:modelValue":e[5]||(e[5]=o=>t.value.content=o),type:"textarea",disabled:n.examine==1},null,8,["modelValue","disabled"])]),_:1}),l(d,{label:"评论日期",prop:"addTime"},{default:a(()=>[l(j,{modelValue:t.value.addTime,"onUpdate:modelValue":e[6]||(e[6]=o=>t.value.addTime=o),format:"YYYY-MM-DD HH:mm:ss",placeholder:"请选择日期",disabled:n.examine==1,type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","disabled"])]),_:1}),l(d,{label:"晒单",prop:"showPics"},{default:a(()=>[p.value?_("",!0):(i(),c(T(q),{key:0,photos:t.value.showPics,"onUpdate:photos":e[7]||(e[7]=o=>t.value.showPics=o),isMultiple:!0,disabled:n.examine==1},null,8,["photos","disabled"]))]),_:1}),l(d,{label:"排序",prop:"sortOrder"},{default:a(()=>[l(V,{classType:"tig-form-input",type:"integer",modelValue:t.value.sortOrder,"onUpdate:modelValue":e[8]||(e[8]=o=>t.value.sortOrder=o),disabled:n.examine==1},null,8,["modelValue","disabled"])]),_:1}),l(d,{label:"是否推荐",prop:"isRecommend"},{default:a(()=>[l(R,{modelValue:t.value.isRecommend,"onUpdate:modelValue":e[9]||(e[9]=o=>t.value.isRecommend=o),disabled:n.examine==1},{default:a(()=>[l(r,{value:1},{default:a(()=>e[19]||(e[19]=[s("是",-1)])),_:1,__:[19]}),l(r,{value:0},{default:a(()=>e[20]||(e[20]=[s("否",-1)])),_:1,__:[20]})]),_:1},8,["modelValue","disabled"])]),_:1}),l(d,{label:"是否置顶",prop:"isTop"},{default:a(()=>[l(R,{modelValue:t.value.isTop,"onUpdate:modelValue":e[10]||(e[10]=o=>t.value.isTop=o),disabled:n.examine==1},{default:a(()=>[l(r,{value:1},{default:a(()=>e[21]||(e[21]=[s("是",-1)])),_:1,__:[21]}),l(r,{value:0},{default:a(()=>e[22]||(e[22]=[s("否",-1)])),_:1,__:[22]})]),_:1},8,["modelValue","disabled"])]),_:1}),Z(l(d,{"wrapper-col":{offset:4,span:16}},{default:a(()=>[l(D,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:e[11]||(e[11]=o=>O())},{default:a(()=>e[23]||(e[23]=[s("提交 ",-1)])),_:1,__:[23]},512)]),_:1},512),[[te,!y.isDialog]])]),_:1},8,["model"])),l(G,{spinning:p.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])]),!p.value&&k.value!=="add"?(i(),b("div",pe,[v("div",fe,[e[25]||(e[25]=s(" 管理员回复 ",-1)),l(T(ue),{params:{id:I.value},isDrawer:"",path:"product/comment/src/EditRemark",title:"回复评论",width:"600px",onOkCallback:K},{default:a(()=>[l(D,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:a(()=>e[24]||(e[24]=[s(" 回复评论 ",-1)])),_:1,__:[24]})]),_:1},8,["params"])]),t.value.reply?(i(),b("div",be,[v("p",null,"内容："+w(t.value.reply.content),1),v("p",ce,w(t.value.reply.username)+"@"+w(t.value.reply.addTime),1)])):(i(),b("div",ve,"暂无回复！"))])):_("",!0)])])}}}),qe=ae(ye,[["__scopeId","data-v-1c46947a"]]);export{qe as default};
