import{d as K,a2 as W,r as _,a as E,a9 as J,o as P,e as s,f as w,g as L,h as n,y as t,l as a,i as x,ds as Y,K as v,t as C,k as Z,J as y,_ as $}from"./index-BGgofOm4.js";import{a as z,u as A}from"./levelManage-Dn9u2RGa.js";import{F as H}from"./UploadAvatar.vue_vue_type_style_index_0_scoped_3ec2e0ca_lang-CloSefEz.js";import"./index-BdoKLCH8.js";import"./vuedraggable.umd-CLczY9wy.js";import"./Image.vue_vue_type_script_setup_true_lang-oDjiJjwB.js";import"./format-CpNC4fsQ.js";import"./BusinessImg-Dt_2PeVb.js";import"./DialogForm.vue_vue_type_script_setup_true_lang-BTf40oxg.js";import"./index-BS7Hjr9I.js";const ee={class:"container"},te={class:"content_wrapper"},ae={class:"lyecs-form-table"},oe={class:"flex mb10"},le={class:"flex"},se={class:"level_txt"},ne={class:"flex flex-align-center"},ie={key:0},re=K({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(U,{expose:B,emit:V}){const d=V,p=U,c=W(),m=_(!0),b=E().currentRoute.value.query,f=_(p.isDialog?p.act:String(b.act)),D=_(p.isDialog?p.id:Number(b.id)),S=f.value==="add"?"create":"update",T={2:"铂金会员",3:"黑金会员",4:"钻石会员",5:"至尊会员"},e=_({data:[{rankLevel:1,rankName:"黄金会员",rankLogo:"https://oss.tigshop.com/img/gallery/202501/1735803176Yh9mCaE2r9ebXK3bGm.png"}]}),k=J({rankName:[{required:!0,message:"请输入",trigger:"blur"}]}),I=async()=>{try{m.value=!0;const o=await z(f.value);e.value.data=o.userRankList}catch(o){y.error(o.message),d("close")}finally{m.value=!1}},R=["https://oss.tigshop.com/img/gallery/202501/1737524324ro1DJxNm3aQowZKnPU.png","https://oss.tigshop.com/img/gallery/202501/1737524324ZUrDWMFqTPMBTCOlhg.png","https://oss.tigshop.com/img/gallery/202501/1737524324ptLNB2WynLJBBwSHHj.png","https://oss.tigshop.com/img/gallery/202501/1737524324hhmoz188M0ejyXEBhT.png","https://oss.tigshop.com/img/gallery/202501/1737524324O1BXVeurAyDMj9QG8f.png","https://oss.tigshop.com/img/gallery/202501/1737524324T7eKXTpMiCeVQOyFb6.png","https://oss.tigshop.com/img/gallery/202501/1737524324bUufpiVaGcaUad1CWd.png","https://oss.tigshop.com/img/gallery/202501/1737524324NhZbUn45wj1eSaIbjY.png","https://oss.tigshop.com/img/gallery/202501/1737524324bv68MBsoQXa2rLUO9i.png","https://oss.tigshop.com/img/gallery/202501/1737524324urqONY3QDjaTqW7d56.png"],M=async()=>{if(await c.value.validate(),e.value.data.length<=10){let o={rankLevel:e.value.data.length+1,rankName:T[e.value.data.length+1],rankLogo:R[e.value.data.length]};e.value.data.push(o),await c.value.validate()}},j=o=>{e.value.data.splice(o,1)};P(()=>{f.value==="detail"?I():m.value=!1});const q=async()=>{await c.value.validate();try{d("update:confirmLoading",!0);const o=await A(S,{id:D.value,...e.value});d("submitCallback",o),y.success("操作成功")}catch(o){y.error(o.message)}finally{d("update:confirmLoading",!1)}};return B({onFormSubmit:()=>{q()}}),(o,i)=>{const N=s("el-button"),h=s("el-form-item"),u=s("el-table-column"),F=s("el-image"),O=s("el-tooltip"),Q=s("TigInput"),X=s("el-table"),G=s("el-form");return L(),w("div",ee,[n("div",te,[n("div",ae,[i[2]||(i[2]=n("div",{class:"title"},"等级方案",-1)),t(G,{ref_key:"formRef",ref:c,rules:k,model:e.value,"label-width":"auto"},{default:a(()=>[t(h,{prop:"data",style:{"margin-bottom":"0"}},{default:a(()=>[n("div",oe,[n("div",le,[t(N,{type:"primary",icon:x(Y),link:"",onClick:M,disabled:e.value.data.length>=10},{default:a(()=>[v(C(e.value.data.length>=10?"多添加10级":`添加等级(${e.value.data.length}/10)`),1)]),_:1},8,["icon","disabled"])])])]),_:1}),t(h,{prop:"data"},{default:a(()=>[t(X,{data:e.value.data,loading:m.value,"row-key":"userId"},{default:a(()=>[t(u,{width:120,label:"等级",prop:"level"},{default:a(({row:l,$index:r})=>[n("div",se,"vip"+C(l.rankLevel),1)]),_:1}),t(u,{width:130,label:"会员图标",prop:"rankLogo",align:"center"},{default:a(({row:l,$index:r})=>[t(O,{effect:"light",placement:"bottom","show-after":150},{content:a(()=>i[0]||(i[0]=[v(" 点击修改 ",-1)])),default:a(()=>[n("div",null,[t(x(H),{photo:l.rankLogo,"onUpdate:photo":g=>l.rankLogo=g,type:2},{default:a(()=>[t(F,{style:{height:"20px"},src:l.rankLogo},null,8,["src"])]),_:2},1032,["photo","onUpdate:photo"])])]),_:2},1024)]),_:1}),t(u,{width:300,label:"会员名称*",prop:"rankName"},{default:a(({row:l,$index:r})=>[t(h,{prop:"data."+r+".rankName",rules:k.rankName},{default:a(()=>[n("div",ne,[t(Q,{modelValue:l.rankName,"onUpdate:modelValue":g=>l.rankName=g,width:"100px"},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1032,["prop","rules"])]),_:1}),t(u,{fixed:"right",width:80,label:"操作",class:"setBtn"},{default:a(({row:l,$index:r})=>[r===e.value.data.length-1&&e.value.data.length>1?(L(),w("div",ie,[t(N,{type:"primary",link:"",size:"mini",onClick:g=>j(r)},{default:a(()=>i[1]||(i[1]=[v("删除",-1)])),_:2,__:[1]},1032,["onClick"])])):Z("",!0)]),_:1})]),_:1},8,["data","loading"])]),_:1})]),_:1},8,["rules","model"])])])])}}}),be=$(re,[["__scopeId","data-v-88e9b87f"]]);export{be as default};
