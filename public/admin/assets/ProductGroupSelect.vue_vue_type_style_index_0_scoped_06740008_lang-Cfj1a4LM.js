import{f as $,g as V,aH as G,F as at,m as rt,p as K,a4 as Q,n as Z}from"./index-BGgofOm4.js";const _=new WeakMap;function lt(t){let e=_.get(t);return e||_.set(t,e=Object.create(null)),e}function z(t,e,...i){t&&t.$emit&&t.$emit(e,...i);const s=lt(t)[e];return s&&s.map(n=>n.apply(t,i)),t}function tt(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function E(t,e,i,s=1){const n=Math.round(e/s/t[0])*t[0],o=Math.round(i/s/t[1])*t[1];return[n,o]}function et(t,e,i){return t-e-i}function it(t,e,i){return t-e-i}function R(t,e,i){return e!==null&&t<e?e:i!==null&&i<t?i:t}function F(t,e,i,s,n){const o=Math.PI/180*n,l=Math.cos(o),u=Math.sin(o);let h=i-t,r=s-e;return{x:h*l-r*u+t,y:h*u+r*l+e}}function ct(t,e){let i=Math.atan2(e,t);return i=Math.round(180/Math.PI*i),i<0&&(i=360+i),i}function st(t,e,i){let s=t;const n=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(o=>tt(s[o]));if(!tt(s[n]))return!1;do{if(s[n](e))return!0;if(s===i)return!1;s=s.parentNode}while(s);return!1}function ut(t){const e=window.getComputedStyle(t);return[parseFloat(e.getPropertyValue("width"),10),parseFloat(e.getPropertyValue("height"),10)]}function P(t,e,i){t&&(t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener?t.addEventListener(e,i,!0):t["on"+e]=i)}function k(t,e,i){t&&(t.detachEvent?t.detachEvent("on"+e,i):t.removeEventListener?t.removeEventListener(e,i,!0):t["on"+e]=null)}const Y={mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"},touch:{start:"touchstart",move:"touchmove",stop:"touchend"}},mt={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},dt={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let B=Y.mouse;var D={name:"VueDragResizeRotate",props:{className:{type:String,default:"vue-drag-resize-rotate"},classNameDraggable:{type:String,default:"draggable"},classNameResizable:{type:String,default:"resizable"},classNameRotatable:{type:String,default:"rotatable"},classNameDragging:{type:String,default:"dragging"},classNameResizing:{type:String,default:"resizing"},classNameRotating:{type:String,default:"rotating"},classNameActive:{type:String,default:"active"},classNameHandle:{type:String,default:"handle"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!1},lockAspectRatio:{type:Boolean,default:!1},outsideAspectRatio:{type:[Number,String],default:0},w:{type:[Number,String],default:200,validator:t=>typeof t=="number"?t>0:t==="auto"},h:{type:[Number,String],default:200,validator:t=>typeof t=="number"?t>0:t==="auto"},minWidth:{type:Number,default:0,validator:t=>t>=0},minHeight:{type:Number,default:0,validator:t=>t>=0},maxWidth:{type:Number,default:1/0,validator:t=>t>=0},maxHeight:{type:Number,default:1/0,validator:t=>t>=0},x:{type:[String,Number],default:0},y:{type:[String,Number],default:0},z:{type:[String,Number],default:"auto",validator:t=>typeof t=="string"?t==="auto":t>=0},r:{type:[String,Number],default:0},handles:{type:Array,default:()=>["tl","tm","tr","mr","br","bm","bl","ml","rot"],validator:t=>{const e=new Set(["tl","tm","tr","mr","br","bm","bl","ml","rot"]);return new Set(t.filter(i=>e.has(i))).size===t.length}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},axis:{type:String,default:"both",validator:t=>["x","y","both"].includes(t)},grid:{type:Array,default:()=>[1,1]},parent:{type:[Boolean,String],default:!1},onDragStart:{type:Function,default:()=>!0},onDrag:{type:Function,default:()=>!0},onResizeStart:{type:Function,default:()=>!0},onResize:{type:Function,default:()=>!0},onRotateStart:{type:Function,default:()=>!0},onRotate:{type:Function,default:()=>!0},isConflictCheck:{type:Boolean,default:!1},snap:{type:Boolean,default:!1},snapBorder:{type:Boolean,default:!1},snapTolerance:{type:Number,default:5,validator:function(t){return typeof t=="number"}},scaleRatio:{type:Number,default:1,validator:t=>typeof t=="number"},handleInfo:{type:Object,default:()=>({size:8,offset:-4,switch:!0})}},data:function(){return{left:this.x,top:this.y,right:null,bottom:null,rotate:this.r,width:null,height:null,widthTouched:!1,heightTouched:!1,aspectFactor:null,parentWidth:null,parentHeight:null,minW:this.minWidth,minH:this.minHeight,maxW:this.maxWidth,maxH:this.maxHeight,handle:null,enabled:this.active,resizing:!1,dragging:!1,rotating:!1,zIndex:this.z,parentX:0,parentY:0}},computed:{handleStyle(){return t=>{if(!this.handleInfo.switch)return{display:this.enabled?"block":"none"};if(t==="rot"&&!this.rotatable)return{display:"none"};if(t!=="rot"&&!this.resizable)return{display:"none"};const e=(this.handleInfo.size/this.scaleRatio).toFixed(2),i=(this.handleInfo.offset/this.scaleRatio).toFixed(2),s=(e/2).toFixed(2),n={tl:{top:`${i}px`,left:`${i}px`},tm:{top:`${i}px`,left:`calc(50% - ${s}px)`},tr:{top:`${i}px`,right:`${i}px`},mr:{top:`calc(50% - ${s}px)`,right:`${i}px`},br:{bottom:`${i}px`,right:`${i}px`},bm:{bottom:`${i}px`,right:`calc(50% - ${s}px)`},bl:{bottom:`${i}px`,left:`${i}px`},ml:{top:`calc(50% - ${s}px)`,left:`${i}px`},rot:{top:`-${e*3}px`,left:"50%"}},o={width:n[t].width||`${e}px`,height:n[t].height||`${e}px`,top:n[t].top,left:n[t].left,right:n[t].right,bottom:n[t].bottom},l={tl:0,tm:1,tr:2,mr:3,br:4,bm:5,bl:6,ml:7,rot:8};if(t!=="rot"){const u=["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"],r=this.rotate+22.5,m=Math.floor(r/45);let p=(l[t]+m)%8;o.cursor=u[p]}return o.display=this.enabled?"block":"none",o}},style(){return{transform:`translate(${this.left}px, ${this.top}px) rotate(${this.rotate}deg)`,width:this.computedWidth,height:this.computedHeight,zIndex:this.zIndex,fontSize:this.handleInfo.size*2+"px",...this.dragging&&this.disableUserSelect?mt:dt}},actualHandles(){return!this.resizable&&!this.rotatable?[]:this.handles},computedWidth(){return this.w==="auto"&&!this.widthTouched?"auto":this.width+"px"},computedHeight(){return this.h==="auto"&&!this.heightTouched?"auto":this.height+"px"}},watch:{active(t){this.enabled=t,t?(this.updateParentSize(),z(this,"activated")):z(this,"deactivated")},x(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveHorizontally(t))},y(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveVertically(t))},z(t){(t>=0||t==="auto")&&(this.zIndex=t)},r(t){t>=0&&(this.rotate=t%360)},lockAspectRatio(t){t?this.outsideAspectRatio?this.aspectFactor=this.outsideAspectRatio:this.aspectFactor=this.width/this.height:this.aspectFactor=void 0},outsideAspectRatio(t){t&&(this.aspectFactor=t)},minWidth(t){t>0&&(this.minW=t),this.correctSize()},minHeight(t){t>0&&(this.minH=t),this.correctSize()},maxWidth(t){t>0&&(this.maxW=t),this.correctSize()},maxHeight(t){t>0&&(this.maxH=t),this.correctSize()},w(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeWidth(t))},h(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeHeight(t))}},created(){this.maxWidth&&this.minWidth>this.maxWidth&&console.warn("[Vdr warn]: Invalid prop: minWidth cannot be greater than maxWidth"),this.maxHeight&&this.minHeight>this.maxHeight&&console.warn("[Vdr warn]: Invalid prop: minHeight cannot be greater than maxHeight"),this.Center={x:0,y:0},this.TL={x:0,y:0},this.TR={x:0,y:0},this.BL={x:0,y:0},this.BR={x:0,y:0},this.resetBoundsAndMouseState()},mounted(){this.enableNativeDrag||(this.$el.ondragstart=()=>!1);const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e;const[i,s]=ut(this.$el);this.aspectFactor=(this.w!=="auto"?this.w:i)/(this.h!=="auto"?this.h:s),this.outsideAspectRatio&&(this.aspectFactor=this.outsideAspectRatio),this.width=this.w!=="auto"?this.w:i,this.height=this.h!=="auto"?this.h:s,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top,this.settingAttribute(),P(document.documentElement,"mousedown",this.deselect),P(document.documentElement,"touchend touchcancel",this.deselect),this.checkParentSize(),P(window,"resize",this.checkParentSize)},beforeUnmount:function(){k(document.documentElement,"mousedown",this.deselect),k(document.documentElement,"touchstart",this.handleUp),k(document.documentElement,"mousemove",this.move),k(document.documentElement,"touchmove",this.move),k(document.documentElement,"mouseup",this.handleUp),k(document.documentElement,"touchend touchcancel",this.deselect),k(window,"resize",this.checkParentSize)},methods:{correctSize(){this.width<this.minW&&(this.width=this.minW),this.height<this.minH&&(this.height=this.minH),this.height>this.maxH&&(this.height=this.maxH),this.width>this.maxW&&(this.width=this.maxW),z(this,"resizestop",this.left,this.top,this.width,this.height)},resetBoundsAndMouseState(){this.mouseClickPosition={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},this.bounds={minLeft:null,maxLeft:null,minRight:null,maxRight:null,minTop:null,maxTop:null,minBottom:null,maxBottom:null}},checkParentSize(){if(this.parent){const[t,e]=this.getParentSize();this.right=t-this.width-this.left,this.bottom=e-this.height-this.top,this.parentWidth=t,this.parentHeight=e}},updateParentSize(){const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e},getParentSize(){if(this.parent===!0){const t=window.getComputedStyle(this.$el.parentNode,null),e=this.$el.parentNode.getBoundingClientRect();return this.parentX=e.x,this.parentY=e.y,[Math.round(parseFloat(t.getPropertyValue("width"),10)),Math.round(parseFloat(t.getPropertyValue("height"),10))]}if(typeof this.parent=="string"){const t=document.querySelector(this.parent);if(!(t instanceof HTMLElement))throw new Error(`The selector ${this.parent} does not match any element`);return[t.offsetWidth,t.offsetHeight]}return[null,null]},elementTouchDown(t){B=Y.touch,this.elementDown(t)},elementMouseDown(t){B=Y.mouse,this.elementDown(t)},elementDown(t){if(t instanceof MouseEvent&&t.which!==1)return;const e=t.target||t.srcElement;if(this.$el.contains(e)){if(this.onDragStart(t)===!1)return;if(this.enabled||(this.enabled=!0,z(this,"activated"),z(this,"update:active",!0)),this.dragHandle&&!st(e,this.dragHandle,this.$el)||this.dragCancel&&st(e,this.dragCancel,this.$el)){this.dragging=!1;return}this.draggable&&(this.dragging=!0),this.mouseClickPosition.mouseX=t.touches?t.touches[0].pageX:t.pageX,this.mouseClickPosition.mouseY=t.touches?t.touches[0].pageY:t.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.parent&&(this.bounds=this.calcDragLimits()),P(document.documentElement,B.move,this.move),P(document.documentElement,B.stop,this.handleUp)}},calcDragLimits(){return this.checkParentSize(),this.rotatable?{minLeft:-this.width/2,maxLeft:this.parentWidth-this.width/2,minRight:this.width/2,maxRight:this.parentWidth+this.width/2,minTop:-this.height/2,maxTop:this.parentHeight-this.height/2,minBottom:this.height/2,maxBottom:this.parentHeight+this.height/2}:{minLeft:this.left%this.grid[0],maxLeft:Math.floor((this.parentWidth-this.width-this.left)/this.grid[0])*this.grid[0]+this.left,minRight:this.right%this.grid[0],maxRight:Math.floor((this.parentWidth-this.width-this.right)/this.grid[0])*this.grid[0]+this.right,minTop:this.top%this.grid[1],maxTop:Math.floor((this.parentHeight-this.height-this.top)/this.grid[1])*this.grid[1]+this.top,minBottom:this.bottom%this.grid[1],maxBottom:Math.floor((this.parentHeight-this.height-this.bottom)/this.grid[1])*this.grid[1]+this.bottom}},deselect(t){const e=t.target||t.srcElement,i=new RegExp(this.className+"-([trmbl]{2})","");!this.$el.contains(e)&&!i.test(e.className)&&(this.enabled&&!this.preventDeactivation&&(this.enabled=!1,z(this,"deactivated"),z(this,"update:active",!1)),k(document.documentElement,B.move,this.move)),this.resetBoundsAndMouseState()},handleTouchDown(t,e){B=Y.touch,this.handleDown(t,e)},handleDown(t,e){if(e instanceof MouseEvent&&e.which!==1||this.onResizeStart(t,e)===!1)return!1;e.stopPropagation&&e.stopPropagation(),this.handle=t,this.handle==="rot"?this.rotating=!0:this.resizing=!0;const i=this.$el.getBoundingClientRect(),{top:s,left:n,width:o,height:l}=i;this.Center.x=window.pageXOffset+n+o/2,this.Center.y=window.pageYOffset+s+l/2;let u=this.left,h=this.top,r=this.width,m=this.height,p=u+r/2,a=h+m/2,y=this.rotate;this.TL=F(p,a,u,h,y),this.TR=F(p,a,u+r,h,y),this.BL=F(p,a,u,h+m,y),this.BR=F(p,a,u+r,h+m,y),this.mouseClickPosition.mouseX=e.touches?e.touches[0].pageX:e.pageX,this.mouseClickPosition.mouseY=e.touches?e.touches[0].pageY:e.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.bounds=this.calcResizeLimits(),P(document.documentElement,B.move,this.move),P(document.documentElement,B.stop,this.handleUp)},calcResizeLimits(){let t=this.minW,e=this.minH,i=this.maxW,s=this.maxH;const[n,o]=this.grid,l=this.width,u=this.height,h=this.left,r=this.top,m=this.right,p=this.bottom;i=i-i%n,s=s-s%o;const a={minLeft:null,maxLeft:null,minTop:null,maxTop:null,minRight:null,maxRight:null,minBottom:null,maxBottom:null};return this.parent?(a.minLeft=h,a.maxLeft=h+Math.floor((l-t)/n),a.minTop=r,a.maxTop=r+Math.floor((u-e)/o),a.minRight=m,a.maxRight=m+Math.floor((l-t)/n),a.minBottom=p,a.maxBottom=p+Math.floor((u-e)/o),i&&(a.minLeft=Math.max(a.minLeft,this.parentWidth-m-i),a.minRight=Math.max(a.minRight,this.parentWidth-h-i)),s&&(a.minTop=Math.max(a.minTop,this.parentHeight-p-s),a.minBottom=Math.max(a.minBottom,this.parentHeight-r-s))):(a.minLeft=null,a.maxLeft=h+Math.floor(l-t),a.minTop=null,a.maxTop=r+Math.floor(u-e),a.minRight=null,a.maxRight=m+Math.floor(l-t),a.minBottom=null,a.maxBottom=p+Math.floor(u-e),i&&(a.minLeft=-(m+i),a.minRight=-(h+i)),s&&(a.minTop=-(p+s),a.minBottom=-(r+s)),this.lockAspectRatio&&i&&s&&(a.minLeft=Math.min(a.minLeft,-(m+i)),a.minTop=Math.min(a.minTop,-(s+p)),a.minRight=Math.min(a.minRight,-h-i),a.minBottom=Math.min(a.minBottom,-r-s))),a},move(t){this.resizing?this.handleResize(t):this.dragging?this.handleDrag(t):this.rotating&&this.handleRotate(t)},getMouseCoordinate(t){return t.type.indexOf("touch")!==-1?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.pageX||t.clientX+document.documentElement.scrollLeft,y:t.pageY||t.clientY+document.documentElement.scrollTop}},handleRotate(t){const{x:e,y:i}=this.getMouseCoordinate(t),s=e-this.Center.x,n=i-this.Center.y;this.rotate=(ct(s,n)+90)%360,z(this,"rotating",this.rotate)},async handleDrag(t){const e=this.axis,i=this.grid,s=this.bounds,n=this.mouseClickPosition,o=e&&e!=="y"?n.mouseX-(t.touches?t.touches[0].pageX:t.pageX):0,l=e&&e!=="x"?n.mouseY-(t.touches?t.touches[0].pageY:t.pageY):0,[u,h]=E(i,o,l,this.scaleRatio),r=R(n.left-u,s.minLeft,s.maxLeft),m=R(n.top-h,s.minTop,s.maxTop);if(this.onDrag(r,m)===!1)return;const p=R(n.right+u,s.minRight,s.maxRight),a=R(n.bottom+h,s.minBottom,s.maxBottom);this.left=r,this.top=m,this.right=p,this.bottom=a,await this.snapCheck(),z(this,"dragging",this.left,this.top)},moveHorizontally(t){const[e]=E(this.grid,t,this.top,this.scale),i=R(e,this.bounds.minLeft,this.bounds.maxLeft);this.left=i,this.right=this.parentWidth-this.width-i},moveVertically(t){const[,e]=E(this.grid,this.left,t,this.scale),i=R(e,this.bounds.minTop,this.bounds.maxTop);this.top=i,this.bottom=this.parentHeight-this.height-i},handleResize(t){const e=this.handle,i=this.scaleRatio,{TL:s,TR:n,BL:o,BR:l}=this;let{x:u,y:h}=this.getMouseCoordinate(t);!this.rotatable&&this.parent&&(u=R(u,this.parentX,this.parentX+this.parentWidth*i),h=R(h,this.parentY,this.parentY+this.parentHeight*i));let r=u-this.mouseClickPosition.mouseX,m=h-this.mouseClickPosition.mouseY;r=r/i,m=m/i;let p,a,y,W,T,b,w,H,M,c={},f={},g={},x={},d={},N={},S={},v={};if(e.includes("m")){switch(e){case"tm":p=r+(s.x+n.x)/2,a=m+(s.y+n.y)/2,c=o,f=s,g=l,x={x:p-c.x,y:a-c.y},d={x:f.x-c.x,y:f.y-c.y},y=(x.x*d.x+x.y*d.y)/(Math.pow(d.x,2)+Math.pow(d.y,2)),S={x:g.x-c.x,y:g.y-c.y},v={x:d.x*y,y:d.y*y};break;case"bm":p=r+(o.x+l.x)/2,a=m+(o.y+l.y)/2,c=s,f=o,g=n,x={x:p-c.x,y:a-c.y},d={x:f.x-c.x,y:f.y-c.y},y=(x.x*d.x+x.y*d.y)/(Math.pow(d.x,2)+Math.pow(d.y,2)),S={x:g.x-c.x,y:g.y-c.y},v={x:d.x*y,y:d.y*y};break;case"ml":p=r+(s.x+o.x)/2,a=m+(s.y+o.y)/2,c=l,f=o,g=n,x={x:p-c.x,y:a-c.y},d={x:f.x-c.x,y:f.y-c.y},y=(x.x*d.x+x.y*d.y)/(Math.pow(d.x,2)+Math.pow(d.y,2)),v={x:g.x-c.x,y:g.y-c.y},S={x:d.x*y,y:d.y*y};break;case"mr":p=r+(n.x+n.x)/2,a=m+(n.y+n.y)/2,c=o,f=l,g=s,x={x:p-c.x,y:a-c.y},d={x:f.x-c.x,y:f.y-c.y},y=(x.x*d.x+x.y*d.y)/(Math.pow(d.x,2)+Math.pow(d.y,2)),v={x:g.x-c.x,y:g.y-c.y},S={x:d.x*y,y:d.y*y};break}b=c.x+(S.x+v.x)/2,w=c.y+(S.y+v.y)/2,H=Math.sqrt(Math.pow(S.x,2)+Math.pow(S.y,2)),M=Math.sqrt(Math.pow(v.x,2)+Math.pow(v.y,2))}else{switch(e){case"tl":p=r+s.x,a=m+s.y,c=l,f=o,g=n;break;case"tr":p=r+n.x,a=m+n.y,c=o,f=l,g=s;break;case"bl":p=r+o.x,a=m+o.y,c=n,f=s,g=l;break;case"br":p=r+l.x,a=m+l.y,c=s,f=n,g=o;break}x={x:p-c.x,y:a-c.y},d={x:f.x-c.x,y:f.y-c.y},N={x:g.x-c.x,y:g.y-c.y},W=(x.x*d.x+x.y*d.y)/(Math.pow(d.x,2)+Math.pow(d.y,2)),T=(x.x*N.x+x.y*N.y)/(Math.pow(N.x,2)+Math.pow(N.y,2)),S={x:d.x*W,y:d.y*W},v={x:N.x*T,y:N.y*T},b=c.x+(S.x+v.x)/2,w=c.y+(S.y+v.y)/2,H=Math.sqrt(Math.pow(S.x,2)+Math.pow(S.y,2)),M=Math.sqrt(Math.pow(v.x,2)+Math.pow(v.y,2))}this.left=b-H/2,this.top=w-M/2,H=R(H,this.minW||0,this.maxW),M=R(M,this.minH||0,this.maxH),this.parent&&(H=R(H,0,this.parentWidth),M=R(M,0,this.parentHeight)),this.lockAspectRatio&&(H/M>this.aspectFactor?H=M*this.aspectFactor:M=H/this.aspectFactor),this.width=H,this.height=M,z(this,"resizing",this.left,this.top,this.width,this.height)},changeWidth(t){const[e]=E(this.grid,t,0,this.scale),i=this.parentWidth-e-this.left;let s=this.bottom;this.lockAspectRatio&&(s=this.bottom-(this.right-i)/this.aspectFactor);const n=et(this.parentWidth,this.left,i),o=it(this.parentHeight,this.top,s);this.right=i,this.bottom=s,this.width=n,this.height=o},changeHeight(t){const[,e]=E(this.grid,0,t,this.scale),i=this.parentHeight-e-this.top;let s=this.right;this.lockAspectRatio&&(s=this.right-(this.bottom-i)*this.aspectFactor);const n=et(this.parentWidth,this.left,s),o=it(this.parentHeight,this.top,i);this.right=s,this.bottom=i,this.width=n,this.height=o},async handleUp(t){this.handle=null;const e=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),i={vLine:[],hLine:[]};for(const o in i)i[o]=JSON.parse(JSON.stringify(e));const{x:s,y:n}=this.getMouseCoordinate(t);this.lastMouseX=s,this.lastMouseY=n,this.resizing&&(this.resizing=!1,await this.conflictCheck(),z(this,"refLineParams",i),z(this,"resizestop",this.left,this.top,this.width,this.height)),this.dragging&&(this.dragging=!1,await this.conflictCheck(),z(this,"refLineParams",i),z(this,"dragstop",this.left,this.top)),this.rotating&&(this.rotating=!1,z(this,"rotatestop",this.rotate)),this.resetBoundsAndMouseState(),k(document.documentElement,B.move,this.move)},settingAttribute(){this.$el.setAttribute("data-is-check",`${this.isConflictCheck}`),this.$el.setAttribute("data-is-snap",`${this.snap}`)},conflictCheck(){const t=this.top,e=this.left,i=this.width,s=this.height;if(this.isConflictCheck){const n=this.$el.parentNode.childNodes;for(const o of n)if(o.className!==void 0&&!o.className.split(" ").includes(this.classNameActive)&&o.getAttribute("data-is-check")!==null&&o.getAttribute("data-is-check")!=="false"){const l=o.offsetWidth,u=o.offsetHeight,[h,r]=this.formatTransformVal(o.style.transform),m=t>=r&&e>=h&&r+u>t&&h+l>e||t<=r&&e<h&&t+s>r&&e+i>h,p=e<=h&&t>=r&&e+i>h&&t<r+u||t<r&&e>h&&t+s>r&&e<h+l,a=t<=r&&e>=h&&t+s>r&&e<h+l||t>=r&&e<=h&&t<r+u&&e>h+l,y=t<=r&&e>=h&&t+s>r&&e<h+l||t>=r&&e<=h&&t<r+u&&e>h+l,W=e>=h&&t>=r&&e<h+l&&t<r+u||t>r&&e<=h&&e+i>h&&t<r+u,T=t<=r&&e>=h&&t+s>r&&e<h+l||t>=r&&e<=h&&t<r+u&&e+i>h;(m||p||a||y||W||T)&&(this.top=this.mouseClickPosition.top,this.left=this.mouseClickPosition.left,this.width=this.mouseClickPosition.width,this.height=this.mouseClickPosition.height)}}},async snapCheck(){if(this.snap){let t=this.width,e=this.height,i=this.left,s=this.left+t,n=this.top,o=this.top+e;const l=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),u={vLine:[],hLine:[]};for(const T in u)u[T]=JSON.parse(JSON.stringify(l));const h={value:{x:[[],[],[]],y:[[],[],[]]},display:[],position:[]},r=this.$el.parentNode.childNodes,{groupWidth:m,groupHeight:p,groupLeft:a,groupTop:y,bln:W}=await this.getActiveAll(r);W||(t=m,e=p,i=a,s=a+m,n=y,o=y+p);for(const T of r)if(T.className!==void 0&&!T.className.split(" ").includes(this.classNameActive)&&T.getAttribute("data-is-snap")!==null&&T.getAttribute("data-is-snap")!=="false"){const[b,w,H]=this.formatTransformVal(T.style.transform);if((H-this.rotate)%90===0){const M=T.offsetWidth,c=T.offsetHeight,f=b+M,g=w+c,x=Math.abs(n+e/2-(w+c/2))<=this.snapTolerance,d=Math.abs(i+t/2-(b+M/2))<=this.snapTolerance,N=Math.abs(w-o)<=this.snapTolerance,S=Math.abs(g-o)<=this.snapTolerance,v=Math.abs(w-n)<=this.snapTolerance,U=Math.abs(g-n)<=this.snapTolerance,O=Math.abs(b-s)<=this.snapTolerance,q=Math.abs(f-s)<=this.snapTolerance,j=Math.abs(b-i)<=this.snapTolerance,J=Math.abs(f-i)<=this.snapTolerance;h.display=[N,S,v,U,x,x,O,q,j,J,d,d],h.position=[w,g,w,g,w+c/2,w+c/2,b,f,b,f,b+M/2,b+M/2],W&&(N&&(this.top=w-e,this.bottom=this.parentHeight-this.top-e,h.value.y[0].push(b,f,i,s)),v&&(this.top=w,this.bottom=this.parentHeight-this.top-e,h.value.y[0].push(b,f,i,s)),S&&(this.top=g-e,this.bottom=this.parentHeight-this.top-e,h.value.y[1].push(b,f,i,s)),U&&(this.top=g,this.bottom=this.parentHeight-this.top-e,h.value.y[1].push(b,f,i,s)),O&&(this.left=b-t,this.right=this.parentWidth-this.left-t,h.value.x[0].push(w,g,n,o)),j&&(this.left=b,this.right=this.parentWidth-this.left-t,h.value.x[0].push(w,g,n,o)),q&&(this.left=f-t,this.right=this.parentWidth-this.left-t,h.value.x[1].push(w,g,n,o)),J&&(this.left=f,this.right=this.parentWidth-this.left-t,h.value.x[1].push(w,g,n,o)),x&&(this.top=w+c/2-e/2,this.bottom=this.parentHeight-this.top-e,h.value.y[2].push(b,f,i,s)),d&&(this.left=b+M/2-t/2,this.right=this.parentWidth-this.left-t,h.value.x[2].push(w,g,n,o)),this.snapBorder&&(Math.abs(this.left-0)<=this.snapTolerance&&(this.left=0,this.right=this.parentWidth-this.left-t),Math.abs(this.right-0)<=this.snapTolerance&&(this.right=0,this.left=this.parentWidth-this.width-this.right),Math.abs(this.top-0)<=this.snapTolerance&&(this.top=0,this.bottom=this.parentHeight-this.top-e),Math.abs(this.bottom-0)<=this.snapTolerance&&(this.bottom=0,this.top=this.parentHeight-this.bottom-e)));let C=this.bounds;this.left=R(this.left,C.minLeft,C.maxLeft),this.top=R(this.top,C.minTop,C.maxTop),this.right=R(this.right,C.minRight,C.maxRight),this.bottom=R(this.bottom,C.minBottom,C.maxBottom);const A=[0,1,0,1,2,2,0,1,0,1,2,2];for(let L=0;L<=A.length;L++){const ht=L<6?"y":"x",X=L<6?"hLine":"vLine";if(h.display[L]){const{origin:ot,length:nt}=this.calcLineValues(h.value[ht][A[L]]);u[X][A[L]].display=h.display[L],u[X][A[L]].position=h.position[L]+"px",u[X][A[L]].origin=ot,u[X][A[L]].lineLength=nt}}}}z(this,"refLineParams",u)}},calcLineValues(t){const e=Math.max(...t)-Math.min(...t)+"px",i=Math.min(...t)+"px";return{length:e,origin:i}},async getActiveAll(t){const e=[],i=[],s=[];let n=0,o=0,l=0,u=0;for(const m of t)m.className!==void 0&&m.className.split(" ").includes(this.classNameActive)&&e.push(m);const h=e.length;if(h>1){for(const m of e){const p=m.offsetLeft,a=p+m.offsetWidth,y=m.offsetTop,W=y+m.offsetHeight;i.push(p,a),s.push(y,W)}n=Math.max(...i)-Math.min(...i),o=Math.max(...s)-Math.min(...s),l=Math.min(...i),u=Math.min(...s)}return{groupWidth:n,groupHeight:o,groupLeft:l,groupTop:u,bln:h===1}},formatTransformVal(t){let[e,i,s=0]=t.match(/[\d|.]+/g);return i===void 0&&(i=0),[Number(e),Number(i),s]}},emits:["update:active","rotating","dragging","resizing","refLineParams","resizestop","dragstop","rotatestop","activated","deactivated"]};const pt=["onMousedown","onTouchstart"];function ft(t,e,i,s,n,o){return V(),$("div",{style:Q(o.style),class:Z([{[i.classNameActive]:t.enabled,[i.classNameDragging]:t.dragging,[i.classNameResizing]:t.resizing,[i.classNameDraggable]:i.draggable,[i.classNameResizable]:i.resizable,[i.classNameRotating]:t.rotating,[i.classNameRotatable]:i.rotatable},i.className]),onMousedown:e[0]||(e[0]=(...l)=>o.elementMouseDown&&o.elementMouseDown(...l)),onTouchstart:e[1]||(e[1]=(...l)=>o.elementTouchDown&&o.elementTouchDown(...l))},[(V(!0),$(at,null,rt(o.actualHandles,(l,u)=>(V(),$("div",{key:u,class:Z([i.classNameHandle,i.classNameHandle+"-"+l]),style:Q(o.handleStyle(l,u)),onMousedown:K(h=>o.handleDown(l,h),["stop","prevent"]),onTouchstart:K(h=>o.handleTouchDown(l,h),["stop","prevent"])},[G(t.$slots,l)],46,pt))),128)),G(t.$slots,"default")],38)}D.render=ft;D.__scopeId="data-v-3c286975";D.__file="src/components/vue-drag-resize-rotate/index.vue";function I(t){I.installed||(I.installed=!0,t.component("VueDragResizeRotate",D))}D.install=I;export{D as s};
