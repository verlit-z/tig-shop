import{d as q,e as x,f as c,g as i,y as o,l as s,h as a,aH as se,k as n,t as r,_ as W,v as oe,r as S,a as L,a2 as ie,o as re,J as y,j as v,K as l,F as B,i as p,m as de}from"./index-BGgofOm4.js";import{c as ne,d as ue,o as F,g as pe,u as ce}from"./order-BPrSE32N.js";import"./index-BdoKLCH8.js";import{O as me}from"./OrderMoney-CAEPMuJ3.js";import{p as T}from"./format-CpNC4fsQ.js";import"./Verify.vue_vue_type_style_index_0_lang-BlxcdrWa.js";import"./zh-cn-CbKWuMQl.js";/* empty css                                                                    */import{P as ve}from"./ProductCard-BI6ohnfl.js";import _e from"./OperationLog-BouDazj4.js";import fe from"./LogisticsTracking-BQZekLhD.js";import{M as ye}from"./MobileCard-BC3dXj5F.js";import{_ as be}from"./EditSign.vue_vue_type_style_index_0_lang-DT1gPWcb.js";import ge from"./SignTag-CbSUBbBb.js";import{h as ke}from"./receiptPrint--8LpdTMO.js";import{_ as b}from"./DialogForm.vue_vue_type_script_setup_true_lang-BTf40oxg.js";import{M as $}from"./index-BS7Hjr9I.js";import{S as he}from"./index-Bz20Jq_8.js";import"./Pagination-Nz0PhK3s.js";const Se={class:"tooltip-con"},xe={class:"tooltip-title"},Ie={key:0,class:"iconfont-admin icon-yiwen"},Oe={style:{"max-width":"300px"}},Ce=q({__name:"Tooltip",props:{content:{type:String,default:""},ico:{type:Boolean,default:!1},placement:{type:String,default:"top"}},setup(D){const C=D;return(P,f)=>{const k=x("el-tooltip");return i(),c("div",Se,[o(k,{effect:"light",placement:C.placement,"show-after":100},{content:s(()=>[a("div",Oe,r(C.content),1)]),default:s(()=>[a("div",xe,[se(P.$slots,"default",{},void 0,!0),C.ico?(i(),c("i",Ie)):n("",!0)])]),_:3},8,["placement"])])}}}),we=W(Ce,[["__scopeId","data-v-52ec2082"]]),Ae={key:0},Ne={key:0,class:"container-card"},Te={class:"border-bottom"},De={key:0},Pe={key:0,style:{"margin-left":"10px"}},ze={class:"mt10"},Me={key:1,class:"button-card babyBlue pd20"},Be={class:"container-card"},$e={class:"info-card"},Ve={class:"card-title"},Re={class:"min-title"},Ee={class:"card-li"},Le={class:"li-info"},Fe={class:"card-li"},qe={class:"li-info"},We={class:"card-li"},je={class:"li-info"},Ue={key:0,class:"card-li"},Ge={class:"li-info"},He={key:1,class:"card-li"},Je={class:"li-info"},Ke={key:2,class:"card-li"},Qe={class:"li-info"},Xe={class:"card-li"},Ye={class:"li-info"},Ze={class:"card-li"},et={class:"li-info"},tt={class:"card-title"},at={class:"min-title"},lt={class:"card-li"},st={class:"li-info"},ot={class:"card-li"},it={class:"li-info"},rt={class:"card-li"},dt={class:"li-info"},nt={class:"card-li"},ut={class:"li-info"},pt={class:"card-title"},ct={class:"card-li"},mt={class:"li-info"},vt={class:"card-li"},_t={class:"li-info"},ft={class:"container-card"},yt={class:"title"},bt={class:"product-card-tp"},gt={key:0,class:"gift"},kt={key:1},ht={class:"total"},St={class:"gray",style:{"margin-right":"16px"}},xt={class:"title"},It={key:1,class:"container-card"},Ot=q({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isParent:{type:Boolean,default:!1},isDialog:Boolean},emits:["submitCallback","callback","update:confirmLoading","close"],setup(D,{expose:C,emit:P}){oe();const f=S(localStorage.getItem("adminType")),k=P,I=D,h=S(!0),z=L().currentRoute.value.query,V=S(I.isDialog?I.act:String(z.act)),w=S(I.isDialog?I.id:Number(z.id)),O=S(I.isDialog?I.isParent:!!z.isParent),j=V.value==="add"?"create":"update",U=ie(),e=S({balance:0,couponAmount:0,pointsAmount:0,productAmount:0,totalProductWeight:0,orderId:0,items:[],payType:0,availableActions:{},totalAmount:0,paidAmount:0,updateOrderSn:0,unpaidAmount:0,discountAmount:0}),G=S(!1);re(()=>{h.value=!0,M(),ee()});const M=async()=>{try{const u=await ne(V.value,{id:w.value});Object.assign(e.value,u)}catch(u){y.error(u.message),k("close")}finally{h.value=!1}},H=()=>{$.confirm({title:"确认拆分订单吗？",onOk:async()=>{try{const u=await ue({id:w.value});y.success("操作成功"),_()}catch(u){y.error(u.message)}finally{h.value=!1}}})},J=()=>{$.confirm({title:"确认删除订单吗？",content:"被删除的订单可以通过筛选查找并恢复",onOk:async()=>{try{const u=await F("delOrder",{id:w.value});y.success("操作成功"),_()}catch(u){y.error(u.message)}finally{h.value=!1}}})},K=()=>{$.confirm({title:"确认订单已收货吗？",onOk:async()=>{try{const u=await F("confirmReceipt",{id:w.value});y.success("操作成功"),_()}catch(u){y.error(u.message)}finally{h.value=!1}}})},_=(u={})=>{M(),k("callback",u)},Q=async()=>{await U.value.validate();try{k("update:confirmLoading",!0);const u=await ce(j,{id:w.value,...e.value});k("submitCallback",u),y.success("操作成功")}catch(u){y.error(u.message)}finally{k("update:confirmLoading",!1)}},X=()=>{Q()},Y=L(),Z=async(u,t)=>{let A=location.origin+Y.options.history.base+u;try{t==="order"&&await pe({ids:e.value.orderId}),window.open(A,"_blank")}catch(m){y.error(m.message)}},ee=async()=>{try{let u=await ke();G.value=!0}catch(u){console.log(u)}};return C({onFormSubmit:X}),(u,t)=>{var R,E;const A=x("el-divider"),m=x("el-button"),te=x("el-space"),g=x("el-table-column"),ae=x("el-table"),le=x("a-spin");return i(),c(B,null,[h.value?n("",!0):(i(),c("div",Ae,[O.value?n("",!0):(i(),c("div",Ne,[a("div",Te,[l(" 订单编号："+r(e.value.orderSn)+" ",1),o(A,{direction:"vertical"}),l(" 下单时间："+r(e.value.addTime)+" ",1),e.value.storeTitle?(i(),c(B,{key:0},[o(A,{direction:"vertical"}),a("span",null,"下单店铺："+r(e.value.storeTitle),1)],64)):n("",!0)]),o(te,{size:10,class:"button-card"},{default:s(()=>[e.value.isChangeOrderStatus?(i(),c("div",De,[e.value.availableActions.deliver?(i(),v(p(b),{key:0,params:{id:e.value.orderId,preOrderStatus:e.value.preOrderStatus},isDrawer:"",path:"order/order/src/ChangeStatus",title:"取消订单",width:"600px",onOkCallback:_},{default:s(()=>[o(m,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[3]||(t[3]=[l(" 取消订单 ",-1)])),_:1,__:[3]})]),_:1},8,["params"])):n("",!0),e.value.availableActions.confirmReceipt?(i(),v(p(b),{key:1,params:{id:e.value.orderId,preOrderStatus:e.value.preOrderStatus},isDrawer:"",path:"order/order/src/ChangeStatus",title:"取消发货",width:"600px",onOkCallback:_},{default:s(()=>[o(m,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[4]||(t[4]=[l(" 取消发货 ",-1)])),_:1,__:[4]})]),_:1},8,["params"])):n("",!0)])):n("",!0),e.value.availableActions.setPaid?(i(),v(p(b),{key:1,params:{act:"setPaid",id:e.value.orderId},isDrawer:"",path:"order/order/src/Operation",title:"设置为已支付",width:"600px",onOkCallback:_},{default:s(()=>[o(m,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[5]||(t[5]=[l(" 设置为已支付 ",-1)])),_:1,__:[5]})]),_:1},8,["params"])):n("",!0),e.value.availableActions.cancelOrder?(i(),v(p(b),{key:2,params:{act:"cancelOrder",id:e.value.orderId},isDrawer:"",path:"order/order/src/Operation",title:"取消订单",width:"600px",onOkCallback:_},{default:s(()=>[o(m,{bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[6]||(t[6]=[l(" 取消订单 ",-1)])),_:1,__:[6]})]),_:1},8,["params"])):n("",!0),e.value.availableActions.delOrder?(i(),v(m,{key:3,bg:"",size:"small",text:"",type:"primary",onClick:J},{default:s(()=>t[7]||(t[7]=[l(" 删除订单 ",-1)])),_:1,__:[7]})):n("",!0),e.value.availableActions.deliver&&f.value=="admin"&&!e.value.vendorId||e.value.availableActions.deliver&&f.value=="vendor"?(i(),v(p(b),{key:4,params:{act:"detail",id:e.value.orderId},title:"订单发货 "+e.value.orderSn,isDrawer:"",path:"order/order/src/ToShip",width:"900px",onOkCallback:_},{default:s(()=>[o(m,{bg:"",size:"small",text:"",type:"danger"},{default:s(()=>t[8]||(t[8]=[l(" 去发货 ",-1)])),_:1,__:[8]})]),_:1},8,["params","title"])):n("",!0),e.value.availableActions.confirmReceipt?(i(),v(m,{key:5,bg:"",size:"small",text:"",type:"primary",onClick:K},{default:s(()=>t[9]||(t[9]=[l(" 确认已收货 ",-1)])),_:1,__:[9]})):n("",!0),e.value.availableActions.splitOrder?(i(),v(m,{key:6,bg:"",size:"small",text:"",type:"danger",onClick:H},{default:s(()=>[t[10]||(t[10]=l(" 拆分店铺订单",-1)),o(p(we),{ico:"",content:"该订单来自多个店铺且还未拆分，在做任何操作前，您需要先拆分该订单"})]),_:1,__:[10]})):n("",!0),o(m,{bg:"",size:"small",text:"",type:"primary",onClick:t[0]||(t[0]=d=>Z(`/print/orderPrint?ids=${e.value.orderId}`,"order"))},{default:s(()=>t[11]||(t[11]=[l(" 打印配送单 ",-1)])),_:1,__:[11]})]),_:1}),e.value.mark?(i(),c("div",Pe,[o(be,{title:"编辑标记",item:e.value,onCallBack:M},{default:s(()=>[o(m,{link:"",type:"primary",style:{"font-size":"12px"}},{default:s(()=>t[12]||(t[12]=[l("标记订单",-1)])),_:1,__:[12]}),a("div",ze,[o(ge,{class:"check-box tag",value:e.value.mark},null,8,["value"]),l(" "+r(e.value.adminNote),1)])]),_:1},8,["item"])])):n("",!0),e.value.stepStatus?(i(),c("div",Me,[o(p(he),{current:e.value.stepStatus.current,size:"small",status:e.value.stepStatus.status,items:e.value.stepStatus.steps},null,8,["current","status","items"])])):n("",!0)])),a("div",Be,[t[32]||(t[32]=a("div",{class:"title"},"订单明细",-1)),a("div",$e,[a("div",Ve,[a("div",Re,[t[14]||(t[14]=l(" 收货人信息 ",-1)),O.value?n("",!0):(i(),v(p(b),{key:0,params:{act:"detail",id:e.value.orderId,form:e.value},isDrawer:"",path:"order/order/src/EditConsignee",title:"编辑收货人信息",width:"550px",onOkCallback:_,disabled:f.value=="admin"&&e.value.vendorId},{default:s(()=>[o(m,{bg:"",class:"ml10",size:"small",text:"",type:"primary",disabled:f.value=="admin"&&e.value.vendorId},{default:s(()=>t[13]||(t[13]=[l(" 编辑 ",-1)])),_:1,__:[13]},8,["disabled"])]),_:1},8,["params","disabled"]))]),a("ul",null,[a("li",Ee,[t[15]||(t[15]=l(" 会员名称：",-1)),a("span",Le,r(((R=e.value.user)==null?void 0:R.nickname)||((E=e.value.user)==null?void 0:E.username)||"--"),1)]),a("li",Fe,[t[16]||(t[16]=l("     收货人：",-1)),a("span",qe,r(e.value.consignee?e.value.consignee:"--"),1)]),a("li",We,[t[17]||(t[17]=l(" 联系电话：",-1)),a("span",je,[o(ye,{mobile:e.value.mobile},null,8,["mobile"])])]),e.value.telephone?(i(),c("li",Ue,[t[18]||(t[18]=l(" 手机：",-1)),a("span",Ge,r(e.value.telephone?e.value.telephone:"--"),1)])):n("",!0),e.value.email?(i(),c("li",He,[t[19]||(t[19]=l(" 电子邮件：",-1)),a("span",Je,r(e.value.email),1)])):n("",!0),e.value.postcode?(i(),c("li",Ke,[t[20]||(t[20]=l(" 邮政编码：",-1)),a("span",Qe,r(e.value.postcode),1)])):n("",!0),a("li",Xe,[t[21]||(t[21]=l(" 收货地址： ",-1)),a("span",Ye,r(e.value.userAddress?e.value.userAddress:"--"),1)]),a("li",Ze,[t[22]||(t[22]=l(" 订单备注： ",-1)),a("span",et,r(e.value.buyerNote?e.value.buyerNote:"--"),1)])])]),a("div",tt,[a("div",at,[t[24]||(t[24]=l(" 配送信息 ",-1)),O.value?n("",!0):(i(),v(p(b),{key:0,params:{act:"detail",id:e.value.orderId},isDrawer:"",path:"order/order/src/EditShipping",title:"编辑配送方式",width:"600px",disabled:!e.value.availableActions.modifyShippingInfo||f.value=="admin"&&e.value.vendorId,onOkCallback:_},{default:s(()=>[o(m,{disabled:!e.value.availableActions.modifyShippingInfo||f.value=="admin"&&e.value.vendorId,bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[23]||(t[23]=[l(" 编辑 ",-1)])),_:1,__:[23]},8,["disabled"])]),_:1},8,["params","disabled"]))]),a("ul",null,[a("li",lt,[t[25]||(t[25]=l(" 配送方式：",-1)),a("span",st,r(e.value.shippingTypeName),1)]),a("li",ot,[t[26]||(t[26]=l(" 发货时间：",-1)),a("span",it,r(e.value.shippingTime?e.value.shippingTime:"--"),1)]),a("li",rt,[t[27]||(t[27]=l(" 物流名称：",-1)),a("span",dt,r(e.value.logisticsName?e.value.logisticsName:"--"),1)]),a("li",nt,[t[28]||(t[28]=l(" 发货单号：",-1)),a("span",ut,r(e.value.trackingNo?e.value.trackingNo:"--"),1)])])]),a("div",pt,[t[31]||(t[31]=a("div",{class:"min-title"},"付款信息",-1)),a("ul",null,[a("li",ct,[t[29]||(t[29]=l(" 支付方式：",-1)),a("span",mt,r(e.value.payTypeId===1?"在线支付":e.value.payTypeId===2?"货到付款":"线下支付"),1)]),a("li",vt,[t[30]||(t[30]=l(" 付款时间：",-1)),a("span",_t,r(e.value.payTime?e.value.payTime:"--"),1)])])])])]),a("div",ft,[a("div",yt,[t[34]||(t[34]=l(" 商品信息 ",-1)),O.value?n("",!0):(i(),v(p(b),{key:0,params:{act:"detail",id:e.value.orderId},isDrawer:"",path:"order/order/src/EditProduct",title:"编辑商品信息",width:"1050px",disabled:!e.value.availableActions.modifyOrder||f.value=="admin"&&e.value.vendorId,onOkCallback:_},{default:s(()=>[o(m,{disabled:!e.value.availableActions.modifyOrder||f.value=="admin"&&e.value.vendorId,bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[33]||(t[33]=[l(" 编辑 ",-1)])),_:1,__:[33]},8,["disabled"])]),_:1},8,["params","disabled"]))]),o(ae,{data:e.value.items},{default:s(()=>[o(g,{label:"商品名称",prop:"productId",width:"220"},{default:s(({row:d})=>[a("div",bt,[d.isGift?(i(),c("div",gt,"赠")):n("",!0),o(p(ve),{picThumb:d.picThumb,productId:d.productId,productName:d.productName,productType:d.productType,url:d.url},null,8,["picThumb","productId","productName","productType","url"])])]),_:1}),o(g,{label:"属性",prop:"productAttr"},{default:s(({row:d})=>[l(r(d.skuValue||"无属性"),1)]),_:1}),o(g,{label:"附加规格",prop:"extraSkuData"},{default:s(({row:d})=>[d.extraSkuData&&d.extraSkuData.length>0?(i(!0),c(B,{key:0},de(d.extraSkuData,N=>(i(),c("div",{class:"extraskudata",key:N},r(N.attrName+N.attrValue+p(T)(N.totalAttrPrice)),1))),128)):(i(),c("div",kt,"无附加规格"))]),_:1}),o(g,{label:"商品编号",width:"150"},{default:s(({row:d})=>[l(r(d.productSn),1)]),_:1}),o(g,{label:"价格",prop:"price"},{default:s(({row:d})=>[l(r(p(T)(d.price)),1)]),_:1}),o(g,{label:"数量",prop:"quantity"}),o(g,{label:"库存",prop:"stock"},{default:s(({row:d})=>[l(r(d.stock||"-"),1)]),_:1}),o(g,{label:"小计",prop:"subtotal"},{default:s(({row:d})=>[l(r(p(T)(d.subtotal)),1)]),_:1})]),_:1},8,["data"]),a("div",ht,[a("span",St,"商品总重量："+r(e.value.totalProductWeight)+"kg",1),a("span",null,"合计："+r(p(T)(Number(e.value.productAmount)-Number(e.value.couponAmount)-Number(e.value.discountAmount))),1)]),a("div",xt,[t[36]||(t[36]=l(" 订单金额 ",-1)),O.value?n("",!0):(i(),v(p(b),{key:0,params:{act:"detail",id:e.value.orderId},isDrawer:"",path:"order/order/src/EditMoney",title:"编辑金额",width:"600px",disabled:!e.value.availableActions.modifyOrderMoney||f.value=="admin"&&e.value.vendorId,onOkCallback:_},{default:s(()=>[o(m,{disabled:!e.value.availableActions.modifyOrderMoney||f.value=="admin"&&e.value.vendorId,bg:"",class:"buttonColor",size:"small",text:"",type:"primary"},{default:s(()=>t[35]||(t[35]=[l(" 编辑 ",-1)])),_:1,__:[35]},8,["disabled"])]),_:1},8,["params","disabled"]))]),o(p(me),{modelValue:e.value,"onUpdate:modelValue":t[1]||(t[1]=d=>e.value=d)},null,8,["modelValue"])]),e.value.orderId&&(e.value.orderStatus===2||e.value.orderStatus===5)?(i(),c("div",It,[t[37]||(t[37]=a("div",{class:"title"},"物流追踪",-1)),o(fe,{trackingNo:e.value.trackingNo,logisticsName:e.value.logisticsName,shippingMethod:e.value.shippingMethod,id:e.value.orderId,"onUpdate:id":t[2]||(t[2]=d=>e.value.orderId=d)},null,8,["trackingNo","logisticsName","shippingMethod","id"])])):n("",!0),O.value?n("",!0):(i(),v(_e,{key:2,orderId:e.value.orderId},null,8,["orderId"]))])),o(le,{spinning:h.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])],64)}}}),Gt=W(Ot,[["__scopeId","data-v-5540043e"]]);export{Gt as default};
