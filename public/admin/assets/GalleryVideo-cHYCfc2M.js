import"./index-BdoKLCH8.js";import{i as B}from"./format-CpNC4fsQ.js";import{d as re,r as y,Y as ce,c as ve,R as ue,o as pe,J as k,e as p,f as c,g as n,h as l,k as m,n as $,i as a,F as L,m as z,t as h,y as i,l as d,K as E,j as N,_ as me}from"./index-BGgofOm4.js";/* empty css                                                                    */import{P as _e}from"./Pagination-Nz0PhK3s.js";import{u as ye}from"./gallery-CXZTGefd.js";import{h as A,i as fe,j as ge,k as ke}from"./gallery-jVLe5Rxg.js";import{_ as C}from"./DialogForm.vue_vue_type_script_setup_true_lang-BTf40oxg.js";import{M as be}from"./index-BS7Hjr9I.js";const Ce={class:"gallery_warp",id:"gallery_warp"},Ge={class:"lyecs_gallery_box"},Ie={class:"gallery-folder-warp"},Ve={class:"gallery-folder-list"},he=["onClick"],we={class:"item-name"},xe={class:"folder-item-edit"},Oe={class:"add-gallery-folder-con"},$e={class:"gallery-pics-warp"},Le={class:"gallery-main",id:"gallery-main"},ze={class:"gallery-pic-action"},Ee={class:"gallery-pic-action-l"},Ne={class:"gallery-pic-action-r"},Se={class:"gallery-list",suppressScrollX:!1},Te={key:0,class:"gallery-list-item"},Fe=["onClick"],Re={key:0,class:"video-empty"},Ue={class:"flex",style:{padding:"5px",gap:"5px"}},Be={class:"video-actions"},Me={class:"desc"},je={key:1,class:"gallery-list-ul"},De=["onClick"],Je={class:"video-item-box-icon"},Ke=["src"],Xe={class:"video-actions"},Ye={class:"flex flex-justify-between",style:{width:"100%"}},qe={class:"duration"},Ae={class:"flex"},He={class:"duration"},Qe={class:"desc"},We={key:2,class:"empty-warp"},Ze={key:0,class:"empty-bg"},Pe={class:"gallery-list-page"},el=re({__name:"GalleryVideo",props:{isMultiple:{type:Boolean,default:!1}},emits:["submitCallback","okType"],setup(H,{expose:Q,emit:W}){const Z=H,o=ye(),w=y([]),M=y([]),j=y([]),D=y(),f=y({}),G=y([]),{isMultiple:P}=ce(Z),_=y([]),S=y(6),x=y(!0),g=ve(()=>j.value.concat(M.value)),I=async s=>{try{const e=await A({galleryId:s});Object.assign(w.value,e.records),u(s,o.page),T()}catch(e){k.error(e.message)}};ue(()=>o.isRefresh,s=>{s&&(o.isRefresh=!1,I(o.videoGalleryId))}),pe(()=>{o.page=1,o.videoGalleryId=0,o.topVideoGalleryId=0,T()});const T=async()=>{try{const s=await A({galleryId:0});w.value=s.records,u(o.videoGalleryId,o.page)}catch(s){k.error(s.message)}},J=s=>{u(s),o.page=1,o.videoGalleryId=s,o.topVideoGalleryId=s},ee=s=>{u(o.videoGalleryId,s)},u=async(s,e=1)=>{x.value=!0,o.page=e;try{const r=await fe({id:s,page:e,sortOrder:o.sortOrder,size:S.value});j.value=[],M.value=r.galleryVideoInfoPage.records,G.value=r.childGalleryList,D.value=r.galleryVideoInfoPage.total,o.videoGalleryId=s,f.value=r.galleryVideo}catch(r){k.error(r.message)}finally{x.value=!1}},le=s=>{o.sortOrder=s,u(o.videoGalleryId)},F=(s,e)=>{e==!0?I(o.videoGalleryId):u(o.videoGalleryId)},R=s=>{s==0?I(o.videoGalleryId):u(o.videoGalleryId)},te=async s=>{try{const e=await ge({id:s});k.success("操作成功"),o.topVideoGalleryId=0,o.videoGalleryId=0,I(o.videoGalleryId)}catch(e){k.error(e.message)}},K=async(s,e)=>{try{const r=await ke({id:s});k.success("操作成功"),G.value.splice(e,1),o.topVideoGalleryId==s&&(o.topVideoGalleryId=0,o.videoGalleryId=0),I(o.videoGalleryId)}catch(r){k.error(r.message)}},oe=(s,e)=>{be.confirm({title:"您确认要删除所选相册吗？",okType:"danger",onOk(){K(s,e),T()}})},U=W;U("okType",!1);const se=(s,e)=>{let r=!1;if(_.value.length>0)for(let b in _.value)_.value[b].id==s.id&&(g.value[e].selected=!1,_.value.splice(b,1),r=!0);if(r==!1){if(P.value==!1){_.value=[];for(let b in g.value)g.value[b].selected=!1}g.value[e].selected=!0,_.value.push({id:s.id,videoId:s.id,videoCover:s.videoCover,videoUrl:s.videoUrl,videoName:s.videoName,format:s.format})}U("okType",_.value.length>0)};return Q({onFormSubmit:()=>{U("submitCallback",_.value)}}),(s,e)=>{const r=p("el-dropdown-item"),b=p("el-dropdown-menu"),ae=p("el-dropdown"),O=p("el-button"),ie=p("el-space"),X=p("el-option"),de=p("el-select"),Y=p("el-image"),q=p("a-popconfirm"),ne=p("a-spin");return n(),c("div",Ce,[l("div",Ge,[l("div",Ie,[l("div",Ve,[w.value?(n(),c("div",{key:0,class:$("gallery-folder-item "+(a(o).topVideoGalleryId==0?"current":"")),onClick:e[0]||(e[0]=t=>J(0))},e[9]||(e[9]=[l("div",{class:"folder-item-con"},[l("i",{class:"item-ico"}),l("div",{class:"item-name"},"全部")],-1)]),2)):m("",!0),(n(!0),c(L,null,z(w.value,(t,V)=>(n(),c("div",{class:$("gallery-folder-item "+(a(o).topVideoGalleryId==t.id?"current":""))},[l("div",{class:$("folder-item-con"),onClick:v=>J(t.id)},[e[10]||(e[10]=l("i",{class:"item-ico"},null,-1)),l("div",we,h(t.name),1)],8,he),l("div",xe,[i(ae,{trigger:"click"},{dropdown:d(()=>[i(b,null,{default:d(()=>[i(a(C),{width:"400px",onOkCallback:v=>F(t.id,!0),title:"编辑相册",path:"gallery/video/GalleryVideoEdit",params:{act:"detail",id:t.id}},{default:d(()=>[i(r,null,{default:d(()=>e[11]||(e[11]=[l("div",null,"编辑相册",-1)])),_:1,__:[11]})]),_:2},1032,["onOkCallback","params"]),i(r,{onClick:v=>oe(t.id,V)},{default:d(()=>e[12]||(e[12]=[l("div",null,"删除",-1)])),_:2,__:[12]},1032,["onClick"])]),_:2},1024)]),default:d(()=>[e[13]||(e[13]=l("i",{title:"编辑",class:"ico-font"},"",-1))]),_:2,__:[13]},1024)])],2))),256))]),l("div",Oe,[i(a(C),{width:"400px",onOkCallback:e[1]||(e[1]=t=>R(0)),title:"添加视频相册",path:"gallery/video/GalleryVideoEdit",params:{act:"add",parentId:0}},{default:d(()=>[i(O,{class:"add-gallery-folder-btn"},{default:d(()=>e[14]||(e[14]=[l("em",null,"+",-1),E(" 添加视频相册",-1)])),_:1,__:[14]})]),_:1})])]),l("div",$e,[l("div",Le,[l("div",ze,[l("div",Ee,[i(ie,null,{default:d(()=>[i(a(C),{width:"700px",onOkCallback:e[2]||(e[2]=t=>u(a(o).videoGalleryId,a(o).page)),title:"上传视频",path:"gallery/video/VideoEdit",params:{act:"add",galleryId:a(o).videoGalleryId},onCallback:e[3]||(e[3]=t=>R(0))},{default:d(()=>[i(O,{type:"primary"},{default:d(()=>e[15]||(e[15]=[E("上传视频",-1)])),_:1,__:[15]})]),_:1},8,["params"]),f.value&&f.value.parentId>0?(n(),N(O,{key:0,class:"lyecs-btn return-gallery-btn",onClick:e[4]||(e[4]=t=>u(f.value.parentId))},{default:d(()=>e[16]||(e[16]=[E("返回上一级",-1)])),_:1,__:[16]})):m("",!0),f.value&&a(o).videoGalleryId>0?(n(),N(a(C),{key:1,width:"400px",onOkCallback:e[5]||(e[5]=t=>R(f.value.id)),title:"添加子相册",path:"gallery/video/GalleryVideoEdit",params:{act:"add",parentId:f.value.id}},{default:d(()=>[i(O,{class:"lyecs-btn add-gallery-btn"},{default:d(()=>e[17]||(e[17]=[E("添加子相册",-1)])),_:1,__:[17]})]),_:1},8,["params"])):m("",!0)]),_:1})]),l("div",Ne,[e[18]||(e[18]=l("span",{style:{"word-break":"keep-all"}},"排序：",-1)),i(de,{onChange:le,class:"a-select-ui gallery_pic_sort",modelValue:a(o).sortOrder,"onUpdate:modelValue":e[6]||(e[6]=t=>a(o).sortOrder=t)},{default:d(()=>[i(X,{label:"时间从先到后",value:"asc"}),i(X,{label:"时间从后到先",value:"desc"})]),_:1},8,["modelValue"])])]),i(ne,{spinning:x.value},{default:d(()=>[l("div",Se,[G.value.length>0&&a(o).videoGalleryId>0?(n(),c("ul",Te,[(n(!0),c(L,null,z(G.value,(t,V)=>(n(),c("li",{key:t.id,class:"gallery-video-item"},[l("div",{class:"video-item-box",onClick:v=>u(t.id)},[t.galleryVideoInfoList.length==0?(n(),c("span",Re,"相册为空")):m("",!0),l("div",Ue,[(n(!0),c(L,null,z(t.galleryVideoInfoList,(v,tl)=>(n(),N(Y,{fit:"cover",class:"gallery_pics",src:a(B)(v.videoCover)},null,8,["src"]))),256))])],8,Fe),l("p",Be,[i(a(C),{width:"400px",onOkCallback:v=>F(t.id,!1),title:"编辑相册",path:"gallery/video/GalleryVideoEdit",params:{act:"detail",id:t.id,parentId:t.parentId}},{default:d(()=>e[19]||(e[19]=[l("a",{class:"btn-edit ico-font"},"",-1)])),_:2,__:[19]},1032,["onOkCallback","params"]),i(q,{title:"您确认要删掉该相册吗？",onConfirm:v=>K(t.id,V),placement:"bottom"},{default:d(()=>e[20]||(e[20]=[l("a",{class:"btn-del ico-font",title:"删除"},"",-1)])),_:2,__:[20]},1032,["onConfirm"])]),l("div",Me,h(t.name)+" - 子相册",1)]))),128))])):m("",!0),g.value.length>0?(n(),c("ul",je,[(n(!0),c(L,null,z(g.value,(t,V)=>(n(),c("li",{class:$("gallery-video-item "+(_.value.some(v=>v.id===t.id)?"selected":""))},[l("div",null,[l("div",{class:"video-item-box",onClick:v=>se(t,V)},[l("div",Je,[i(a(C),{width:"600px",onOkCallback:v=>F(t.id,!1),title:"编辑视频",path:"gallery/video/VideoEdit",params:{act:"detail",id:t.id}},{default:d(()=>e[21]||(e[21]=[l("i",{class:"iconfont-admin icon-shipin"},null,-1)])),_:2,__:[21]},1032,["onOkCallback","params"])]),t.videoCover?(n(),N(Y,{key:0,fit:"cover",class:"gallery_pics",style:{width:"100%",height:"100%"},src:a(B)(t.videoCover)},null,8,["src"])):m("",!0),t.videoCover?m("",!0):(n(),c("video",{key:1,src:a(B)(t.videoUrl)},null,8,Ke))],8,De),l("div",Xe,[l("div",Ye,[l("p",qe,h(t.duration),1),l("div",Ae,[l("p",He,h(t.size),1),i(q,{title:"您确认要删掉该视频吗？",onConfirm:v=>te(t.id),placement:"bottom"},{default:d(()=>e[22]||(e[22]=[l("a",{class:"btn-del ico-font",title:"删除"},"",-1)])),_:2,__:[22]},1032,["onConfirm"])])])]),l("div",Qe,h(t.videoName),1),e[23]||(e[23]=l("div",{class:"img-selected-box"},[l("div",{class:"img-selected-box-angle"}),l("div",{class:"img-selected-box-sort ico-font"},"")],-1))])],2))),256))])):m("",!0),g.value.length==0&&G.value.length==0?(n(),c("div",We,[x.value?m("",!0):(n(),c("div",Ze,"暂无数据"))])):m("",!0)]),l("div",Pe,[i(a(_e),{page:a(o).page,"onUpdate:page":e[7]||(e[7]=t=>a(o).page=t),size:S.value,"onUpdate:size":e[8]||(e[8]=t=>S.value=t),total:D.value,onCallback:ee,layout:"slot ,prev, pager, next",background:!1},null,8,["page","size","total"])])]),_:1},8,["spinning"])])])])])}}}),ul=me(el,[["__scopeId","data-v-a809d200"]]);export{ul as default};
