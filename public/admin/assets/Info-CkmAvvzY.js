import{d as W,r as w,a as X,a2 as Y,o as Z,e as f,f as D,g as _,h as d,j as N,k,y as l,l as a,E as ee,K as u,F as le,m as ae,t as R,i as te,a4 as oe,I as ie,J as C,_ as ne}from"./index-BGgofOm4.js";import{a as re,c as pe}from"./shippingTpl-CjzzuDoI.js";import"./index-BdoKLCH8.js";import{u as se}from"./region-Dqu2emUz.js";import{_ as de}from"./DialogForm.vue_vue_type_script_setup_true_lang-BTf40oxg.js";import"./index-BS7Hjr9I.js";import"./region-BHgAbnXc.js";const ue={class:"container"},me={class:"content_wrapper"},fe={class:"lyecs-form-table"},ge={class:"shipping-method-style"},Te={class:"table-style"},_e={class:"title-style"},ce={class:"ysd"},be={style:{flex:"1"}},ve=W({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(B,{expose:E,emit:L}){se().getRegionList();const y=L,v=B,h=w(!0),q=X().currentRoute.value.query,I=w(v.isDialog?v.act:String(q.act)),S=w(v.isDialog?v.id:Number(q.id)),j=I.value==="add"?"create":"update",x=Y(),i=w({shippingTplInfo:[{isChecked:1,shippingTypeId:1,defaultTplInfo:{isDefault:1,startNumber:"",startPrice:"",addNumber:"",addPrice:"",freePrice:"",regionData:{areaRegions:[],areaRegionNames:[]},shippingTypeName:""},areaTplInfo:[]}],isDefault:0,isFree:0,pricingType:1}),V=(o,e,p)=>{e?e.length>0&&Number(e)<=0?p(new Error("需大于0")):p():p(new Error("请输入"))},c=(o,e,p)=>{e===""||e===null?p(new Error("请输入")):p()},O=async()=>{try{const o=await re(I.value,{id:S.value});o.shippingTplInfo.map((e,p)=>{e.isChecked=1,e.defaultTplInfo==null&&(e.defaultTplInfo=$(e.shippingTypeName,1),e.areaTplInfo=[],e.isChecked=0)}),Object.assign(i.value,o)}catch(o){C.error(o.message),y("close")}finally{h.value=!1}},z=o=>{for(let e=0;e<i.value.shippingTplInfo.length;e++);},A=(o,e)=>{i.value.shippingTplInfo&&i.value.shippingTplInfo[o].areaTplInfo&&i.value.shippingTplInfo[o].areaTplInfo.splice(e,1)},J=o=>{o.areaTplInfo.push($(o.shippingTypeName,0))},K=o=>{i.value.shippingTplInfo[o.index].areaTplInfo[o.itemIndex].regionData.areaRegionNames=o.regionNames,i.value.shippingTplInfo[o.index].areaTplInfo[o.itemIndex].regionData.areaRegions=o.regionIds},$=(o,e)=>({shippingTplId:0,shippingTypeId:1,isDefault:e,startNumber:"",startPrice:"",addNumber:"",addPrice:"",freePrice:"",regionData:{areaRegions:[],areaRegionNames:[]},shippingTypeName:o});Z(async()=>{I.value==="detail"?await O():h.value=!1});const F=async()=>{await x.value.validate();try{y("update:confirmLoading",!0);const o=await pe(j,{id:S.value,...i.value});y("submitCallback",o),C.success("操作成功")}catch(o){C.error(o.message)}finally{y("update:confirmLoading",!1)}};return E({onFormSubmit:()=>{F()}}),(o,e)=>{const p=f("TigInput"),s=f("el-form-item"),r=f("el-option"),M=f("el-select"),b=f("el-radio"),P=f("el-radio-group"),T=f("el-table-column"),U=f("el-button"),G=f("el-table"),H=f("el-form"),Q=f("a-spin");return _(),D("div",ue,[d("div",me,[d("div",fe,[h.value?k("",!0):(_(),N(H,{key:0,ref_key:"formRef",ref:x,model:i.value,"label-width":"auto"},{default:a(()=>[l(s,{rules:[{required:!0,message:"模板名称不能为空!"}],label:"模板名称",prop:"shippingTplName"},{default:a(()=>[l(p,{width:"100%",modelValue:i.value.shippingTplName,"onUpdate:modelValue":e[0]||(e[0]=n=>i.value.shippingTplName=n)},null,8,["modelValue"])]),_:1}),l(s,{label:"发货时间",prop:"shippingTime"},{default:a(()=>[l(M,{modelValue:i.value.shippingTime,"onUpdate:modelValue":e[1]||(e[1]=n=>i.value.shippingTime=n),placeholder:"请选择..",style:{width:"100%"}},{default:a(()=>[l(r,{label:"4小时内",value:"4小时内"}),l(r,{label:"8小时内",value:"8小时内"}),l(r,{label:"12小时内",value:"12小时内"}),l(r,{label:"16小时内",value:"16小时内"}),l(r,{label:"20小时内",value:"20小时内"}),l(r,{label:"1天内",value:"1天内"}),l(r,{label:"2天内",value:"2天内"}),l(r,{label:"3天内",value:"3天内"}),l(r,{label:"4天内",value:"4天内"}),l(r,{label:"5天内",value:"5天内"}),l(r,{label:"7天内",value:"7天内"}),l(r,{label:"8天内",value:"8天内"}),l(r,{label:"10天内",value:"10天内"}),l(r,{label:"12天内",value:"12天内"}),l(r,{label:"15天内",value:"15天内"}),l(r,{label:"17天内",value:"17天内"}),l(r,{label:"20天内",value:"20天内"}),l(r,{label:"25天内",value:"25天内"}),l(r,{label:"30天内",value:"30天内"}),l(r,{label:"45天内",value:"45天内"})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"是否默认",prop:"isDefault"},{default:a(()=>[l(P,{modelValue:i.value.isDefault,"onUpdate:modelValue":e[2]||(e[2]=n=>i.value.isDefault=n),style:{width:"100%"}},{default:a(()=>[l(b,{value:1},{default:a(()=>e[5]||(e[5]=[u("是",-1)])),_:1,__:[5]}),l(b,{value:0},{default:a(()=>e[6]||(e[6]=[u("否",-1)])),_:1,__:[6]})]),_:1},8,["modelValue"]),e[7]||(e[7]=d("div",{class:"extra"},"只能设置一个默认模板",-1))]),_:1,__:[7]}),l(s,{label:"是否包邮",prop:"isFree"},{default:a(()=>[l(P,{modelValue:i.value.isFree,"onUpdate:modelValue":e[3]||(e[3]=n=>i.value.isFree=n)},{default:a(()=>[l(b,{value:1},{default:a(()=>e[8]||(e[8]=[u("是",-1)])),_:1,__:[8]}),l(b,{value:0},{default:a(()=>e[9]||(e[9]=[u("否",-1)])),_:1,__:[9]})]),_:1},8,["modelValue"])]),_:1}),i.value.isFree==0?(_(),N(s,{key:0,label:"计价方式",prop:"pricingType"},{default:a(()=>[l(P,{modelValue:i.value.pricingType,"onUpdate:modelValue":e[4]||(e[4]=n=>i.value.pricingType=n),onChange:z},{default:a(()=>[l(b,{value:1,disabled:I.value!="add"},{default:a(()=>e[10]||(e[10]=[u("按件数",-1)])),_:1,__:[10]},8,["disabled"]),l(b,{value:2,disabled:I.value!="add"},{default:a(()=>e[11]||(e[11]=[u("按重量",-1)])),_:1,__:[11]},8,["disabled"])]),_:1},8,["modelValue"])]),_:1})):k("",!0),i.value.isFree==0?(_(),N(s,{key:1,label:"运送方式",prop:"shippingTplInfo",rules:[{required:!0,message:"运送方式不能为空!"}]},{default:a(()=>[(_(!0),D(le,null,ae(i.value.shippingTplInfo,(n,m)=>(_(),D("div",ge,[d("div",Te,[d("div",_e,[e[12]||(e[12]=d("span",{class:"title"},"默认运费",-1)),l(s,{prop:"shippingTplInfo["+m+"].defaultTplInfo.startNumber",rules:[{required:!0,validator:V}],class:"hn"},{default:a(()=>[l(p,{type:"integer",modelValue:n.defaultTplInfo.startNumber,"onUpdate:modelValue":t=>n.defaultTplInfo.startNumber=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),u("  "+R(i.value.pricingType==1?"件":"kg")+"内  ",1),l(s,{prop:"shippingTplInfo["+m+"].defaultTplInfo.startPrice",rules:[{required:!0,validator:c}],class:"hn"},{default:a(()=>[l(p,{type:"decimal",modelValue:n.defaultTplInfo.startPrice,"onUpdate:modelValue":t=>n.defaultTplInfo.startPrice=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),e[13]||(e[13]=u("  元，",-1)),e[14]||(e[14]=d("span",{class:"title"},"每增加",-1)),l(s,{prop:"shippingTplInfo["+m+"].defaultTplInfo.addNumber",rules:[{required:!0,validator:V}],class:"hn"},{default:a(()=>[l(p,{type:"integer",modelValue:n.defaultTplInfo.addNumber,"onUpdate:modelValue":t=>n.defaultTplInfo.addNumber=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),u("  "+R(i.value.pricingType==1?"件":"kg")+"，",1),e[15]||(e[15]=d("span",{class:"title"},"增加运费",-1)),l(s,{prop:"shippingTplInfo["+m+"].defaultTplInfo.addPrice",rules:[{required:!0,validator:c}],class:"hn"},{default:a(()=>[l(p,{type:"decimal",modelValue:n.defaultTplInfo.addPrice,"onUpdate:modelValue":t=>n.defaultTplInfo.addPrice=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),e[16]||(e[16]=u("  元，",-1)),e[17]||(e[17]=d("span",{class:"title"},"满",-1)),l(s,{prop:"shippingTplInfo["+m+"].defaultTplInfo.freePrice",rules:[{required:!0,validator:c}],class:"hn"},{default:a(()=>[l(p,{type:"decimal",modelValue:n.defaultTplInfo.freePrice,"onUpdate:modelValue":t=>n.defaultTplInfo.freePrice=t,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"]),e[18]||(e[18]=u("  元，",-1)),e[19]||(e[19]=d("span",{class:"title"},"免运费",-1))]),n.areaTplInfo.length>0?(_(),N(G,{key:0,data:n.areaTplInfo,style:{width:"100%","margin-top":"8px"}},{default:a(()=>[l(T,{label:"运送到",prop:"regionData"},{default:a(t=>[l(te(de),{params:{index:m,itemIndex:t.$index,ids:t.row.regionData.areaRegions,other:n.areaTplInfo},path:"setting/shippingTpl/SelectRegion",title:"编辑地区",width:"900px",style:{width:"100%"},onOkCallback:K},{default:a(()=>[d("div",ce,[d("div",be,[l(s,{prop:"shippingTplInfo."+m+".areaTplInfo["+t.$index+"].regionData.areaRegionNames",rules:[{required:!0,message:"未添加地区"}],class:"hn"},{default:a(()=>[d("span",{class:"shipping-region-list",style:oe(t.row.regionData.areaRegionNames.length>0?"":"color: red;")},R(t.row.regionData.areaRegionNames.length>0?t.row.regionData.areaRegionNames.join("、"):"请添加地区"),5)]),_:2},1032,["prop"])]),e[20]||(e[20]=d("div",null,[d("a",null,"编辑")],-1))])]),_:2},1032,["params"])]),_:2},1024),l(T,{label:i.value.pricingType==1?"首件数(件)":"首重量(kg)",width:"90"},{default:a(t=>[l(s,{prop:"shippingTplInfo."+m+".areaTplInfo["+t.$index+"].startNumber",rules:[{required:!0,validator:V}],class:"hn"},{default:a(()=>[l(p,{type:"integer",modelValue:t.row.startNumber,"onUpdate:modelValue":g=>t.row.startNumber=g,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1032,["label"]),l(T,{label:"首费(元)",width:"80"},{default:a(t=>[l(s,{prop:"shippingTplInfo."+m+".areaTplInfo["+t.$index+"].startPrice",rules:[{required:!0,validator:c}],class:"hn"},{default:a(()=>[l(p,{type:"decimal",modelValue:t.row.startPrice,"onUpdate:modelValue":g=>t.row.startPrice=g,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),l(T,{label:i.value.pricingType==1?"续件数(件)":"续重量(kg)",width:"90"},{default:a(t=>[l(s,{prop:"shippingTplInfo."+m+".areaTplInfo["+t.$index+"].addNumber",rules:[{required:!0,validator:V}],class:"hn"},{default:a(()=>[l(p,{type:"integer",modelValue:t.row.addNumber,"onUpdate:modelValue":g=>t.row.addNumber=g,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1032,["label"]),l(T,{label:"续费(元)",width:"80"},{default:a(t=>[l(s,{prop:"shippingTplInfo."+m+".areaTplInfo["+t.$index+"].addPrice",rules:[{required:!0,validator:c}],class:"hn"},{default:a(()=>[l(p,{type:"decimal",modelValue:t.row.addPrice,"onUpdate:modelValue":g=>t.row.addPrice=g,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),l(T,{label:"满免(元)",width:"80"},{default:a(t=>[l(s,{prop:"shippingTplInfo."+m+".areaTplInfo["+t.$index+"].freePrice",rules:[{required:!0,validator:c}],class:"hn"},{default:a(()=>[l(p,{type:"decimal",modelValue:t.row.freePrice,"onUpdate:modelValue":g=>t.row.freePrice=g,class:"input-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),l(T,{label:"操作",width:"60"},{default:a(t=>[l(U,{link:"",type:"primary",onClick:g=>A(m,t.$index)},{default:a(()=>e[21]||(e[21]=[u("删除",-1)])),_:2,__:[21]},1032,["onClick"])]),_:2},1024)]),_:2},1032,["data"])):k("",!0),l(U,{link:"",type:"primary",onClick:t=>J(n)},{default:a(()=>e[22]||(e[22]=[u("增加指定地区运费",-1)])),_:2,__:[22]},1032,["onClick"])])]))),256))]),_:1})):k("",!0),ee(l(s,{"wrapper-col":{offset:4,span:16}},{default:a(()=>[l(U,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:F},{default:a(()=>e[23]||(e[23]=[u("提交",-1)])),_:1,__:[23]},512)]),_:1},512),[[ie,!v.isDialog]])]),_:1},8,["model"])),l(Q,{spinning:h.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"])])])])}}}),De=ne(ve,[["__scopeId","data-v-f4a9ddb0"]]);export{De as default};
