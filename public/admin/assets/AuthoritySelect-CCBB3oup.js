import{d as $,r as U,c as F,o as G,e as S,f,g as r,F as V,y as h,h as m,k as j,l as u,m as w,t as A,j as C,K as D,i as J,dO as K,dP as P,J as ee,_ as te}from"./index-BGgofOm4.js";const le={class:"right-body"},ne={class:"title"},oe={class:"left-div"},de={class:"left-div"},se={style:{"font-weight":"500"}},ae={class:"right-div"},ie={class:"ml10"},re={style:{"font-weight":"500"}},ue={key:1},ce={key:0,class:"child-box flex"},he={class:"flex align-center"},me={style:{"font-weight":"500"}},fe={key:1},ye=$({__name:"AuthoritySelect",props:{modelValue:{type:Array,default:[]},adminType:{type:String,default:""}},emits:["update:modelValue"],setup(M,{emit:O}){const a=M,v=U(!0);U(!1);const q=F(()=>a.modelValue.includes("all")),z=F(()=>a.modelValue.length>0&&!a.modelValue.includes("all")),H=e=>{console.log(e),e===!1?k("update:modelValue",[]):k("update:modelValue",["all"])},N=()=>a.modelValue.includes("all")?Q(x.value):a.modelValue,Q=e=>{const n=[],t=o=>{o.forEach(l=>{var d,c;l.authoritySn&&n.push(l.authoritySn),(d=l.childAuth)!=null&&d.length&&l.childAuth.forEach(g=>{g.authSn&&n.push(g.authSn)}),(c=l.children)!=null&&c.length&&t(l.children)})};return t(e),n},_=e=>{var t;let n=[e.authoritySn];if(e.children&&e.children.length>0)e.children.forEach(o=>{var d;const l=((d=o.childAuth)==null?void 0:d.map(c=>c.authSn))||[];n.push(...l,..._(o))});else{const o=((t=e.childAuth)==null?void 0:t.map(l=>l.authSn))||[];n.push(...o)}return n},R=(e,n)=>{let t=[];t=N();const o=_(n);e===!1?t=t.filter(l=>!o.includes(l)):t=Array.from(new Set([...t,...o])),k("update:modelValue",t)},W=e=>a.modelValue.includes("all")?!0:_(e).every(t=>a.modelValue.includes(t)),X=e=>{const n=_(e);return!n.every(t=>a.modelValue.includes(t))&&n.some(t=>a.modelValue.includes(t))},b=(e,n,t,o)=>{let l=[];l=N();const d=_(n);e===!1?(l=l.filter(c=>!d.includes(c)),l.length<=2&&(l=l.filter(c=>!t.authoritySn.includes(c)),o&&(l=l.filter(c=>!o.authoritySn.includes(c))))):(l=Array.from(new Set([t.authoritySn,...l,...d])),o&&(l=Array.from(new Set([o.authoritySn,...l])))),k("update:modelValue",l)},B=e=>a.modelValue.includes("all")?!0:_(e).every(t=>a.modelValue.includes(t)),E=e=>{const n=_(e);return!n.every(t=>a.modelValue.includes(t))&&n.some(t=>a.modelValue.includes(t))},T=e=>!!(a.modelValue.includes("all")||a.modelValue.includes(e.authSn)),I=(e,n,t,o,l)=>{let d=[];d=N(),e===!1?d=d.filter(c=>c!==n.authSn):(d=Array.from(new Set([...d,n.authSn,t.authoritySn,o.authoritySn])),l&&(console.log(d),d=Array.from(new Set([...d,l.authoritySn])))),console.log(d),k("update:modelValue",d)},k=O,x=U([]),Y=async()=>{try{const e=await P({type:1,adminType:a.adminType});x.value=e}catch(e){ee.error(e.message)}finally{v.value=!1}};return G(()=>{Y().then(()=>{})}),(e,n)=>{const t=S("el-form"),o=S("el-checkbox"),l=S("a-spin"),d=S("el-icon"),c=S("el-dropdown-item"),g=S("el-dropdown-menu"),L=S("el-dropdown");return r(),f(V,null,[h(t,{"label-width":"auto"}),m("div",le,[m("div",ne,[m("div",oe,[h(o,{"model-value":q.value,"onUpdate:modelValue":H,indeterminate:z.value},{default:u(()=>n[0]||(n[0]=[m("span",{style:{"font-weight":"500"}},"全选",-1)])),_:1,__:[0]},8,["model-value","indeterminate"])]),n[1]||(n[1]=m("div",{class:"right-div"},"权限列表",-1))]),h(l,{spinning:v.value,style:{width:"100%","margin-top":"100px"}},null,8,["spinning"]),v.value?j("",!0):(r(!0),f(V,{key:0},w(x.value,y=>(r(),f("div",{key:y.authorityId,class:"info"},[m("div",de,[h(o,{"model-value":W(y),indeterminate:X(y),"onUpdate:modelValue":s=>R(s,y)},{default:u(()=>[m("span",se,A(y.authorityName),1)]),_:2},1032,["model-value","indeterminate","onUpdate:modelValue"])]),m("div",ae,[(r(!0),f(V,null,w(y.children,s=>(r(),f("div",{class:"child-div mb10",key:s.authorityId},[m("div",ie,[h(o,{indeterminate:E(s),"model-value":B(s),"onUpdate:modelValue":i=>b(i,s,y)},{default:u(()=>[s.childAuth&&s.childAuth.length>0?(r(),C(L,{key:0,"hide-on-click":!1},{dropdown:u(()=>[h(g,null,{default:u(()=>[(r(!0),f(V,null,w(s.childAuth,i=>(r(),C(c,{onClick:()=>{}},{default:u(()=>[h(o,{style:{width:"100%"},"model-value":T(i),"onUpdate:modelValue":p=>I(p,i,s,y)},{default:u(()=>[m("span",re,A(i.authName),1)]),_:2},1032,["model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:2},1024)]),default:u(()=>[m("span",null,[D(A(s.authorityName),1),h(d,{class:"el-icon--right"},{default:u(()=>[h(J(K))]),_:1})])]),_:2},1024)):(r(),f("span",ue,A(s.authorityName),1))]),_:2},1032,["indeterminate","model-value","onUpdate:modelValue"])]),s.children&&s.children.length>0?(r(),f("div",ce,[(r(!0),f(V,null,w(s.children,i=>(r(),f("div",{class:"child2-div",key:i.authorityId},[h(o,{indeterminate:E(i),"model-value":B(i),"onUpdate:modelValue":p=>b(p,i,s,y)},{default:u(()=>[i.childAuth&&i.childAuth.length>0?(r(),C(L,{key:0,"hide-on-click":!1},{dropdown:u(()=>[h(g,null,{default:u(()=>[(r(!0),f(V,null,w(i.childAuth,p=>(r(),C(c,{onClick:()=>{}},{default:u(()=>[h(o,{style:{width:"100%"},"model-value":T(p),"onUpdate:modelValue":Z=>I(Z,p,i,s,y)},{default:u(()=>[m("span",me,A(p.authName),1)]),_:2},1032,["model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:2},1024)]),default:u(()=>[m("div",he,[D(A(i.authorityName),1),h(d,{class:"el-icon--right"},{default:u(()=>[h(J(K))]),_:1})])]),_:2},1024)):(r(),f("span",fe,A(i.authorityName),1))]),_:2},1032,["indeterminate","model-value","onUpdate:modelValue"])]))),128))])):j("",!0)]))),128))])]))),128))])],64)}}}),pe=te(ye,[["__scopeId","data-v-1ff33f08"]]);export{pe as default};
