import{Z as T,d as j,s as N,e as I,f as a,g as i,h as s,k as l,y as k,K as B,t as L,n as F,F as M,m as w,i as $,_ as P,a as R,r as u,o as V,j as A,v as O,u as U,B as _,a1 as z,A as D}from"./index-BGgofOm4.js";import{u as K}from"./theme-B1rnHTnX.js";const he=()=>T({url:"common/cacheManage/cleanup",method:"post"}),fe=e=>T({url:"msg/adminMsg/msgCount",method:"get",params:e}),ye=e=>T({url:"common/tipsManage/list",method:"get",params:e}),ve=()=>T({url:"common/csrf/create",method:"get"}),q="/admin/assets/shop_logo_b-DK_MbwV3.png",E="/admin/assets/shop_logo-0stPotOH.png",H="/admin/assets/gys-0-MRmT23.png",Z={class:"select-shop-warp"},G={class:"warp-info"},J={class:"back-btn"},Q={key:0,class:"sub-title-name"},W={key:1,class:"shop-list"},X={class:"left-item"},Y={class:"left-info"},ee={class:"left-title"},te={key:0},se=["onClick"],oe={class:"left-item"},ne={class:"left-info"},ie={class:"left-title"},ae=["onClick"],le={class:"left-item"},ce={class:"left-info"},re={class:"left-title"},de={key:4,class:"shop-list shop-list-min-height"},ue=j({__name:"LoginSelectShop",props:{selectShopFlag:{type:Boolean,default:!1},myShopList:{type:Array,default:()=>[]},vendorList:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},userinfo:{type:Object,default:()=>{}},adminType:{type:String,default:""}},emits:["closePopup","update:selectShopFlag","callBack"],setup(e,{emit:C}){const m=C,c=async(n,t)=>{m("callBack",{id:n,type:t})},{logout:g}=N(),b=()=>{m("update:selectShopFlag",!1),g()},x=n=>/^1[3-9]\d{9}$/.test(n),p=n=>x(n)?n.slice(0,3)+"****"+n.slice(7):n;return(n,t)=>{var y,d,v;const h=I("a-spin"),r=I("el-image"),f=I("el-empty");return i(),a("div",Z,[s("div",G,[s("div",J,[s("div",{class:"bark",onClick:t[0]||(t[0]=o=>b())},t[2]||(t[2]=[s("i",{class:"iconfont-admin icon-zuojiantou-copy"},null,-1),B("返回",-1)]))]),t[9]||(t[9]=s("div",{class:"title-name"},[s("div",{class:"left-title"},"您可以进入以下管理后台")],-1)),e.userinfo&&((y=e.userinfo)!=null&&y.username)?(i(),a("div",Q,[s("span",null,L(p((d=e.userinfo)==null?void 0:d.username)),1),t[3]||(t[3]=B(" 已绑定了以下店铺，您可以进入以下任一店铺 ",-1))])):l("",!0),k(h,{spinning:e.loading,style:{width:"100%","margin-top":"100px",height:"200px"}},null,8,["spinning"]),!e.loading&&e.adminType==="admin"?(i(),a("div",W,[s("div",{onClick:t[1]||(t[1]=o=>c(0,"admin")),class:"shop-item",style:{"border-color":"#ffeac7","background-color":"#fff4e6",color:"#4e4e4e"}},[s("div",X,[t[5]||(t[5]=s("img",{class:"left-image",src:q,alt:""},null,-1)),s("div",Y,[s("div",ee,[t[4]||(t[4]=B(" 管理后台 ",-1)),e.userinfo&&e.userinfo.username&&e.userinfo.username!==""?(i(),a("span",te,"（"+L(p((v=e.userinfo)==null?void 0:v.username))+"）",1)):l("",!0)])])]),t[6]||(t[6]=s("div",{class:"right-item"},[s("span",{class:"iconfont-admin icon-login-youjiantou"})],-1))])])):l("",!0),e.myShopList.length>0?(i(),a("div",{key:2,class:F(["shop-list",{"shop-list-min-height":e.vendorList.length==0}])},[e.loading?l("",!0):(i(!0),a(M,{key:0},w(e.myShopList,o=>(i(),a("div",{onClick:S=>c(o.shopId,"shop"),class:"shop-item"},[s("div",oe,[k(r,{class:"left-image",src:$(E)},null,8,["src"]),s("div",ne,[s("div",ie,L(o.shopTitle),1)])]),t[7]||(t[7]=s("div",{class:"right-item"},[s("span",{class:"iconfont-admin icon-login-youjiantou"})],-1))],8,se))),256))],2)):l("",!0),e.vendorList.length>0?(i(),a("div",{key:3,class:F(["shop-list shop-list-min-height",{top:e.myShopList.length>0}])},[e.loading?l("",!0):(i(!0),a(M,{key:0},w(e.vendorList,o=>(i(),a("div",{onClick:S=>c(o.vendorId,"vendor"),class:"shop-item"},[s("div",le,[k(r,{class:"left-image",src:$(H)},null,8,["src"]),s("div",ce,[s("div",re,L(o.vendorName),1)])]),t[8]||(t[8]=s("div",{class:"right-item"},[s("span",{class:"iconfont-admin icon-login-youjiantou"})],-1))],8,ae))),256))],2)):l("",!0),!e.loading&&e.myShopList.length==0&&e.vendorList.length==0&&e.adminType!="admin"?(i(),a("div",de,[k(f,{description:"您还没有已绑定的店铺哦～"})])):l("",!0)])])}}}),me=P(ue,[["__scopeId","data-v-81701be0"]]),Se=j({__name:"SelectShop",props:{isIndex:{type:Boolean,default:!1},selectShopFlag:{type:Boolean,default:!1}},emits:["closePopup","update:selectShopFlag"],setup(e,{emit:C}){const m=e,c=C,g=R(),b=async r=>{localStorage.setItem("adminType",r.type);const f=N(),y=O(),d=U(),v=K();await Promise.all([f.updateUserInfo(),y.updateConfig()]),v.getThemeInfo(),_.success({message:"登录成功",placement:"top",duration:1.5,description:"您好，欢迎回来"}),d.clearMenus();const o=await z();if(d.setRouters(o||[]),m.isIndex){c("closePopup");const S=`${g.options.history.base}${o?o[0].path:"/"}`;window.history.pushState({path:S},"",S),setTimeout(()=>{location.reload()},200);return}localStorage.setItem("lastOpenTime",String(D().unix())),g.push(o?o[0].path:"/"),setTimeout(()=>{location.reload()},20)},x=u([]),p=u([]),n=u(!0),t=u({username:""}),h=u("");return V(()=>{localStorage.getItem("accessToken"),h.value=localStorage.getItem("adminType"),n.value=!1}),(r,f)=>e.isIndex?l("",!0):(i(),A(me,{key:0,selectShopFlag:e.selectShopFlag,myShopList:x.value,vendorList:p.value,loading:n.value,userinfo:t.value,adminType:h.value,onCallBack:b},null,8,["selectShopFlag","myShopList","vendorList","loading","userinfo","adminType"]))}});export{Se as _,ye as a,ve as b,he as c,fe as g};
