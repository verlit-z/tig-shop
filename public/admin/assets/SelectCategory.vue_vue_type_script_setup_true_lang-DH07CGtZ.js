import{u as k,c as N}from"./category-0ZzOrTFu.js";import{d as I,cf as x,cU as f,r as o,o as M,J as b,j as B,g as L,i as V,db as w}from"./index-BGgofOm4.js";const T=I({__name:"SelectCategory",props:x({multiple:{type:Boolean,default:!1},checkStrictly:{type:Boolean,default:!0},categoryList:{type:Array,default:()=>[]}},{categoryId:{},categoryIdModifiers:{},categoryName:{},categoryNameModifiers:{}}),emits:["update:categoryId","update:categoryName"],setup(s,{expose:p}){const l=s,t=f(s,"categoryId"),i=f(s,"categoryName"),m={label:"categoryName",value:"categoryId",children:"children",multiple:l.multiple,checkStrictly:l.checkStrictly},d=k(),n=o([]),g=o(!1),r=o(!1);o(!1),M(()=>{l.categoryList.length>1?n.value=l.categoryList:u()});const u=async a=>{if(r.value!==!0){g.value=!0;try{const e=await N(a);n.value=e,d.categoryTree=e}catch(e){b.error(e.message)}finally{g.value=!1,r.value=!0}}},y=o(),v=a=>{if(l.multiple==!0){const e=a.map(c=>c[c.length-1]);t.value=e}else{const e=y.value.getCheckedNodes();i.value=e[0]?e[0].text:"",t.value=a?a[a.length-1]:0}},h=a=>{a&&(r.value=!1,d.categoryTree=null,l.multiple==!0?t.value=[]:t.value="")},C=a=>{a&&u()},S=()=>{l.multiple==!0?t.value=[]:(t.value=0,i.value="")};return p({SelectShopChange:h,loadCategory:u,loaded:r}),(a,e)=>(L(),B(V(w),{style:{"max-width":"100%"},ref_key:"cascaderRef",ref:y,modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=c=>t.value=c),options:n.value,props:m,class:"cascader",clearable:"",placeholder:"选择分类",onChange:v,onClear:S,onVisibleChange:C},null,8,["modelValue","options"]))}});export{T as _};
