import{d as E,a2 as W,r as S,o as N,J as n,e as f,j as v,g as P,l as t,y as l,h as a,E as D,K as d,k as g,t as y,i as p,dJ as A,dK as w,I as L,a4 as R,_ as O}from"./index-BGgofOm4.js";/* empty css             */import"./index-BdoKLCH8.js";import{a as F,c as j,b as B}from"./payment-CQYNwNh8.js";import{c as z}from"./format-CpNC4fsQ.js";import{u as J}from"./theme-B1rnHTnX.js";import{_ as C}from"./DialogForm.vue_vue_type_script_setup_true_lang-BTf40oxg.js";import"./index-BS7Hjr9I.js";const $={class:"content"},q={class:"flex flex-align-center",style:{gap:"10px"}},G={class:"secret-txt line1",style:{"max-width":"380px"}},H={style:{width:"100%"}},Q={style:{width:"100%"}},X={style:{width:"100%"}},Y={style:{width:"100%"}},Z={class:"flex flex-align-center",style:{gap:"10px"}},ee={class:"secret-txt line1",style:{"max-width":"380px"}},ae={class:"flex flex-align-center",style:{gap:"10px"}},te={class:"secret-txt line1",style:{"max-width":"380px"}},le={class:"selected-action"},se=E({__name:"Wechat",setup(ie){const{themeInfo:I}=J(),V=W(),h=S(!1),s=S({useWechat:void 0,wechatMchidType:void 0,wechatPayMchid:"wechatPayMchid_46f1aec6bf75",wechatPaySubMchid:0,wechatPayKey:"wechatPayKey_de5a4632fe4a",wechatPaySerialNo:"wechatPaySerialNo_4a29ab342bc1",wechatPayCertificate:0,wechatPayPrivateKey:0,wechatPayCheckType:void 0,wechatPayPlatformCertificate:0,wechatPayPublicKeyId:0,wechatPayPublicKey:0,wechatMiniProgramAppId:"",wechatMiniProgramSecret:"",wechatPayAppId:"",wechatPayAppSecret:""});N(async()=>{k()});const _=S(!0),T=async()=>{try{const i=await j();n.success("操作成功"),k()}catch(i){n.error(i.message)}finally{_.value=!1}},k=async()=>{try{const i=await F();Object.assign(s.value,z(i))}catch(i){n.error(i.message)}finally{_.value=!1}},M=async()=>{h.value=!0;try{const i=await B({...s.value});n.success("修改成功")}catch(i){n.error(i.message)}finally{h.value=!1}},x=i=>{if(i.file.status=="uploading",i.file.status,i.file.status==="done")if(i.file.response.code!==0)i.file.status="error",n.error(i.file.response.data.message);else{for(let e in i.fileList)i.file.uid==i.fileList[e].uid&&(i.fileList[e]=Object.assign(i.fileList[e],i.fileList[e].response.data));n.success("文件上传成功！")}else i.file.status==="error"&&n.error(`${i.file.name} 文件上传失败！`)};return(i,e)=>{const m=f("el-radio"),b=f("el-radio-group"),r=f("el-form-item"),c=f("TigInput"),u=f("el-button"),K=f("el-form"),U=f("a-spin");return P(),v(U,{spinning:_.value},{default:t(()=>[l(K,{ref_key:"formRef",ref:V,model:s.value,"label-width":"160px"},{default:t(()=>[a("div",$,[e[41]||(e[41]=a("div",{class:"title"},"微信支付设置",-1)),l(r,{label:"是否开启",prop:"useWechat"},{default:t(()=>[l(b,{modelValue:s.value.useWechat,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value.useWechat=o),class:"itemWidth"},{default:t(()=>[l(m,{value:1},{default:t(()=>e[12]||(e[12]=[d("开启",-1)])),_:1,__:[12]}),l(m,{value:0},{default:t(()=>e[13]||(e[13]=[d("关闭",-1)])),_:1,__:[13]})]),_:1},8,["modelValue"]),e[14]||(e[14]=a("div",{class:"extra"},"是否开启微信支付，如关闭则不显示微信支付选项",-1))]),_:1,__:[14]}),D(a("div",null,[l(r,{label:"微信商户类型",prop:"wechatMchidType"},{default:t(()=>[l(b,{modelValue:s.value.wechatMchidType,"onUpdate:modelValue":e[1]||(e[1]=o=>s.value.wechatMchidType=o),class:"itemWidth"},{default:t(()=>[l(m,{value:1},{default:t(()=>e[15]||(e[15]=[d("普通商户模式",-1)])),_:1,__:[15]}),l(m,{value:2},{default:t(()=>e[16]||(e[16]=[d("服务商模式",-1)])),_:1,__:[16]})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"微信商户号",prop:"wechatPayMchid"},{default:t(()=>[l(c,{classType:"tig-form-input",modelValue:s.value.wechatPayMchid,"onUpdate:modelValue":e[2]||(e[2]=o=>s.value.wechatPayMchid=o)},null,8,["modelValue"])]),_:1}),s.value.wechatMchidType===2?(P(),v(r,{key:0,label:"微信子商户号",prop:"wechatPaySubMchid"},{default:t(()=>[a("div",null,[l(c,{classType:"tig-form-input",modelValue:s.value.wechatPaySubMchid,"onUpdate:modelValue":e[3]||(e[3]=o=>s.value.wechatPaySubMchid=o)},null,8,["modelValue"]),e[17]||(e[17]=a("div",{class:"extra"},"请填写由服务商提供的子商户号",-1))])]),_:1})):g("",!0),l(r,{label:"商户API密钥",prop:"wechatPayKey"},{default:t(()=>[a("div",null,[a("div",q,[a("div",G,y(s.value.wechatPayKey),1),l(p(C),{maskClose:!1,isDrawer:!1,params:{title:"商户API密钥",content:s.value.wechatPayKey},path:"setting/config/src/EditSecret",title:"商户API密钥",width:"600px",onOkCallback:e[4]||(e[4]=o=>s.value.wechatPayKey=o)},{default:t(()=>[l(u,{style:{"margin-top":"3px"},link:"",type:"primary"},{default:t(()=>e[18]||(e[18]=[d(" 编辑 ",-1)])),_:1,__:[18]})]),_:1},8,["params"])]),e[19]||(e[19]=a("div",{class:"extra"},"请使用APIv3密钥，编辑完成后，点击下方提交按钮确认修改，请确保填写正确的商户API密钥",-1))])]),_:1}),s.value.wechatPayCheckType===1?(P(),v(r,{key:1,label:"商户证书序列号",prop:"wechatPaySerialNo"},{default:t(()=>[a("div",null,[l(c,{classType:"tig-form-input",modelValue:s.value.wechatPaySerialNo,"onUpdate:modelValue":e[5]||(e[5]=o=>s.value.wechatPaySerialNo=o)},null,8,["modelValue"]),e[20]||(e[20]=a("div",{class:"extra"},"请使用API证书序列号",-1))])]),_:1})):g("",!0),l(r,{label:"商户API证书",prop:"wechatPayCertificate"},{default:t(()=>[a("div",H,[l(p(A),{name:"file",action:p(w).prefix+"/setting/config/uploadFile?type=1",headers:p(w).headers(),onChange:x,showUploadList:!1,multiple:!1},{default:t(()=>[l(u,null,{default:t(()=>[d(y(s.value.wechatPayCertificate?"重新上传":"点击上传"),1)]),_:1}),e[21]||(e[21]=a("span",{class:"ml10"},"apiclient_cert.pem",-1))]),_:1,__:[21]},8,["action","headers"])]),e[22]||(e[22]=a("div",{class:"extra"},"调用微信商户接口时需要用到的API证书，文件名称一般为apiclient_cert.pem，具体操作请参考教程",-1))]),_:1,__:[22]}),l(r,{label:"商户API证书密钥",prop:"wechatPayPrivateKey"},{default:t(()=>[a("div",Q,[l(p(A),{name:"file",action:p(w).prefix+"/setting/config/uploadFile?type=2",headers:p(w).headers(),onChange:x,showUploadList:!1,multiple:!1},{default:t(()=>[l(u,null,{default:t(()=>[d(y(s.value.wechatPayPrivateKey?"重新上传":"点击上传"),1)]),_:1}),e[23]||(e[23]=a("span",{class:"ml10"},"apiclient_key.pem",-1))]),_:1,__:[23]},8,["action","headers"])]),e[24]||(e[24]=a("div",{class:"extra"},"调用微信商户接口时需要用到的API证书密钥，文件名称一般为apiclient_key.pem，具体操作请参考教程",-1))]),_:1,__:[24]}),l(r,{label:"验证微信支付方式",prop:"wechatMchidType"},{default:t(()=>[l(b,{modelValue:s.value.wechatPayCheckType,"onUpdate:modelValue":e[6]||(e[6]=o=>s.value.wechatPayCheckType=o),class:"itemWidth"},{default:t(()=>[l(m,{value:1},{default:t(()=>e[25]||(e[25]=[d("平台证书",-1)])),_:1,__:[25]}),l(m,{value:2},{default:t(()=>e[26]||(e[26]=[d("微信支付公钥",-1)])),_:1,__:[26]})]),_:1},8,["modelValue"])]),_:1}),s.value.wechatPayCheckType===1?(P(),v(r,{key:2,label:"平台证书",prop:""},{default:t(()=>[a("div",X,[l(u,{loading:h.value,class:"form-submit-btn",type:"success",onClick:T},{default:t(()=>[d(y(s.value.wechatPayPlatformCertificate?"更新证书":"生成证书"),1)]),_:1},8,["loading"])]),e[27]||(e[27]=a("div",{class:"extra"},"调用微信商户接口时需要用到的平台证书,上传API证书后需要更新平台证书，具体操作请参考教程",-1))]),_:1,__:[27]})):g("",!0),s.value.wechatPayCheckType===2?(P(),v(r,{key:3,label:"微信支付公钥ID",prop:"wechatPayPublicKeyId"},{default:t(()=>[a("div",null,[l(c,{classType:"tig-form-input",modelValue:s.value.wechatPayPublicKeyId,"onUpdate:modelValue":e[7]||(e[7]=o=>s.value.wechatPayPublicKeyId=o)},null,8,["modelValue"]),e[28]||(e[28]=a("div",{class:"extra"},"请使用微信支付公钥ID",-1))])]),_:1})):g("",!0),s.value.wechatPayCheckType===2?(P(),v(r,{key:4,label:"微信支付公钥文件",prop:"wechatPayPublicKey"},{default:t(()=>[a("div",Y,[l(p(A),{name:"file",action:p(w).prefix+"/setting/config/uploadFile?type=3",headers:p(w).headers(),onChange:x,showUploadList:!1,multiple:!1},{default:t(()=>[l(u,null,{default:t(()=>[d(y(s.value.wechatPayPublicKey?"重新上传":"点击上传"),1)]),_:1}),e[29]||(e[29]=a("span",{class:"ml10"},"微信支付公钥文件（如：pub_key.pem）",-1))]),_:1,__:[29]},8,["action","headers"])]),e[30]||(e[30]=a("div",{class:"extra"},"调用微信商户接口时需要用到的公钥证书，文件名称一般为public.pem，具体操作请参考教程",-1))]),_:1,__:[30]})):g("",!0),e[39]||(e[39]=a("div",{class:"title"},"微信小程序支付",-1)),l(r,{label:"微信小程序AppID",prop:"wechatMiniProgramAppId"},{default:t(()=>[a("div",null,[l(c,{classType:"tig-form-input",modelValue:s.value.wechatMiniProgramAppId,"onUpdate:modelValue":e[8]||(e[8]=o=>s.value.wechatMiniProgramAppId=o)},null,8,["modelValue"]),e[31]||(e[31]=a("div",{class:"extra"},"微信小程序公众平台->设置->开发设置中获取，开通小程序必填",-1))])]),_:1}),l(r,{label:"微信小程序AppSecret",prop:"wechatMiniProgramSecret"},{default:t(()=>[a("div",null,[a("div",Z,[a("div",ee,y(s.value.wechatMiniProgramSecret),1),l(p(C),{maskClose:!1,isDrawer:!1,params:{title:"微信小程序AppSecret",content:s.value.wechatMiniProgramSecret},path:"setting/config/src/EditSecret",title:"微信小程序AppSecret",width:"600px",onOkCallback:e[9]||(e[9]=o=>s.value.wechatMiniProgramSecret=o)},{default:t(()=>[l(u,{style:{"margin-top":"3px"},link:"",type:"primary"},{default:t(()=>e[32]||(e[32]=[d(" 编辑 ",-1)])),_:1,__:[32]})]),_:1},8,["params"])]),e[33]||(e[33]=a("div",{class:"extra"},"微信小程序公众平台->设置->开发设置中获取，开通小程序必填",-1)),e[34]||(e[34]=a("div",{class:"extra"},"编辑完成后，点击下方提交按钮确认修改，请确保填写正确的微信小程序AppSecret",-1))])]),_:1}),e[40]||(e[40]=a("div",{class:"title"},"微信APP支付",-1)),l(r,{label:"应用APP ID",prop:"wechatPayAppId"},{default:t(()=>[a("div",null,[l(c,{classType:"tig-form-input",modelValue:s.value.wechatPayAppId,"onUpdate:modelValue":e[10]||(e[10]=o=>s.value.wechatPayAppId=o)},null,8,["modelValue"]),e[35]||(e[35]=a("div",{class:"extra"},"需开通微信开发者平台，创建APP应用（未开通Tigshop APP商城可忽略）",-1))])]),_:1}),l(r,{label:"应用APP SECRET",prop:"wechatPayAppSecret"},{default:t(()=>[a("div",null,[a("div",ae,[a("div",te,y(s.value.wechatPayAppSecret),1),l(p(C),{maskClose:!1,isDrawer:!1,params:{title:"应用APP SECRET",content:s.value.wechatPayAppSecret},path:"setting/config/src/EditSecret",title:"应用APP SECRET",width:"600px",onOkCallback:e[11]||(e[11]=o=>s.value.wechatPayAppSecret=o)},{default:t(()=>[l(u,{style:{"margin-top":"3px"},link:"",type:"primary"},{default:t(()=>e[36]||(e[36]=[d(" 编辑 ",-1)])),_:1,__:[36]})]),_:1},8,["params"])]),e[37]||(e[37]=a("div",{class:"extra"},"需通微信开发者平台获取（未开通Tigshop APP商城可忽略）",-1)),e[38]||(e[38]=a("div",{class:"extra"},"编辑完成后，点击下方提交按钮确认修改，请确保填写正确的应用APP SECRET",-1))])]),_:1})],512),[[L,s.value.useWechat===1]])])]),_:1},8,["model"]),e[43]||(e[43]=a("div",{style:{height:"20px"}},null,-1)),a("div",{class:"selected-action-warp selected-warp-left",style:R({left:p(I).layout!=="topMenu"?"369px":"270px"})},[a("div",le,[l(u,{loading:h.value,class:"form-submit-btn",size:"large",type:"primary",onClick:M},{default:t(()=>e[42]||(e[42]=[d("提 交",-1)])),_:1,__:[42]},8,["loading"])])],4)]),_:1,__:[43]},8,["spinning"])}}}),me=O(se,[["__scopeId","data-v-d449b5af"]]);export{me as default};
