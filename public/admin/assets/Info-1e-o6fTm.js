import{d as D,r as m,a as O,a2 as q,o as E,J as f,e as n,f as I,g as S,h as N,j as U,k as L,l as a,y as o,E as j,K as _,I as F}from"./index-BGgofOm4.js";import{a as J,c as K}from"./rechargeSetting-ffV4Ng0f.js";const z={class:"container"},A={class:"content_wrapper"},G={class:"lyecs-form-table"},W=D({__name:"Info",props:{id:{type:Number,default:0},act:{type:String,default:""},isDialog:Boolean},emits:["submitCallback","update:confirmLoading","close"],setup(R,{expose:k,emit:C}){const d=C,u=R,c=m(!0),g=O().currentRoute.value.query,p=m(u.isDialog?u.act:String(g.act)),y=m(u.isDialog?u.id:Number(g.id)),h=p.value==="add"?"create":"update",v=q(),t=m({discountMoney:"",money:"",sortOrder:1,isShow:1});E(()=>{p.value==="detail"?B():c.value=!1});const B=async()=>{try{const l=await J(p.value,{id:y.value});Object.assign(t.value,l)}catch(l){f.error(l.message),d("close")}finally{c.value=!1}},b=(l,e,r)=>{if(console.log(e),Number(e)===0||e===""){r(new Error("金额不能为0或者为空！"));return}else if(Number(e)<0){r(new Error("金额必须大于0！"));return}else r()},w=async()=>{await v.value.validate();try{d("update:confirmLoading",!0);const l=await K(h,{id:y.value,...t.value});d("submitCallback",l),f.success("操作成功")}catch(l){f.error(l.message)}finally{d("update:confirmLoading",!1)}};return k({onFormSubmit:()=>{w()}}),(l,e)=>{const r=n("TigInput"),i=n("el-form-item"),V=n("el-radio"),M=n("el-radio-group"),T=n("el-button"),x=n("el-form");return S(),I("div",z,[N("div",A,[N("div",G,[c.value?L("",!0):(S(),U(x,{key:0,ref_key:"formRef",ref:v,model:t.value,"label-width":"auto"},{default:a(()=>[o(i,{prop:"money",label:"充值金额",rules:[{required:!0,validator:b,trigger:"blur"}]},{default:a(()=>[o(r,{classType:"tig-form-input",type:"decimal",modelValue:t.value.money,"onUpdate:modelValue":e[0]||(e[0]=s=>t.value.money=s),min:0},null,8,["modelValue"])]),_:1},8,["rules"]),o(i,{prop:"discountMoney",label:"赠送金额",rules:[{required:!0,validator:b,trigger:"blur"}]},{default:a(()=>[o(r,{classType:"tig-form-input",type:"decimal",modelValue:t.value.discountMoney,"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.discountMoney=s),min:0},null,8,["modelValue"])]),_:1},8,["rules"]),o(i,{prop:"sortOrder",label:"排序"},{default:a(()=>[o(r,{classType:"tig-form-input",type:"integer",modelValue:t.value.sortOrder,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.sortOrder=s)},null,8,["modelValue"])]),_:1}),o(i,{prop:"isShow",label:"是否显示"},{default:a(()=>[o(M,{modelValue:t.value.isShow,"onUpdate:modelValue":e[3]||(e[3]=s=>t.value.isShow=s)},{default:a(()=>[o(V,{value:1},{default:a(()=>e[4]||(e[4]=[_("是",-1)])),_:1,__:[4]}),o(V,{value:0},{default:a(()=>e[5]||(e[5]=[_("否",-1)])),_:1,__:[5]})]),_:1},8,["modelValue"])]),_:1}),j(o(i,{"wrapper-col":{offset:4,span:16}},{default:a(()=>[o(T,{ref:"submitBtn",class:"form-submit-btn",type:"primary",onClick:w},{default:a(()=>e[6]||(e[6]=[_("提交",-1)])),_:1,__:[6]},512)]),_:1},512),[[F,!u.isDialog]])]),_:1},8,["model"]))])])])}}});export{W as default};
