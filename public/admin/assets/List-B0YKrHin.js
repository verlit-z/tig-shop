import{d as W,v as B,r as D,e as p,f as v,g as c,h as n,y as s,l as o,K as I,i as a,a0 as L,k as u,t as N,j as _,J as f,_ as $}from"./index-BGgofOm4.js";/* empty css             */import"./index-BdoKLCH8.js";import{_ as k}from"./Switch.vue_vue_type_script_setup_true_lang-BQY033uH.js";/* empty css                                                                    */import{P as j}from"./Pagination-Nz0PhK3s.js";import{u as g,m as E,w as J,g as R}from"./messageType-9danloUX.js";import{P as G}from"./PopSelect.vue_vue_type_style_index_0_scoped_5832cf6b_lang-DhDNvZWl.js";import{u as H}from"./useListRequest-DIT8yyoo.js";import{_ as Q}from"./DialogForm.vue_vue_type_script_setup_true_lang-BTf40oxg.js";import{M as S}from"./index-BS7Hjr9I.js";const X={class:"container"},Y={class:"content_wrapper"},Z={class:"lyecs-form-table"},ee={class:"table-action"},ae={class:"table-container"},te={class:"empty-warp"},se={key:0,class:"empty-bg"},ne={key:0,class:"pagination-con"},oe=W({__name:"List",setup(le){const V=B(),{listData:q,loading:y,total:b,filterParams:d,loadData:m,onSearchSubmit:h,onSortChange:P,onSelectChange:T}=H({apiFunction:R,idKey:"messageId",defaultParams:{sortField:"",sortOrder:"",keyword:"",sendType:1,page:1,size:V.get("pageSize")}});m();const M=D(1),A=i=>{d.sendType=i,m()},x=async()=>{S.confirm({title:"您确认要生成小程序消息模板吗？",onOk:async()=>{try{const i=await E();f.success("操作成功"),m()}catch(i){f.error(i.message)}finally{}}})},z=async()=>{S.confirm({title:"您确认要生成公众号模板消息吗？",onOk:async()=>{try{const i=await J();f.success("操作成功"),m()}catch(i){f.error(i.message)}finally{}}})};return(i,t)=>{const U=p("el-tab-pane"),C=p("el-button"),w=p("TigInput"),K=p("el-tabs"),r=p("el-table-column"),F=p("el-table"),O=p("a-spin");return c(),v("div",X,[n("div",Y,[n("div",Z,[t[10]||(t[10]=n("div",{class:"notice-warp"},[n("strong",null," 模板行业选择"),n("p",null,"主营行业：根据您的主营行业选择适合的服务类目"),n("p",null,"副营行业：商业服务 -> 软件/建站/技术开发"),n("strong",null," 生成小程序消息模板"),n("p",null,"请先添加服务类目《商业服务->软件/建站/技术开发》，否则模板导入不成功，点击会自动删除原有的小程序模板并生成新的模板！"),n("strong",null," 生成公众号模板消息"),n("p",null,"请先添加服务类目《商业服务->软件/建站/技术开发》，否则模板导入不成功，点击会自动删除原有的公众号模板并生成新的模板！")],-1)),s(K,{modelValue:M.value,"onUpdate:modelValue":t[3]||(t[3]=e=>M.value=e),class:"lyecs-tabs","tab-position":"top",onTabChange:A},{default:o(()=>[s(U,{label:"发送给用户",name:1}),s(U,{label:"发送给商家",name:2}),n("div",ee,[s(C,{type:"primary",onClick:t[0]||(t[0]=e=>x())},{default:o(()=>t[6]||(t[6]=[I("生成小程序消息模板",-1)])),_:1,__:[6]}),s(C,{type:"warning",onClick:t[1]||(t[1]=e=>z())},{default:o(()=>t[7]||(t[7]=[I("生成公众号模板消息",-1)])),_:1,__:[7]}),s(w,{modelValue:a(d).keyword,"onUpdate:modelValue":t[2]||(t[2]=e=>a(d).keyword=e),placeholder:"输入关键字",onKeyup:L(a(h),["enter"]),clearable:"",onClear:a(h)},{append:o(()=>[s(C,{onClick:a(h)},{default:o(()=>t[8]||(t[8]=[n("span",{class:"iconfont icon-chakan1"},null,-1)])),_:1,__:[8]},8,["onClick"])]),_:1},8,["modelValue","onKeyup","onClear"])])]),_:1},8,["modelValue"]),n("div",ae,[s(O,{spinning:a(y)},{default:o(()=>[s(F,{data:a(q),loading:a(y),total:a(b),"row-key":"messageId",onSelectionChange:a(T),onSortChange:a(P)},{empty:o(()=>[n("div",te,[a(y)?u("",!0):(c(),v("div",se,"暂无数据"))])]),default:o(()=>[s(r,{label:"消息类型",prop:"name"},{default:o(({row:e})=>[s(a(G),{"org-value":e.name,"onUpdate:orgValue":l=>e.name=l,params:{id:e.messageId,field:"name"},requestApi:a(g),label:"消息类型",type:"input"},{default:o(()=>[n("div",null,N(e.name),1)]),_:2},1032,["org-value","onUpdate:orgValue","params","requestApi"])]),_:1}),s(r,{label:"消息描述",prop:"describe"}),s(r,{label:"站内信",width:"100"},{default:o(({row:e})=>[e.isMessage>-1?(c(),_(a(k),{key:0,checked:e.isMessage,"onUpdate:checked":l=>e.isMessage=l,params:{id:e.messageId,field:"isMessage"},requestApi:a(g)},null,8,["checked","onUpdate:checked","params","requestApi"])):u("",!0)]),_:1}),s(r,{label:"短信",width:"100"},{default:o(({row:e})=>[e.isMsg>-1?(c(),_(a(k),{key:0,checked:e.isMsg,"onUpdate:checked":l=>e.isMsg=l,params:{id:e.messageId,field:"isMsg"},requestApi:a(g)},null,8,["checked","onUpdate:checked","params","requestApi"])):u("",!0)]),_:1}),s(r,{label:"公众号",width:"100"},{default:o(({row:e})=>[e.isWechat>-1?(c(),_(a(k),{key:0,checked:e.isWechat,"onUpdate:checked":l=>e.isWechat=l,params:{id:e.messageId,field:"isWechat"},requestApi:a(g)},null,8,["checked","onUpdate:checked","params","requestApi"])):u("",!0)]),_:1}),s(r,{label:"小程序",width:"100"},{default:o(({row:e})=>[e.isMiniProgram>-1?(c(),_(a(k),{key:0,checked:e.isMiniProgram,"onUpdate:checked":l=>e.isMiniProgram=l,params:{id:e.messageId,field:"isMiniProgram"},requestApi:a(g)},null,8,["checked","onUpdate:checked","params","requestApi"])):u("",!0)]),_:1}),s(r,{width:100,fixed:"right",label:"操作"},{default:o(({row:e})=>[s(a(Q),{params:{act:"detail",id:e.messageId},isDrawer:"",path:"setting/config/messageType/Info",title:"编辑消息设置",width:"700px",onOkCallback:a(m)},{default:o(()=>t[9]||(t[9]=[n("a",{class:"btn-link"},"编辑",-1)])),_:2,__:[9]},1032,["params","onOkCallback"])]),_:1})]),_:1},8,["data","loading","total","onSelectionChange","onSortChange"])]),_:1},8,["spinning"]),a(b)>0?(c(),v("div",ne,[s(a(j),{page:a(d).page,"onUpdate:page":t[4]||(t[4]=e=>a(d).page=e),size:a(d).size,"onUpdate:size":t[5]||(t[5]=e=>a(d).size=e),total:a(b),onCallback:a(m)},null,8,["page","size","total","onCallback"])])):u("",!0)])])])])}}}),ye=$(oe,[["__scopeId","data-v-ef4de29d"]]);export{ye as default};
