import{E as e}from"./7KO-WwAc.js";import{_ as l}from"./C5Pr72SQ.js";import{a,E as o}from"./CSNhwhPs.js";import{E as s}from"./BYBCH-HF.js";import{e as i,cA as r,aA as t,f as d,z as u,r as m,I as n,h as p,c as v,o as c,i as b,b as g,j as f,a as y,F as w,m as E,x as T,t as j,w as _,n as V,aF as C,dy as k,d as A,dz as $,dA as h,cB as q,_ as x}from"./BoLQ9Xhu.js";import{_ as M}from"./1aEO9UvO.js";import{M as U}from"./esaz3ZoR.js";import"./DCawybvr.js";import"./7ACzQoE5.js";import"./Cy_EVX_n.js";import"./DEVzVrts.js";import"./k79prmI0.js";import"./C_oH9tmG.js";import"./BmDvg8bE.js";import"./nqCHxoJt.js";import"./DSXY0Md2.js";import"./D5wp6cRH.js";const S={key:0,class:"register-menu"},F={class:"menu-box"},O=["onClick"],z={class:"label"},R={class:"area-code-input"},Z={key:0,class:"area-code-select"},I={class:"label"},P={class:"label"},W=x(i({__name:"StepOne",props:{step:{},stepModifiers:{}},emits:r(["success"],["update:step"]),setup(i,{emit:r}){const x=t(i,"step"),W=r,B=d(),{t:Y}=u(),D=m(!1),G=m("86"),H=n(),J=(e,l,a)=>{ee.value.tigTips[e]=l?{type:"valid",message:a}:{type:"error",message:a}},K=[{label:Y("手机号找回"),value:""},{label:Y("邮箱找回"),value:"email"}],L=e=>{ee.value.tigTips[e]={type:"info",message:N[e]}},N=p({mobile:Y("请填写手机号码"),email:Y("请填写邮箱地址"),code:Y("请输入验证码"),password:Y("6-20个大小写英文字母、符号或数字的组合")}),Q=p({mobile:[{validator:(e,l,a)=>{const o=B.isOpenMobileAreaCode?/^(\+?[1-9]\d{1,14})$/:/^(?:\+?86)?1[3-9]\d{9}$/;return l?o.test(l)?void a():a(new Error(Y("格式错误，请输入正确的手机号码"))):a(new Error(Y("手机号不能为空")))},trigger:"blur",required:!0}],email:[{validator:(e,l,a)=>l?/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(l)?void a():a(new Error(Y("格式错误，请输入正确的邮箱地址"))):a(new Error(Y("邮箱不能为空"))),trigger:"blur",required:!0}],code:[{validator:(e,l,a)=>l?6!=l.length?a(new Error(Y("请输入6位验证码"))):void a():a(new Error(Y("验证码不能为空"))),trigger:"blur",required:!0}],password:[{validator:(e,l,a)=>l?l.length>20||l.length<6?a(new Error(Y("密码应为6-20位字符"))):/\s/.test(l)?a(new Error(Y("密码中不允许有空格"))):/^\d+$/.test(l)?a(new Error(Y("密码不能全为数字"))):/^(?=.*[\d\W]).+$/.test(l)?/^(?=.*[a-zA-Z0-9]).+$/.test(l)?/^(?!([a-zA-Z0-9])\1*$).+$/.test(l)?void a():a(new Error(Y("密码不能全为相同字符或数字"))):a(new Error(Y("密码不能全为符号"))):a(new Error(Y("密码不能全为字母"))):a(new Error(Y("密码不能为空"))),trigger:"blur",required:!0}]}),X=m(!1),ee=m({tigTips:{},mobile:"",registType:"",code:""}),le=async()=>{await H.value.validate();try{let e;if(X.value=!0,"email"===ee.value.registType){const l={email:ee.value.email,code:ee.value.code};e=await $(l)}else{const l={mobile:B.isOpenMobileAreaCode?G.value+ee.value.mobile:ee.value.mobile,code:ee.value.code};e=await h(l)}W("success",e),x.value=2}catch(e){q.error(e.message||Y("操作失败")),ee.value.code="",ee.value.tigTips={}}finally{X.value=!1}},ae=e=>{q.error(e)};return(i,r)=>{const t=e,d=l,u=o,m=s,n=a;return c(),v("div",null,[1===f(B).openEmailRegister?(c(),v("div",S,[y("div",F,[(c(),v(w,null,E(K,(e,l)=>y("div",{key:l,class:T(["menu-item",{active:ee.value.registType===e.value}]),onClick:l=>{return a=e.value,ee.value.registType=a,ee.value.tigTips={},void("email"===a?(ee.value.mobile="",ee.value.code="",ee.value.tigTips.mobile={type:"info",message:N.mobile}):(ee.value.email="",ee.value.code="",ee.value.tigTips.email={type:"info",message:N.email}));var a}},j(e.label),11,O)),64))])])):b("",!0),g(n,{ref_key:"formRef",ref:H,"hide-required-asterisk":!0,model:ee.value,rules:f(Q),"show-message":!1,class:"form-body","label-width":"auto",onValidate:J},{default:_(()=>["mobile"!==ee.value.registType&&ee.value.registType?(c(),V(u,{key:1,prop:"email"},{default:_(()=>[y("div",I,j(i.$t("邮箱")),1),g(t,{modelValue:ee.value.email,"onUpdate:modelValue":r[3]||(r[3]=e=>ee.value.email=e),class:"input-border-style",onFocus:r[4]||(r[4]=e=>L("email"))},null,8,["modelValue"]),g(d,{info:ee.value.tigTips.email},null,8,["info"])]),_:1})):(c(),V(u,{key:0,prop:"mobile"},{default:_(()=>[y("div",z,j(i.$t("手机号")),1),y("div",R,[g(t,{modelValue:ee.value.mobile,"onUpdate:modelValue":r[1]||(r[1]=e=>ee.value.mobile=e),class:"input-border-style",onFocus:r[2]||(r[2]=e=>L("mobile"))},{prefix:_(()=>[f(B).isOpenMobileAreaCode?(c(),v("div",Z,[g(M,{modelValue:G.value,"onUpdate:modelValue":r[0]||(r[0]=e=>G.value=e)},null,8,["modelValue"])])):b("",!0)]),_:1},8,["modelValue"])]),g(d,{info:ee.value.tigTips.mobile},null,8,["info"])]),_:1})),g(u,{prop:"code"},{default:_(()=>[y("div",P,j(i.$t("验证码")),1),"mobile"!==ee.value.registType&&ee.value.registType?(c(),V(t,{key:1,modelValue:ee.value.code,"onUpdate:modelValue":r[9]||(r[9]=e=>ee.value.code=e),class:"input-border-style",onFocus:r[10]||(r[10]=e=>L("code"))},{suffix:_(()=>[g(f(U),{event:"forgetPassword",class:"mobile-code-text",email:ee.value.email,mobileCodeSended:D.value,"onUpdate:mobileCodeSended":r[8]||(r[8]=e=>D.value=e),requestApi:f(k),onMobileErrorCallback:ae},null,8,["email","mobileCodeSended","requestApi"])]),_:1},8,["modelValue"])):(c(),V(t,{key:0,modelValue:ee.value.code,"onUpdate:modelValue":r[6]||(r[6]=e=>ee.value.code=e),class:"input-border-style",onFocus:r[7]||(r[7]=e=>L("code"))},{suffix:_(()=>[g(f(U),{class:"mobile-code-text",event:"forgetPassword",mobile:f(B).isOpenMobileAreaCode?G.value+ee.value.mobile:ee.value.mobile,mobileCodeSended:D.value,"onUpdate:mobileCodeSended":r[5]||(r[5]=e=>D.value=e),requestApi:f(C),onMobileErrorCallback:ae},null,8,["mobile","mobileCodeSended","requestApi"])]),_:1},8,["modelValue"])),g(d,{info:ee.value.tigTips.code},null,8,["info"])]),_:1}),g(u,{label:"",prop:"firstWord"},{default:_(()=>[g(m,{loading:X.value,type:"primary",class:"submit-button",style:{width:"330px"},onClick:le},{default:_(()=>[A(j(i.$t("下 一 步")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])}}}),[["__scopeId","data-v-33ef094b"]]);export{W as default};
