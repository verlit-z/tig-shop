import{e,cA as a,aw as l,z as t,r as s,aA as u,c as i,o as r,F as o,b as p,x as c,j as d,ay as m,av as v,w as n,Z as f,a7 as h,a as y,E as b,cB as g,k as _,_ as T}from"./BoLQ9Xhu.js";import{E as U}from"./DFr8_2Ck.js";import{E as j}from"./mHIovD83.js";import"./DwsKuIG7.js";const $={class:"image"},I=T(e({__name:"UploadImage",props:a({limit:{type:Number,default:1},fileTypes:{type:Array,default:[]}},{uploadList:{default:[]},uploadListModifiers:{}}),emits:["update:uploadList"],setup(e){const a=l(),{t:T}=t(),I=s(),L=e,E=e=>{if(w.value.length>=L.limit)return g.error(T("已经达到上传数量限制")),!1;const a=e.type.replace(/.*\//,"");return L.fileTypes.includes(a)?!(e.size/1024/1024>2)||(g.error(T("只能上传2M以内的图片")),!1):(g.error(`${T("无法上传")} ${a} ${T("文件!")}${T("只能上传")} ${L.fileTypes.join(", ")} ${T("文件!")}`),!1)},k=u(e,"uploadList"),w=s([]);null!=k.value?k.value.length>0&&(k.value.forEach(e=>{e.url=_(e.picUrl)}),w.value=k.value):k.value=[];const x=s(""),A=s(!1),F=(e,a)=>{e&&k.value?k.value=k.value.filter(a=>a.picThumb!==e.picThumb):k.value=[]},N=(e=[],a)=>{1===L.limit&&w.value.length>0&&(w.value.pop(),k.value.pop(),I.value.clearFiles(),I.value.handleStart(e[0]),I.value.submit())},V=e=>{x.value=e.url,A.value=!0},z=(e,a)=>{try{k.value.push({picThumb:e.data.picThumb,picUrl:e.data.picUrl,picId:e.data.picId,picName:e.data.picName})}catch(l){}};return(l,t)=>{const s=f,u=U,g=b,_=j;return r(),i(o,null,[p(u,{ref_key:"upload",ref:I,"file-list":w.value,"onUpdate:fileList":t[0]||(t[0]=e=>w.value=e),action:d(m)+"/user/user/uploadImg",headers:d(a),"before-upload":E,"on-exceed":N,"on-preview":V,"on-remove":F,"on-success":z,limit:e.limit,multiple:e.limit>1,"list-type":"picture-card",class:c({"hide-upload-button":1==e.limit&&w.value.length>0})},v({_:2},[0===w.value.length?{name:"trigger",fn:n(()=>[p(s,null,{default:n(()=>[p(d(h))]),_:1})]),key:"0"}:void 0]),1032,["file-list","action","headers","limit","multiple","class"]),p(_,{modelValue:A.value,"onUpdate:modelValue":t[1]||(t[1]=e=>A.value=e)},{default:n(()=>[y("div",$,[p(g,{src:x.value,alt:"",fit:"cover"},null,8,["src"])])]),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-e6bcd535"]]);export{I as U};
