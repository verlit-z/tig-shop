import{_ as s}from"./BDziKWme.js";import{_ as a}from"./Dkgx1KFS.js";import{_ as t}from"./CACs9nxh.js";import{e,G as o,r,z as i,y as l,p as c,ah as n,T as m,c as d,o as p,b as u,a as v,t as y,j as f,d as j,i as h,E as w,_ as g}from"./BoLQ9Xhu.js";import{_ as $}from"./DFo55n29.js";import{E as k}from"./C-LthTfX.js";import"./BYBCH-HF.js";import"./7KO-WwAc.js";import"./DwsKuIG7.js";import{Q as _}from"./NdJU2u_O.js";import{w as b,z as C}from"./DzqBkdd6.js";import{y as I}from"./B83oXF5V.js";import{e as S,f as x,d as V}from"./DlHfSwhz.js";import{s as z}from"./DSXY0Md2.js";import"./oOeuh3JC.js";import"./CUjxzVkc.js";import"./MzbMzCCn.js";import"./C4BNlK69.js";import"./DEVzVrts.js";import"./nqCHxoJt.js";import"./Cy_EVX_n.js";import"./k79prmI0.js";import"./C_oH9tmG.js";import"./D5wp6cRH.js";const L={class:"wechat-com"},U={class:"wechat container"},q={class:"message"},B={class:"message"},E={class:"payment"},P={key:0,class:"title"},Q={key:1,class:"title"},T={class:"image-div"},D={class:"left-image"},G={key:0,class:"ewm"},M={key:1,class:"ewm-empty"},O={class:"pw-box-ft"},R={key:0},W={key:1},X={key:2},Y={class:"right-image"},Z={key:0,class:"image"},A={key:1,class:"image"},F={key:2,class:"image"},H=g(e({__name:"yunpay",setup(e){const g=o(),H=r(g.query.id),J=r(g.query.type),K=r(!0);r({});const N=r(""),ss=r({orderSn:"",amount:0}),{t:as}=i();(async()=>{try{const s=await x({orderId:H.value});ss.value=s.order}catch(s){c.error(s.message),n("/member/account/detail")}})();const ts=r(0);let es=null;l(()=>{(async()=>{K.value=!0;try{const s=await V({id:H.value,type:"yunpay_"+J.value});rs(s?.payInfo.codeUrl)}catch(s){c.error(s.message)}finally{K.value=!1}})(),es=z(()=>{os(),ts.value++,50===ts.value&&(clearInterval(es),c.error(as("支付已超时，您可以刷新页面重新支付")))},2e3)});const os=()=>{S({id:H.value}).then(s=>{1==s&&(clearInterval(es),k.confirm(as("订单支付成功"),as("提示"),{confirmButtonText:as("查看订单"),showClose:!1,showCancelButton:!1,closeOnClickModal:!1,type:"success"}).then(()=>{n("/member/account/detail")}).catch(()=>{}))})},rs=async s=>{const a=s;N.value=await _.toDataURL(a,{margin:1,width:500,height:500})},is=()=>{window.close()},ls=()=>{window.location.reload()};return m(()=>{clearInterval(es)}),(e,o)=>{const r=s,i=a,l=t,c=w,n=$;return p(),d("div",null,[u(r,{title:"YunPay"}),u(i,{showLogin:!1}),v("div",L,[v("div",U,[v("div",q,y(e.$t("订单提交成功，请尽快付款"))+"！"+y(e.$t("订单号"))+"："+y(f(ss).orderSn),1),v("div",B,[j(y(e.$t("应付金额"))+"： ",1),u(l,{modelValue:f(ss).amount,"onUpdate:modelValue":o[0]||(o[0]=s=>f(ss).amount=s),fontStyle:{color:"var(--price)",fontSize:"18px"}},null,8,["modelValue"])]),v("div",E,["wechat"==f(J)?(p(),d("div",P,y(e.$t("微信支付")),1)):h("",!0),"alipay"==f(J)?(p(),d("div",Q,y(e.$t("支付宝支付")),1)):h("",!0),v("div",T,[v("div",D,[v("div",null,[j(y(e.$t("如果二维码已过期"))+"，"+y(e.$t("请")),1),v("span",{onClick:ls,class:"font-color",style:{cursor:"pointer"}},y(e.$t("刷新")),1),j(y(e.$t("页面重新获取二维码"))+"。 ",1)]),f(ts)<=50?(p(),d("div",G,[u(c,{class:"image",src:f(N)},null,8,["src"])])):(p(),d("div",M,[j(y(e.$t("已超时"))+"，",1),v("a",{class:"font-color",onClick:ls},y(e.$t("点击刷新")),1)])),v("div",O,["wechat"==f(J)?(p(),d("div",R,y(e.$t("请使用微信扫一扫")),1)):h("",!0),"alipay"==f(J)?(p(),d("div",W,y(e.$t("请使用支付宝扫一扫")),1)):h("",!0),"yunshanfu"==f(J)?(p(),d("div",X,y(e.$t("请使用云闪付扫一扫")),1)):h("",!0),v("div",null,y(e.$t("扫描二维码支付")),1)])]),v("div",Y,["wechat"==f(J)?(p(),d("div",Z,[u(c,{src:f(b)},null,8,["src"])])):h("",!0),"alipay"==f(J)?(p(),d("div",A,[u(c,{src:f(C)},null,8,["src"])])):h("",!0),"yunshanfu"==f(J)?(p(),d("div",F,[u(c,{src:f(I)},null,8,["src"])])):h("",!0)])]),v("div",{onClick:is,class:"button-title"},"< "+y(e.$t("选择其他支付方式")),1)])])]),u(n,{bg:"white",mt30:!1,type:1})])}}}),[["__scopeId","data-v-882674ff"]]);export{H as default};
