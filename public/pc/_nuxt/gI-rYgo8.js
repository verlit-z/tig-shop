import{E as e}from"./7KO-WwAc.js";import{a,E as l}from"./CSNhwhPs.js";import{E as o}from"./BYBCH-HF.js";import{e as t,f as s,ai as d,r,h as i,z as n,y as u,p as m,c,o as p,n as f,i as g,a as b,w as v,b as y,j as h,d as _,t as k,_ as w,v as V,F as C,q as $,x,a6 as j,bi as S}from"./BoLQ9Xhu.js";import{S as I}from"./DIKWJnCq.js";import{E as O}from"./mHIovD83.js";import"./DwsKuIG7.js";import{g as E,u as q}from"./DOca54Ap.js";/* empty css        */const B={class:"modal_region_box"},U={class:"address_from"},F={class:"from_item"},L={class:"btn_box"},D=w(t({__name:"EditRegion",props:{id:Number,act:{type:String,default:"add"},isDialog:Boolean,addressId:{type:Number,default:0},showClose:{type:Boolean,default:!0}},emits:["submitCallback","update:confirmLoading","close","change"],setup(t,{expose:w,emit:V}){const C=s(),$=V,x=t,j=d().currentRoute.value.query,S=r(x.isDialog?x.act:String(j.act)),O=r("add"===S.value?"create":"update");r(!1);const D=i({consignee:"",regionIds:[],address:"",mobile:"",telephone:"",email:""}),{t:z}=n(),A=r(!0);u(()=>{x.addressId>0?R():A.value=!1});const R=async()=>{try{const e=await E(S.value,{id:x.addressId});Object.assign(D,e)}catch(e){m.error(e.message)}finally{A.value=!1}},Z=i({mobile:[{validator:(e,a,l)=>{const o=C.isOpenMobileAreaCode?/^(\+?[1-9]\d{1,14})$/:/^(?:\+86)?1(?:3[0-9]|4[5-9]|5[0-35-9]|6[5-7]|7[0-8]|8[0-9]|9[189])\d{8}$/;return a?o.test(a)?void l():l(new Error(z("格式错误，请输入正确的手机号码"))):l(new Error(z("手机号不能为空")))},trigger:"blur",required:!0}],email:[{validator:(e,a,l)=>{if(a&&!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(a))return l(new Error(z("格式错误，请输入正确的邮箱地址")));l()},trigger:"blur",required:!0}]}),N=r(null),T=async()=>{await N.value.validate();try{$("update:confirmLoading",!0);const e=await q(O.value,{id:x.addressId,...D});setTimeout(()=>{m.success(z("操作成功"))},100),$("submitCallback",e)}catch(e){m.error(e.message)}finally{$("update:confirmLoading",!1)}},H=()=>{N.value.validateField("regionIds")},M=()=>{$("close")};return w({onFormSubmit:()=>{T()}}),(t,s)=>{const d=e,r=l,i=a,n=o;return p(),c("div",B,[A.value?g("",!0):(p(),f(i,{key:0,"label-width":"auto","inline-message":!1,ref_key:"formRef",ref:N,rules:Z,model:D,autocomplete:"off","label-suffix":"："},{default:v(()=>[y(r,{label:t.$t("收货人"),prop:"consignee",rules:[{required:!0,message:t.$t("请您填写收货人姓名")}]},{default:v(()=>[y(d,{modelValue:D.consignee,"onUpdate:modelValue":s[0]||(s[0]=e=>D.consignee=e),maxlength:20},null,8,["modelValue"])]),_:1},8,["label","rules"]),y(r,{label:t.$t("所在地区"),prop:"regionIds",rules:[{required:!0,message:t.$t("请选择收货人所在地区")}],autoLink:""},{default:v(()=>[y(h(I),{modelValue:D.regionIds,"onUpdate:modelValue":s[1]||(s[1]=e=>D.regionIds=e),onChange:H},null,8,["modelValue"])]),_:1},8,["label","rules"]),y(r,{label:t.$t("详细地址"),prop:"address",rules:[{required:!0,message:t.$t("请您填写详细收货地址")},{min:3,message:t.$t("收货人地址过短")}]},{default:v(()=>[y(d,{modelValue:D.address,"onUpdate:modelValue":s[2]||(s[2]=e=>D.address=e),maxlength:100},null,8,["modelValue"])]),_:1},8,["label","rules"]),y(r,{label:t.$t("手机号码"),prop:"mobile"},{default:v(()=>[y(d,{modelValue:D.mobile,"onUpdate:modelValue":s[3]||(s[3]=e=>D.mobile=e),maxlength:20},null,8,["modelValue"])]),_:1},8,["label"]),y(r,{label:t.$t("固定电话"),prop:"telephone",rules:[],"wrapper-col":{span:8},extra:""},{default:v(()=>[y(d,{modelValue:D.telephone,"onUpdate:modelValue":s[4]||(s[4]=e=>D.telephone=e),maxlength:20},null,8,["modelValue"])]),_:1},8,["label"]),y(r,{required:!1,label:t.$t("邮箱地址"),prop:"email",rules:[],"wrapper-col":{span:8}},{default:v(()=>[y(d,{modelValue:D.email,"onUpdate:modelValue":s[5]||(s[5]=e=>D.email=e),maxlength:50},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["rules","model"])),b("div",U,[b("div",F,[s[6]||(s[6]=b("div",{class:"tit"},null,-1)),b("div",L,[y(n,{type:"primary",onClick:T},{default:v(()=>[_(k("add"===S.value?t.$t("新增"):t.$t("修改"))+k(t.$t("地址")),1)]),_:1}),x.showClose?(p(),f(n,{key:0,onClick:M},{default:v(()=>[_(k(t.$t("取消")),1)]),_:1})):g("",!0)])])])])}}}),[["__scopeId","data-v-9a5a66d5"]]),z=w(t({__name:"DialogEditRegion",props:{path:String,class:{type:String,default:""},dialogClass:{type:String,default:""},params:{type:Object,default:{}},width:{type:String,default:"800px"},title:{type:String,default:""},isDrawer:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},showOnOk:{type:Boolean,default:!0},showFooter:{type:Boolean,default:!0},data:{type:Object,default:{}},style:{type:[String,Object],default:"display:inline-flex;"},maskClosable:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},type:String},emits:["okCallback","callback"],setup(e,{expose:a,emit:l}){const o=e,t=l,s=r(!1),d=r(!1),i=r(!1),n=r(!1),u=r(o.dialogClass),m=r(o.title),h=r({});!1===o.showFooter&&(h.value.footer="");const _=V(()=>Object.assign(o.params,{isDialog:!0}));function k(){i.value=!1,s.value=!0,d.value=!0}function w(e){d.value=!1}V(()=>"gallery"==o.type?"811px":o.width);const I=r(),E=e=>{d.value=!1,i.value=!1,t("okCallback",e,o.data)},q=e=>{t("callback",e,o.data)},B=()=>{I.value.onFormSubmit()},U=e=>{n.value=!e};return a({show:k,close:w}),(a,l)=>{const t=D,r=O;return p(),c(C,null,[b("div",{onClick:k,class:x("dialog-link "+o.class),style:$(o.style)},[j(a.$slots,"default",{},void 0,!0)],6),s.value?(p(),f(r,S({key:0,class:u.value,modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=e=>d.value=e),width:e.width,title:m.value,destroyOnClose:!0,onOk:B},h.value,{"close-on-click-modal":e.maskClosable,"show-close":e.closable,centered:""}),{default:v(()=>[y(t,S({ref_key:"submitForm",ref:I,onSubmitCallback:E,onCallback:q,onShow:k,onClose:w,onOkType:U},_.value,{confirmLoading:i.value,"onUpdate:confirmLoading":l[0]||(l[0]=e=>i.value=e)}),null,16,["confirmLoading"])]),_:1},16,["class","modelValue","width","title","close-on-click-modal","show-close"])):g("",!0)],64)}}}),[["__scopeId","data-v-ad57d92d"]]);export{z as _};
