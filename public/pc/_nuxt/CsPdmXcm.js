import{E as e}from"./CqjQ_mIo.js";import{_ as o}from"./CACs9nxh.js";import{_ as l}from"./CUjxzVkc.js";import{v as s}from"./D3Ou390f.js";import{e as a,cA as n,aA as u,r as c,h as d,c2 as i,c as t,o as p,a as v,i as m,b as r,w as y,t as b,ad as f,F as k,m as h,x as C,d as g,_ as I}from"./BoLQ9Xhu.js";import"./Cy_EVX_n.js";import"./DEVzVrts.js";import"./k79prmI0.js";import"./nqCHxoJt.js";const V={class:"from"},$={class:"check-box"},_={class:"tit"},M={key:0,class:"from_list"},U={class:"coupon-box"},j={key:0,class:"coupon_list"},L=["onClick"],x={class:"item-selected-cancel"},N={key:0,class:"priceNum"},T={key:0,class:"coupon-globle"},D={key:1,class:"zk"},G={key:0,class:"coupon-globle"},R={class:"time"},z={class:"detail"},w={key:2,class:"coupon-notice"},A={key:3,class:"coupon-notice"},B={class:"item-selected-cancel"},E={key:0,class:"priceNum"},F={key:0,class:"coupon-globle"},P={key:1,class:"zk"},q={key:0,class:"coupon-globle"},H={class:"time"},J={class:"detail"},K={key:2,class:"coupon-notice"},O={key:3,class:"coupon-notice"},Q={key:1,class:"no-cou"},S=I(a({__name:"CouponInfo",props:{useCoupon:{type:Boolean},useCouponModifiers:{},couponList:{},couponListModifiers:{},couponLoading:{},couponLoadingModifiers:{},selectedIds:{},selectedIdsModifiers:{},selectedUserCouponIds:{},selectedUserCouponIdsModifiers:{}},emits:n(["change"],["update:useCoupon","update:couponList","update:couponLoading","update:selectedIds","update:selectedUserCouponIds"]),setup(a,{emit:n}){const I=n,S=u(a,"useCoupon"),W=u(a,"couponList"),X=u(a,"couponLoading"),Y=c(0);d(["商品优惠券","优惠码兑换"]);const Z=()=>{!1===S.value?(ee.value=[],oe.value=[],I("change")):I("change",!0)},ee=u(a,"selectedIds"),oe=u(a,"selectedUserCouponIds"),le=c([]);i(()=>{W.value&&W.value.enableCoupons&&(le.value=W.value.enableCoupons.filter(e=>e.selected))});const se=e=>{const o=Number(e.userCouponId);if(l=o,oe.value&&oe.value.includes(l))le.value=le.value.filter(e=>e.userCouponId!==o);else{if(le.value.findIndex(o=>o.shopId===e.shopId)>-1)le.value=le.value.filter(o=>o.shopId!==e.shopId);else{le.value.findIndex(o=>o.id===e.id)>-1&&(le.value=le.value.filter(o=>o.id!==e.id))}le.value.push(e)}var l;ee.value=le.value.map(({id:e})=>Number(e)),oe.value=le.value.map(({userCouponId:e})=>Number(e)),I("change")};return(a,n)=>{const u=e,c=o,d=l,i=s;return p(),t("div",null,[v("div",V,[v("div",$,[r(u,{modelValue:S.value,"onUpdate:modelValue":n[0]||(n[0]=e=>S.value=e),onChange:Z},{default:y(()=>[v("div",_,b(a.$t("使用优惠券")),1)]),_:1},8,["modelValue"])])]),S.value?(p(),t("div",M,[n[10]||(n[10]=v("div",{class:"arrow"},null,-1)),v("div",U,[m("",!0),f((p(),t("div",null,[0==Y.value?(p(),t("div",j,[W.value&&(W.value?.enableCoupons.length>0||W.value?.disableCoupons.length>0)?(p(),t(k,{key:0},[W.value?.enableCoupons.length>0?(p(!0),t(k,{key:0},h(W.value.enableCoupons,(e,o)=>(p(),t("div",{class:C(["coupon_item hand-pointer",{active:e.selected}]),type:"checkbox",onClick:o=>se(e)},[n[3]||(n[3]=v("div",{class:"c-top-dong"},null,-1)),v("div",x,b(a.$t("取消勾选")),1),1==e.couponType?(p(),t("div",N,[r(c,{modelValue:e.couponMoney,"onUpdate:modelValue":o=>e.couponMoney=o},null,8,["modelValue","onUpdate:modelValue"]),e.isGlobal?(p(),t("span",T,"["+b(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),2==e.couponType?(p(),t("div",D,[g(b(e.couponDiscount)+" ",1),v("span",null,b(a.$t("折")),1),e.isGlobal?(p(),t("span",G,"["+b(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),v("div",R,b(a.$t("有效期至"))+b(e.endDate),1),v("div",z,b(e.couponName),1),n[4]||(n[4]=v("i",{class:"icon-gou"},null,-1)),e.disableReason?(p(),t("div",w,[n[1]||(n[1]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),g(b(e.disableReason),1)])):m("",!0),e.selected&&1==e.couponType?(p(),t("div",A,[n[2]||(n[2]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),g(" "+b(a.$t("已减")),1),r(c,{modelValue:e.couponMoney,"onUpdate:modelValue":o=>e.couponMoney=o},null,8,["modelValue","onUpdate:modelValue"])])):m("",!0)],10,L))),256)):m("",!0),W.value&&W.value?.disableCoupons.length>0?(p(!0),t(k,{key:1},h(W.value.disableCoupons,e=>(p(),t("div",{class:C(["coupon_item hand-pointer disabled",{active:e.selected}]),type:"checkbox"},[n[7]||(n[7]=v("div",{class:"c-top-dong"},null,-1)),v("div",B,b(a.$t("取消勾选")),1),1==e.couponType?(p(),t("div",E,[r(c,{modelValue:e.couponMoney,"onUpdate:modelValue":o=>e.couponMoney=o},null,8,["modelValue","onUpdate:modelValue"]),e.isGlobal?(p(),t("span",F,"["+b(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),2==e.couponType?(p(),t("div",P,[g(b(e.couponDiscount)+" ",1),v("span",null,b(a.$t("折")),1),e.isGlobal?(p(),t("span",q,"["+b(a.$t("全场券"))+"]",1)):m("",!0)])):m("",!0),v("div",H,b(a.$t("有效期至"))+b(e.endDate),1),v("div",J,b(e.couponName),1),n[8]||(n[8]=v("i",{class:"icon-gou"},null,-1)),e.disableReason?(p(),t("div",K,[n[5]||(n[5]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),g(b(e.disableReason),1)])):m("",!0),e.selected&&2==e.couponType?(p(),t("div",O,[n[6]||(n[6]=v("i",{class:"iconfont-pc icon-tishi"},null,-1)),g(" "+b(a.$t("已减")),1),r(c,{modelValue:e.couponMoney,"onUpdate:modelValue":o=>e.couponMoney=o},null,8,["modelValue","onUpdate:modelValue"])])):m("",!0)],2))),256)):m("",!0)],64)):(p(),t("div",Q,[g(b(a.$t("暂无可用优惠券"))+"～",1),r(d,{target:"_blank",class:"font-color",to:"/coupon/list"},{default:y(()=>[g(b(a.$t("去领券")),1)]),_:1})]))])):m("",!0)])),[[i,X.value]]),m("",!0)])])):m("",!0)])}}}),[["__scopeId","data-v-41e492e6"]]);export{S as default};
