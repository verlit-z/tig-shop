import{b as e,e as l,f as a}from"./Cy_EVX_n.js";import{cM as t,bB as r,a3 as i,bA as s,M as o,O as n,bK as u,r as d,v,P as c,e as p,h as f,R as m,H as g,a9 as h,bR as b,c as y,o as S,a6 as w,x as F,j,bz as I,Q as W,y as q,T as M,Y as P,S as $,b as B,F as O,V as k,aa as x,cN as A,c3 as E,cO as V,a as L,w as R,n as _,i as z,aP as C,q as N,d as T,t as Q,cP as G,cQ as H,ag as K,af as Y}from"./BoLQ9Xhu.js";import{c as D}from"./BmDvg8bE.js";import{d as J,t as U}from"./k79prmI0.js";import{a as X}from"./DEVzVrts.js";function Z(e){return t(e,4)}const ee=o({size:{type:String,values:u},disabled:Boolean}),le=o({...ee,model:Object,rules:{type:n(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:n([Object,Boolean]),default:!0}}),ae={validate:(e,l,a)=>(r(e)||i(e))&&s(l)&&i(a)};function te(){const e=d([]),l=v(()=>{if(!e.value.length)return"0";const l=Math.max(...e.value);return l?`${l}px`:""});function a(a){const t=e.value.indexOf(a);return-1===t&&l.value,t}return{autoLabelWidth:l,registerLabelWidth:function(l,t){if(l&&t){const r=a(t);e.value.splice(r,1,l)}else l&&e.value.push(l)},deregisterLabelWidth:function(l){const t=a(l);t>-1&&e.value.splice(t,1)}}}const re=(e,l)=>{const a=D(l).map(e=>r(e)?e.join("."):e);return a.length>0?e.filter(e=>e.propString&&a.includes(e.propString)):e},ie=p({name:"ElForm"});var se=c(p({...ie,props:le,emits:ae,setup(a,{expose:t,emit:r}){const i=a,s=d(),o=f([]),n=e(),u=m("form"),c=v(()=>{const{labelPosition:e,inline:l}=i;return[u.b(),u.m(n.value||"default"),{[u.m(`label-${e}`)]:e,[u.m("inline")]:l}]}),p=e=>re(o,[e])[0],W=(e=[])=>{i.model&&re(o,e).forEach(e=>e.resetField())},q=(e=[])=>{re(o,e).forEach(e=>e.clearValidate())},M=v(()=>!!i.model),P=async e=>B(void 0,e),$=async(e=[])=>{if(!M.value)return!1;const l=(e=>{if(0===o.length)return[];const l=re(o,e);return l.length?l:[]})(e);if(0===l.length)return!0;let a={};for(const r of l)try{await r.validate(""),"error"!==r.validateState||r.error||r.resetField()}catch(t){a={...a,...t}}return 0===Object.keys(a).length||Promise.reject(a)},B=async(e=[],l)=>{let a=!1;const t=!I(l);try{return a=await $(e),!0===a&&await(null==l?void 0:l(a)),a}catch(r){if(r instanceof Error)throw r;const e=r;if(i.scrollToError&&s.value){const e=s.value.querySelector(`.${u.b()}-item.is-error`);null==e||e.scrollIntoView(i.scrollIntoViewOptions)}return!a&&await(null==l?void 0:l(!1,e)),t&&Promise.reject(e)}};return g(()=>i.rules,()=>{i.validateOnRuleChange&&P().catch(e=>J())},{deep:!0,flush:"post"}),h(l,f({...b(i),emit:r,resetFields:W,clearValidate:q,validateField:B,getField:p,addField:e=>{o.push(e)},removeField:e=>{e.prop&&o.splice(o.indexOf(e),1)},...te()})),t({validate:P,validateField:B,resetFields:W,clearValidate:q,scrollToField:e=>{var l;const a=p(e);a&&(null==(l=a.$el)||l.scrollIntoView(i.scrollIntoViewOptions))},getField:p,fields:o}),(e,l)=>(S(),y("form",{ref_key:"formRef",ref:s,class:F(j(c))},[w(e.$slots,"default")],2))}}),[["__file","form.vue"]]);const oe=o({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:n([String,Array])},required:{type:Boolean,default:void 0},rules:{type:n([Object,Array])},error:String,validateStatus:{type:String,values:["","error","validating","success"]},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:u}}),ne="ElLabelWrap";var ue=p({name:ne,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const r=W(l,void 0),i=W(a);i||U(ne,"usage: <el-form-item><label-wrap /></el-form-item>");const s=m("form"),o=d(),n=d(0),u=(l="update")=>{k(()=>{t.default&&e.isAutoWidth&&("update"===l?n.value=(()=>{var e;if(null==(e=o.value)?void 0:e.firstElementChild){const e=window.getComputedStyle(o.value.firstElementChild).width;return Math.ceil(Number.parseFloat(e))}return 0})():"remove"===l&&(null==r||r.deregisterLabelWidth(n.value)))})},c=()=>u("update");return q(()=>{c()}),M(()=>{u("remove")}),P(()=>c()),g(n,(l,a)=>{e.updateAll&&(null==r||r.registerLabelWidth(l,a))}),$(v(()=>{var e,l;return null!=(l=null==(e=o.value)?void 0:e.firstElementChild)?l:null}),c),()=>{var l,a;if(!t)return null;const{isAutoWidth:u}=e;if(u){const e=null==r?void 0:r.autoLabelWidth,a={};if((null==i?void 0:i.hasLabel)&&e&&"auto"!==e){const l=Math.max(0,Number.parseInt(e,10)-n.value),t=i.labelPosition||r.labelPosition;l&&(a["left"===t?"marginRight":"marginLeft"]=`${l}px`)}return B("div",{ref:o,class:[s.be("item","label-wrap")],style:a},[null==(l=t.default)?void 0:l.call(t)])}return B(O,{ref:o},[null==(a=t.default)?void 0:a.call(t)])}}});const de=p({name:"ElFormItem"});var ve=c(p({...de,props:oe,setup(t,{expose:i}){const o=t,n=x(),u=W(l,void 0),c=W(a,void 0),p=e(void 0,{formItem:!1}),P=m("form-item"),$=X().value,O=d([]),K=d(""),Y=A(K,100),J=d(""),U=d();let ee,le=!1;const ae=v(()=>o.labelPosition||(null==u?void 0:u.labelPosition)),te=v(()=>{if("top"===ae.value)return{};const e=E(o.labelWidth||(null==u?void 0:u.labelWidth)||"");return e?{width:e}:{}}),re=v(()=>{if("top"===ae.value||(null==u?void 0:u.inline))return{};if(!o.label&&!o.labelWidth&&pe)return{};const e=E(o.labelWidth||(null==u?void 0:u.labelWidth)||"");return o.label||n.label?{}:{marginLeft:e}}),ie=v(()=>[P.b(),P.m(p.value),P.is("error","error"===K.value),P.is("validating","validating"===K.value),P.is("success","success"===K.value),P.is("required",he.value||o.required),P.is("no-asterisk",null==u?void 0:u.hideRequiredAsterisk),"right"===(null==u?void 0:u.requireAsteriskPosition)?"asterisk-right":"asterisk-left",{[P.m("feedback")]:null==u?void 0:u.statusIcon,[P.m(`label-${ae.value}`)]:ae.value}]),se=v(()=>s(o.inlineMessage)?o.inlineMessage:(null==u?void 0:u.inlineMessage)||!1),oe=v(()=>[P.e("error"),{[P.em("error","inline")]:se.value}]),ne=v(()=>o.prop?r(o.prop)?o.prop.join("."):o.prop:""),de=v(()=>!(!o.label&&!n.label)),ve=v(()=>{var e;return null!=(e=o.for)?e:1===O.value.length?O.value[0]:void 0}),ce=v(()=>!ve.value&&de.value),pe=!!c,fe=v(()=>{const e=null==u?void 0:u.model;if(e&&o.prop)return V(e,o.prop).value}),me=v(()=>{const{required:e}=o,l=[];o.rules&&l.push(...D(o.rules));const a=null==u?void 0:u.rules;if(a&&o.prop){const e=V(a,o.prop).value;e&&l.push(...D(e))}if(void 0!==e){const a=l.map((e,l)=>[e,l]).filter(([e])=>Object.keys(e).includes("required"));if(a.length>0)for(const[t,r]of a)t.required!==e&&(l[r]={...t,required:e});else l.push({required:e})}return l}),ge=v(()=>me.value.length>0),he=v(()=>me.value.some(e=>e.required)),be=v(()=>{var e;return"error"===Y.value&&o.showMessage&&(null==(e=null==u?void 0:u.showMessage)||e)}),ye=v(()=>`${o.label||""}${(null==u?void 0:u.labelSuffix)||""}`),Se=e=>{K.value=e},we=async e=>{const l=ne.value;return new H({[l]:e}).validate({[l]:fe.value},{firstFields:!0}).then(()=>(Se("success"),null==u||u.emit("validate",o.prop,!0,""),!0)).catch(e=>((e=>{var l,a;const{errors:t,fields:r}=e;t&&r||console.error(e),Se("error"),J.value=t?null!=(a=null==(l=null==t?void 0:t[0])?void 0:l.message)?a:`${o.prop} is required`:"",null==u||u.emit("validate",o.prop,!1,J.value)})(e),Promise.reject(e)))},Fe=async(e,l)=>{if(le||!o.prop)return!1;const a=I(l);if(!ge.value)return null==l||l(!1),!1;const t=(e=>me.value.filter(l=>!l.trigger||!e||(r(l.trigger)?l.trigger.includes(e):l.trigger===e)).map(({trigger:e,...l})=>l))(e);return 0===t.length?(null==l||l(!0),!0):(Se("validating"),we(t).then(()=>(null==l||l(!0),!0)).catch(e=>{const{fields:t}=e;return null==l||l(!1,t),!a&&Promise.reject(t)}))},je=()=>{Se(""),J.value="",le=!1},Ie=async()=>{const e=null==u?void 0:u.model;if(!e||!o.prop)return;const l=V(e,o.prop);le=!0,l.value=Z(ee),await k(),je(),le=!1};g(()=>o.error,e=>{J.value=e||"",Se(e?"error":"")},{immediate:!0}),g(()=>o.validateStatus,e=>Se(e||""));const We=f({...b(o),$el:U,size:p,validateMessage:J,validateState:K,labelId:$,inputIds:O,isGroup:ce,hasLabel:de,fieldValue:fe,addInputId:e=>{O.value.includes(e)||O.value.push(e)},removeInputId:e=>{O.value=O.value.filter(l=>l!==e)},resetField:Ie,clearValidate:je,validate:Fe,propString:ne});return h(a,We),q(()=>{o.prop&&(null==u||u.addField(We),ee=Z(fe.value))}),M(()=>{null==u||u.removeField(We)}),i({size:p,validateMessage:J,validateState:K,validate:Fe,clearValidate:je,resetField:Ie}),(e,l)=>{var a;return S(),y("div",{ref_key:"formItemRef",ref:U,class:F(j(ie)),role:j(ce)?"group":void 0,"aria-labelledby":j(ce)?j($):void 0},[B(j(ue),{"is-auto-width":"auto"===j(te).width,"update-all":"auto"===(null==(a=j(u))?void 0:a.labelWidth)},{default:R(()=>[j(de)?(S(),_(C(j(ve)?"label":"div"),{key:0,id:j($),for:j(ve),class:F(j(P).e("label")),style:N(j(te))},{default:R(()=>[w(e.$slots,"label",{label:j(ye)},()=>[T(Q(j(ye)),1)])]),_:3},8,["id","for","class","style"])):z("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),L("div",{class:F(j(P).e("content")),style:N(j(re))},[w(e.$slots,"default"),B(G,{name:`${j(P).namespace.value}-zoom-in-top`},{default:R(()=>[j(be)?w(e.$slots,"error",{key:0,error:J.value},()=>[L("div",{class:F(j(oe))},Q(J.value),3)]):z("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}}),[["__file","form-item.vue"]]);const ce=K(se,{FormItem:ve}),pe=Y(ve);export{pe as E,ce as a};
