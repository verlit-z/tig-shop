import{_ as e}from"./BDziKWme.js";import{E as t}from"./BYBCH-HF.js";import{_ as a}from"./CUjxzVkc.js";import{E as l}from"./CqjQ_mIo.js";import{_ as s}from"./CACs9nxh.js";import{e as o,f as i,z as c,r as d,y as n,ak as u,B as r,c as m,o as v,b as p,i as f,n as h,a as k,t as y,w as g,d as b,F as V,m as x,j as _,al as j,x as C,s as $,k as w,E as T,am as U,p as D,an as E,ao as S,ap as I,ah as A,aq as F,_ as O}from"./BoLQ9Xhu.js";import{_ as q}from"./Bk7c1JMx.js";import{_ as B}from"./DFo55n29.js";import"./D3Ou390f.js";import z from"./C03Ywz0X.js";import L from"./D1F-LMuH.js";import N from"./BiFy8vOg.js";import{E as W}from"./C6OBWpTT.js";import"./oOeuh3JC.js";import"./nqCHxoJt.js";import"./Cy_EVX_n.js";import"./DEVzVrts.js";import"./k79prmI0.js";import"./MzbMzCCn.js";import"./BSss4uk8.js";import"./DCawybvr.js";import"./7ACzQoE5.js";import"./BmDvg8bE.js";import"./C_oH9tmG.js";import"./D5wp6cRH.js";import"./Y9Rb4YJs.js";/* empty css        */import"./C4BNlK69.js";import"./CxiTASIj.js";import"./BXXR0KLv.js";/* empty css        */import"./D0GOQlI4.js";const P={style:{"background-color":"#f2f3f5"}},R={key:0,class:"container"},Y={class:"no_goods clearfix"},H={class:"left main"},Q={class:"strong"},X={key:1,class:"container"},Z={class:"cart-tit"},G={class:"cart-head"},J={class:"product-list-cart flex"},K={class:"item col-1 center"},M={class:"item col-1",style:{"justify-content":"left"}},ee={class:"item col-3",style:{"justify-content":"left"}},te={class:"item col-2 center"},ae={class:"item col-2 center"},le={class:"item col-2 center"},se={class:"item col-2 center"},oe={class:"cart_table"},ie={class:"cart_store_title flex"},ce={class:"item col-1 center"},de={class:"item col-3 flex align-center"},ne={key:0,class:"tag"},ue={key:1,class:"tit"},re={class:"cart_list_wrap"},me={class:"product-item flex"},ve={class:"item col-1 center flex align-center justify-center"},pe={class:"item col-4 flex"},fe={class:"pic"},he=["href"],ke=["src"],ye={key:1},ge=["src"],be={key:2,class:"disabled"},Ve={key:0},xe={class:"name pt5"},_e=["href"],je={key:1},Ce={class:"info"},$e={key:2,class:"extraskudata"},we={class:"title"},Te={class:"content"},Ue={class:"content-text"},De={class:"num"},Ee={key:3,class:"promotion-box"},Se={key:0,class:"promotion"},Ie={class:"ticket-content"},Ae={key:1,class:"promotion"},Fe={class:"ticket-type"},Oe={class:"ticket-content"},qe={class:"item col-2 center"},Be={class:"price pt5 center-price"},ze={class:"item col-2 center"},Le={class:"pt5 flex justify-center"},Ne={class:"item col-2 center"},We={class:"money pt5"},Pe={class:"item col-2 center"},Re=["onClick"],Ye={key:0,class:"gift-box"},He={class:"gift-title"},Qe={class:"gift-content"},Xe={class:"gift-content-item"},Ze={class:"gift-item-left"},Ge={class:"gift-item-right"},Je={class:"gift-item-name"},Ke={key:0,class:"sku-card"},Me={class:"gift-item-num"},et={class:"pay_tools_inner flex justify-between align-center container"},tt={class:"pay_tools_l flex align-center"},at={class:"item col-1 center"},lt={class:"pay_txt_row flex"},st={class:"font-color"},ot={class:"pay_tools_r flex align-center"},it={class:"pay_tools_total_box"},ct={class:"flex align-center justify-end"},dt={class:"r_prod_view"},nt={class:"font-color"},ut={class:"r_price_total"},rt={class:"tit"},mt={class:"discounts-btn-box"},vt={class:"discounts-btn"},pt={class:"discount"},ft={class:"discount-title"},ht={class:"title-text"},kt={class:"discount-content"},yt={class:"discount-item-box"},gt={class:"item-label"},bt={class:"item-value"},Vt={key:0,class:"discount-item-box"},xt={class:"item-label"},_t={class:"item-value"},jt={class:"discount-item-box"},Ct={class:"item-label"},$t={class:"item-value discounts-value",style:{color:"var(--general)"}},wt={key:0,class:"sub-item-box"},Tt={class:"sub-item-label"},Ut={class:"sub-item-value discounts-value"},Dt={key:1,class:"discount-detail"},Et={class:"sub-item-label"},St={class:"sub-item-value discounts-value"},It={class:"discount-item-box"},At={class:"item-label"},Ft={class:"item-value"},Ot={class:"discount-desc"},qt={key:3},Bt=O(o({__name:"index",setup(o){const O=i(),{t:Bt}=c(),zt=d(!0),Lt=d([]),Nt=d({}),Wt=d(!1),Pt=d();n(()=>{Yt()});const Rt=e=>0==e.productStatus||0==e.stock||1==e.isDisabled,Yt=async()=>{try{Pt.value=W.service({lock:!1,text:Bt("请求加载中"),customClass:"tig-normal-loading"});const e=await u();Lt.value=e.cartList,Nt.value=e.total,ea()}catch(e){}finally{zt.value=!1,Pt.value.close(),Wt.value=!0}},Ht=async()=>{try{const e=[];Lt.value.forEach(t=>{t.carts.forEach(t=>{e.push({cartId:t.cartId,isChecked:t.isChecked&&!1===t.isDisabled?1:0})})});await F({data:e});Yt()}catch(e){}};let Qt;const Xt=e=>{Qt&&clearTimeout(Qt),Qt=setTimeout(()=>{Zt(e)},300)},Zt=async e=>{try{await U(e.cartId,{quantity:e.quantity}),Yt()}catch(t){console.log(t),D.error(t.message),Yt()}},Gt=()=>{let e=0;Lt.value.forEach(t=>{t.carts.forEach(t=>{1==t.isChecked&&(e+=1)})}),0!=e?E.confirm({title:Bt("确认要删除指定的商品吗"),cancelText:Bt("取消"),okText:Bt("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{const e=[];Lt.value.forEach(t=>{t.carts.forEach(t=>{t.isChecked&&e.push(t.cartId)})});await S(e);await Yt()}catch(e){}}}):D.error(Bt("您还未选中任何商品"))},Jt=()=>{E.confirm({title:Bt("确认要清空购物车吗？"),cancelText:Bt("取消"),okText:Bt("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{await I();await Yt()}catch(e){}}})},Kt=()=>{Lt.value.forEach(e=>{e.carts.forEach(e=>{e.isChecked=1==Mt.value&&!1===e.isDisabled})}),ea(),Ht()},Mt=d(!1),ea=()=>{Lt.value.forEach(e=>{const t=e.carts.filter(e=>!e.isDisabled);e.isChecked=t.every(e=>!0===e.isChecked&&!e.isDisabled)}),Mt.value=Lt.value.every(e=>!0===e.isChecked)},ta=d(null),aa=d(!1),la=()=>{const e=window.scrollY,t=window.innerHeight,a=ta.value,l=a?.getBoundingClientRect()?.top+e;aa.value=!(e+t-60>l)},sa={1:"秒杀价",2:"券",3:"满减",4:"折扣",5:"满赠",6:"限时折扣"},oa=e=>{const t=[],a=e.filter(e=>2===e.type),l=e.filter(e=>2!==e.type);return l.length>0&&t.push(l[0]),a.length>0&&t.push(a[0]),t},ia=d(!1);n(()=>{window.addEventListener("scroll",la),la()}),r(()=>{window.removeEventListener("scroll",la)});return(o,i)=>{const c=e,d=t,n=a,u=l,r=s,U=T,I=q,F=B;return v(),m("div",P,[p(c,{title:"购物车"}),p(z,{step:1}),zt.value||0!==Lt.value.length?f("",!0):(v(),m("div",R,[k("div",Y,[i[13]||(i[13]=k("div",{class:"left icon"},null,-1)),k("div",H,[k("div",Q,y(o.$t("您的购物车中暂时没有商品"))+"！",1),p(n,{to:"/"},{default:g(()=>[p(d,{type:"primary",size:"large",title:o.$t("马上挑选商品")},{default:g(()=>[b(y(o.$t("去逛逛")),1)]),_:1},8,["title"])]),_:1})])])])),!zt.value&&Lt.value.length>0?(v(),m("div",X,[k("p",Z,y(o.$t("你好，欢迎来到您的购物车")),1),k("div",null,[k("div",G,[k("div",J,[k("div",K,[p(u,{modelValue:Mt.value,"onUpdate:modelValue":i[0]||(i[0]=e=>Mt.value=e),onChange:Kt},null,8,["modelValue"])]),k("div",M,y(o.$t("全选")),1),k("div",ee,y(o.$t("商品信息")),1),k("div",te,y(o.$t("单价")),1),k("div",ae,y(o.$t("数量")),1),k("div",le,y(o.$t("小计")),1),k("div",se,y(o.$t("操作")),1)])]),Lt.value?(v(!0),m(V,{key:0},x(Lt.value,(e,t)=>(v(),m("div",oe,[k("div",ie,[k("div",ce,[p(u,{modelValue:e.isChecked,"onUpdate:modelValue":t=>e.isChecked=t,onChange:t=>(e=>{e.carts.forEach(t=>{t.isChecked=1==e.isChecked}),ea(),Ht()})(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),k("div",de,[0==e.shopId?(v(),m("div",ne,y(o.$t("自营")),1)):_(j)()?(v(),m("div",ue,y(e.shopTitle),1)):f("",!0)])]),k("div",re,[(v(!0),m(V,null,x(e.carts,e=>(v(),m("div",{class:C(["product-list-cart",Rt(e)?"disabled-item":""])},[k("div",me,[k("div",ve,[p(u,{modelValue:e.isChecked,"onUpdate:modelValue":t=>e.isChecked=t,onChange:i[1]||(i[1]=e=>{Ht()}),disabled:Rt(e)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),k("div",pe,[k("div",fe,[0!=e.stock&&0!=e.productStatus?(v(),m("a",{key:0,target:"_blank",href:_($)({path:"product",id:e.productId,sn:e.productSn})},[k("img",{src:("imageFormat"in o?o.imageFormat:_(w))(e.picThumb),alt:""},null,8,ke)],8,he)):(v(),m("div",ye,[k("img",{src:("imageFormat"in o?o.imageFormat:_(w))(e.picThumb),alt:""},null,8,ge)])),0!=e.stock&&0!=e.productStatus||1!=e.isDisabled?f("",!0):(v(),m("div",be,[0==e.stock||0==e.productStatus?(v(),m("div",Ve,y(0==e.productStatus?o.$t("已下架"):o.$t("已售罄")),1)):f("",!0)]))]),k("div",xe,[0!=e.stock&&0!=e.productStatus?(v(),m("a",{key:0,target:"_blank",href:_($)({path:"product",id:e.productId,sn:e.productSn})},y(e.productName),9,_e)):(v(),m("p",je,y(e.productName),1)),k("div",Ce,[(v(!0),m(V,null,x(e.skuData,(e,t)=>(v(),m("span",null,y(0!==t?" , ":"")+y(e.name)+":"+y(e.value),1))),256))]),e.extraSkuData&&e.extraSkuData.length?(v(),m("div",$e,[(v(!0),m(V,null,x(e.extraSkuData,t=>(v(),m("div",{key:t,class:"extraskudata-item"},[k("div",we,y(t.attrName),1),i[14]||(i[14]=k("div",{class:"line-box"},[k("div",{class:"line"})],-1)),k("div",Te,[k("span",Ue,y(t.attrValue),1),p(r,{modelValue:t.attrPrice,"onUpdate:modelValue":e=>t.attrPrice=e,showText:!1},null,8,["modelValue","onUpdate:modelValue"]),k("span",De,"x"+y(e.quantity),1)])]))),128))])):f("",!0),e.activityInfo?(v(),m("div",Ee,[(v(!0),m(V,null,x(oa(e.activityInfo),e=>(v(),m("div",{class:"promotion-box-item",key:e.promotionId},[2!=e.type?(v(),m("div",Se,[k("div",Ie,y(o.$t(sa[e.type])),1)])):f("",!0),2==e.type?(v(),m("div",Ae,[k("div",Fe,[b(y(o.$t("券")),1),i[15]||(i[15]=k("span",{class:"ticket-line"},null,-1))]),k("div",Oe,y(e.data.promotionDesc),1)])):f("",!0)]))),128))])):f("",!0)])]),k("div",qe,[k("div",Be,[p(r,{modelValue:e.price,"onUpdate:modelValue":t=>e.price=t,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])]),k("div",ze,[k("div",Le,[p(L,{max:e.stock,modelValue:e.quantity,"onUpdate:modelValue":t=>e.quantity=t,onChange:t=>(e=>{Xt(e)})(e),disabled:Rt(e)},null,8,["max","modelValue","onUpdate:modelValue","onChange","disabled"])])]),k("div",Ne,[k("div",We,[p(r,{modelValue:e.subtotal,"onUpdate:modelValue":t=>e.subtotal=t,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])]),k("div",Pe,[k("div",null,[k("a",{onClick:t=>{return a=e.cartId,void E.confirm({title:Bt("确认要删除该商品吗"),cancelText:Bt("取消"),okText:Bt("确定"),maskClosable:!0,centered:!0,onOk:async()=>{try{await S([a]),Yt()}catch(e){}}});var a},style:{cursor:"pointer"}},i[16]||(i[16]=[k("i",{class:"iconfont-pc icon-shanchu"},null,-1)]),8,Re)])])]),i[17]||(i[17]=k("div",{class:"cart-line"},null,-1))],2))),256))]),e.gift.length>0?(v(),m("div",Ye,[k("div",He,y(o.$t("赠品")),1),k("div",Qe,[(v(!0),m(V,null,x(e.gift,e=>(v(),h(n,{key:e.giftId,target:"_blank",to:_($)({path:"product",id:e.productId,sn:e.productSn})},{default:g(()=>[k("div",Xe,[k("div",Ze,[p(U,{class:"gift-img",lazy:"",src:("imageFormat"in o?o.imageFormat:_(w))(e.picThumb)},null,8,["src"])]),k("div",Ge,[k("div",Je,y(e.productName),1),e.skuData.length>0?(v(),m("div",Ke,[(v(!0),m(V,null,x(e.skuData,(e,t)=>(v(),m("div",{key:t,class:"sku-item"},y(e.value),1))),128))])):f("",!0),k("div",Me,"x"+y(e.num),1)])])]),_:2},1032,["to"]))),128))])])):f("",!0)]))),256)):f("",!0),k("div",{class:"checkOutBar",id:"price-total",ref_key:"checkOutBarRef",ref:ta},[k("div",{class:C({pay_tools_bar:!0,tools_bar_bottom:aa.value})},[k("div",et,[k("div",tt,[k("div",at,[p(u,{modelValue:Mt.value,"onUpdate:modelValue":i[2]||(i[2]=e=>Mt.value=e),onChange:Kt},null,8,["modelValue"])]),k("div",lt,[b(y(o.$t("全选"))+" ",1),k("div",null,[k("span",null,[b(y(o.$t("共"))+" ",1),k("span",st,y(Nt.value.totalCount),1),b(" "+y(o.$t("件")),1)])]),k("div",null,[k("a",{onClick:Gt},y(o.$t("删除勾选商品")),1)]),k("div",null,[k("a",{onClick:Jt},y(o.$t("清空购物车")),1)])])]),k("div",ot,[k("div",it,[k("div",ct,[k("p",dt,[b(y(o.$t("已选商品"))+" ",1),k("span",nt,y(Nt.value.checkedCount),1),b(" "+y(o.$t("件")),1)]),k("div",ut,[k("span",rt,y(o.$t("合计"))+"：",1),p(r,{modelValue:Nt.value.discountAfter,"onUpdate:modelValue":i[3]||(i[3]=e=>Nt.value.discountAfter=e),showText:!1},null,8,["modelValue"])])]),k("div",mt,[k("div",null,[b(y(o.$t("共优惠"))+"：",1),p(r,{modelValue:Nt.value.discounts,"onUpdate:modelValue":i[4]||(i[4]=e=>Nt.value.discounts=e),showText:!1},null,8,["modelValue"])]),p(I,{modelValue:ia.value,"onUpdate:modelValue":i[11]||(i[11]=e=>ia.value=e)},{reference:g(()=>[k("div",vt,[b(y(o.$t("优惠明细"))+" ",1),k("span",{class:C(["iconfont-pc icon-shangjiantou",{"icon-active":ia.value}])},null,2)])]),default:g(()=>[k("div",pt,[k("div",ft,[k("div",ht,y(o.$t("优惠明细")),1)]),k("div",kt,[k("div",yt,[k("div",gt,y(o.$t("商品总额")),1),k("div",bt,[p(r,{showText:!1,modelValue:Nt.value.productAmount,"onUpdate:modelValue":i[5]||(i[5]=e=>Nt.value.productAmount=e),fontStyle:{fontWeight:"bold"}},null,8,["modelValue"])])]),Nt.value.serviceFee&&Nt.value.serviceFee>0?(v(),m("div",Vt,[k("div",xt,y(o.$t("附加费用")),1),k("div",_t,[p(r,{modelValue:Nt.value.serviceFee,"onUpdate:modelValue":i[6]||(i[6]=e=>Nt.value.serviceFee=e),fontStyle:{fontWeight:"bold"},showText:!1},null,8,["modelValue"])])])):f("",!0),k("div",jt,[k("div",Ct,y(o.$t("共优惠")),1),k("div",$t,[i[18]||(i[18]=b(" - ",-1)),p(r,{modelValue:Nt.value.discounts,"onUpdate:modelValue":i[7]||(i[7]=e=>Nt.value.discounts=e),showText:!1},null,8,["modelValue"])]),Nt.value.discountDiscountAmount>0?(v(),m("div",wt,[k("div",Tt,y(o.$t("活动优惠")),1),k("div",Ut,[i[19]||(i[19]=b(" - ",-1)),p(r,{modelValue:Nt.value.discountDiscountAmount,"onUpdate:modelValue":i[8]||(i[8]=e=>Nt.value.discountDiscountAmount=e),showText:!1},null,8,["modelValue"])])])):f("",!0)]),Nt.value.discountCouponAmount>0?(v(),m("div",Dt,[k("div",Et,y(o.$t("优惠券")),1),k("div",St,[i[20]||(i[20]=b(" - ",-1)),p(r,{modelValue:Nt.value.discountCouponAmount,"onUpdate:modelValue":i[9]||(i[9]=e=>Nt.value.discountCouponAmount=e),showText:!1},null,8,["modelValue"])])])):f("",!0),k("div",It,[k("div",At,y(o.$t("合计")),1),k("div",Ft,[p(r,{modelValue:Nt.value.discountAfter,"onUpdate:modelValue":i[10]||(i[10]=e=>Nt.value.discountAfter=e),fontStyle:{fontWeight:"bold"},showText:!1},null,8,["modelValue"])])]),k("div",Ot,y(o.$t("以上优惠不包含运费，实际优惠金额请以确认订单页为准")),1)])])]),_:1},8,["modelValue"])])]),k("div",{onClick:i[12]||(i[12]=e=>Nt.value.checkedCount&&(()=>{if(1===O.closeOrder)return D.error(Bt("商城已关闭下单"));A("/order/check/")})()),class:C("checkout_btn hand-pointer "+(0==Nt.value.checkedCount?"disabled":""))},y(o.$t("去结算")),3)])])],2)],512)])])):f("",!0),Wt.value?(v(),h(N,{key:2,onOnBuy:Yt})):f("",!0),zt.value?(v(),m("div",qt,i[21]||(i[21]=[k("div",null,[k("div",{style:{height:"300px",width:"100%"}})],-1)]))):f("",!0),p(F)])}}}),[["__scopeId","data-v-4feba1b0"]]);export{Bt as default};
