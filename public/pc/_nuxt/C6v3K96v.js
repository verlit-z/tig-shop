import{b as e}from"./C0PQcRxs.js";import{_ as a}from"./BDziKWme.js";import{_ as l}from"./ynFusRyl.js";import{T as r}from"./oOeuh3JC.js";import{e as t,cA as s,f as i,r as o,z as n,aA as u,v as c,H as d,c as v,o as p,F as m,b as y,a as g,w as f,d as k,t as b,i as j,j as h,x,m as P,k as I,ad as w,as as _,p as q,_ as C,G as $,h as S,c2 as F,n as O,al as N,aE as M,ah as U}from"./BoLQ9Xhu.js";import{u as T,g as V,C as B}from"./CC3eRyyO.js";import{_ as R}from"./DFo55n29.js";import W from"./CVJYr33e.js";import"./Bk7c1JMx.js";import"./CUjxzVkc.js";import"./CACs9nxh.js";import"./MzbMzCCn.js";import"./BYBCH-HF.js";import"./nqCHxoJt.js";import"./Cy_EVX_n.js";import"./DEVzVrts.js";import"./BSss4uk8.js";import"./k79prmI0.js";import"./DCawybvr.js";import"./7ACzQoE5.js";import"./BmDvg8bE.js";import"./C_oH9tmG.js";import"./D5wp6cRH.js";import"./Y9Rb4YJs.js";/* empty css        */import"./C-LthTfX.js";import"./7KO-WwAc.js";import"./DwsKuIG7.js";import"./CxiTASIj.js";import"./BXXR0KLv.js";/* empty css        */import"./DkwbP8TR.js";import"./D0GOQlI4.js";import"./C4BNlK69.js";import"./EfClc7Gk.js";const A={class:"filter__box"},G={class:"sear-title"},L={key:0},z={class:"st-ext"},E={class:"filter"},H={key:0,class:"list"},Q={class:"attr-name"},X={class:"attr-box"},Y=["onClick"],Z={key:1,class:"list brand_fitlter"},D={class:"attr-name"},J={class:"attr-box"},K={key:0,class:"category-brand-f-letter"},ee=["onClick"],ae=["onClick"],le={class:"pic_box"},re=["src"],te={class:"brand_name"},se={class:"attr-multiple-text"},ie={key:0,class:"fc-btn-box"},oe={class:"cat-sort-warp"},ne={class:"cat-sort"},ue={class:"flex"},ce={class:"lefter"},de=["title"],ve=["title"],pe=["title"],me=["title"],ye={key:0,class:"iconfont-pc icon-xiajiantou1"},ge={key:1,class:"iconfont-pc icon-shangjiantou1"},fe={class:"priceform"},ke={class:"form-bg"},be={class:"righter"},je={class:"productsNO"},he={class:"pageInfo"},xe={class:"page_number"},Pe=C(t({__name:"Filter",props:s({isSearchPage:{type:Boolean,default:!1},total:{type:Number,default:0},queryParams:{type:Object,default:{}},pageType:{type:String,default:"search"}},{filter:{},filterModifiers:{},filterSeleted:{},filterSeletedModifiers:{}}),emits:s(["change"],["update:filter","update:filterSeleted"]),setup(e,{expose:a,emit:l}){const t=T(),s=i(),C=o("");o(),o();const{t:$}=n(),S=e,F=l,O=u(e,"filter"),N=u(e,"filterSeleted"),M=o({category:"",brand:""}),U=o({brand:[],category:[]}),B=o(!1),R=o(O.value.minPrice),W=o(O.value.maxPrice),Pe=c(()=>t.total?Math.ceil(Number(t.total)/25):1);d(()=>O.value,()=>{(async()=>{try{const e=await V({...S.queryParams,page_type:S.pageType});U.value.brand=e.filter.brand,U.value.category=e.filter.category,M.value=e.filterSelected,C.value="",M.value.category&&(C.value+=M.value.category+" - "),O.value.keyword&&(C.value+=O.value.keyword+" -  "),M.value.brand&&(C.value+=M.value.brand+" -  "),C.value+=$("商品搜索")+s.pageTitle,N.value=e.filterSelected}catch(e){}})()},{deep:!0,immediate:!0});const Ie=c(()=>Fe.value?U.value.brand.filter(e=>e.firstWord===Fe.value):U.value.brand),we=o(!1),_e=o(!1),qe=c(()=>{const e=[...new Set(U.value.brand.map(e=>e.firstWord))];return e.sort(),e}),Ce=o([]),$e=()=>{we.value=!1,_e.value=!1,Ce.value=O.value.brandIds},Se=()=>{O.value.brandIds=Ce.value,O.value.page=1,we.value=!1,_e.value=!1,F("change")},Fe=o(""),Oe=e=>{""===e?(O.value.sortField="",O.value.sortOrder=""):"sale"===e?(O.value.sortField="sale",O.value.sortOrder=""):"time"===e?(O.value.sortField="time",O.value.sortOrder=""):"price"===e&&(O.value.sortField="price",O.value.sortOrder="asc"===O.value.sortOrder?"desc":"asc"),O.value.page=1,F("change")},Ne=()=>{O.value.page>1&&(O.value.page--,F("change",O.value.page))},Me=()=>{O.value.page<Pe.value&&(O.value.page++,F("change",O.value.page))},Ue=()=>{if(R.value>W.value||0===W.value)return q.error($("请输入正确的价格范围"));O.value.minPrice=R.value??0,O.value.maxPrice=W.value??0,F("change")};return a({clearMultipleBrandIds:()=>{Ce.value.length=0}}),(e,a)=>{const l=r;return p(),v(m,null,[y(l,null,{default:f(()=>[k(b(C.value),1)]),_:1}),g("div",A,[g("div",G,[g("h3",null,[M.value&&M.value.category?(p(),v("b",L,b(M.value.category),1)):j("",!0),g("em",null,b(e.$t("商品筛选")),1)]),g("div",z,[k(b(e.$t("共"))+" ",1),g("span",null,b(h(t).total),1),k(" "+b(e.$t("个商品")),1)])]),g("div",E,[U.value.category.length>0?(p(),v("div",H,[g("div",Q,b(e.$t("分类：")),1),g("div",X,[g("div",{class:x(["category-link",{"category-link-more":B.value}])},[(p(!0),v(m,null,P(U.value.category,(e,a)=>(p(),v("div",{class:"item",key:a,onClick:a=>{return l=e.categoryId,O.value.categoryId=l,O.value.page=1,void F("change");var l}},b(e.categoryName),9,Y))),128))],2),U.value.category.length>10?(p(),v("span",{key:0,class:x(["attrMore",{attrMoreUp:B.value}]),onClick:a[0]||(a[0]=e=>B.value=!B.value)},[k(b(B.value?e.$t("收起"):e.$t("更多")),1),a[10]||(a[10]=g("i",{class:"iconfont-pc icon-xiajiantou"},null,-1))],2)):j("",!0)])])):j("",!0),U.value.brand.length>0&&0===O.value.brandIds.length?(p(),v("div",Z,[g("div",D,b(e.$t("品牌：")),1),g("div",J,[we.value?(p(),v("div",K,[g("div",{class:x(["leter",{cur:""===Fe.value}]),"data-word":"all",onClick:a[1]||(a[1]=e=>Fe.value="")},b(e.$t("所有品牌")),3),(p(!0),v(m,null,P(h(qe),(e,a)=>(p(),v("div",{class:x(["leter",{cur:Fe.value==e}]),key:a,onClick:a=>{return l=e,void(Fe.value=l);var l}},b(e),11,ee))),128))])):j("",!0),g("div",{class:x({"category-brand-wrap":!we.value,"category-brand-f-wrap":we.value})},[(p(!0),v(m,null,P(h(Ie),(e,l)=>{return p(),v(m,{key:l},[we.value||!we.value&&l<8?(p(),v("div",{key:0,class:x(["item",{selected:(r=e.brandId,Ce.value.indexOf(r)>-1)}]),onClick:a=>(e=>{if(!0===_e.value){const a=Ce.value.indexOf(e);a>-1?Ce.value.splice(a,1):Ce.value.push(e)}else O.value.brandIds=[e],O.value.page=1,F("change")})(e.brandId)},[g("span",le,[g("img",{src:h(I)(e.brandLogo)},null,8,re)]),g("span",te,b(e.brandName),1),a[11]||(a[11]=g("i",null,null,-1))],10,ae)):j("",!0)],64);var r}),128))],2),g("span",{class:x(["attrMore",{attrMoreUp:we.value}]),onClick:a[2]||(a[2]=e=>we.value=!we.value)},[k(b(we.value?e.$t("收起"):e.$t("更多")),1),a[12]||(a[12]=g("i",{class:"iconfont-pc icon-xiajiantou"},null,-1))],2),_e.value?j("",!0):(p(),v("div",{key:1,class:"attr-multiple",onClick:a[3]||(a[3]=e=>{_e.value=!0,we.value=!0})},[a[13]||(a[13]=g("i",null,"＋",-1)),g("div",se,b(e.$t("多选")),1)]))]),we.value&&_e.value?(p(),v("div",ie,[g("a",{class:x(["fc-btn-ok",{"fc-disable":0===Ce.value.length}]),onClick:Se},b(e.$t("确定")),3),g("a",{class:"fc-btn-cancel",onClick:$e},b(e.$t("取消")),1)])):j("",!0)])):j("",!0)]),g("div",oe,[g("div",ne,[g("div",ue,[g("div",ce,[g("span",{class:x(["sort-link",{cur_sort:""==O.value.sortField}]),title:h($)("默认排序（根据相关性排序）"),onClick:a[4]||(a[4]=e=>Oe(""))},b(e.$t("默认排序")),11,de),g("span",{class:x(["sort-link",{cur_sort:"sale"==O.value.sortField}]),title:h($)("销量（销量从高到低）"),onClick:a[5]||(a[5]=e=>Oe("sale"))},b(e.$t("销量")),11,ve),g("span",{class:x(["sort-link",{cur_sort:"time"==O.value.sortField}]),title:h($)("上架时间（最新发布排序）"),onClick:a[6]||(a[6]=e=>Oe("time"))},b(e.$t("新品")),11,pe),g("span",{class:x(["sort-link",{cur_sort:"price"==O.value.sortField}]),title:"desc"==O.value.sortOrder?h($)("价格（价格从高到低）"):h($)("价格（价格从低到高）"),onClick:a[7]||(a[7]=e=>Oe("price"))},[k(b(e.$t("价格"))+" ",1),"desc"==O.value.sortOrder?(p(),v("span",ye)):(p(),v("span",ge))],10,me)]),g("div",fe,[g("div",ke,[w(g("input",{type:"text",name:"pricemin","onUpdate:modelValue":a[8]||(a[8]=e=>R.value=e)},null,512),[[_,R.value,void 0,{number:!0}]]),a[14]||(a[14]=g("em",null," - ",-1)),w(g("input",{type:"text",name:"pricemax","onUpdate:modelValue":a[9]||(a[9]=e=>W.value=e)},null,512),[[_,W.value,void 0,{number:!0}]]),g("a",{class:"btn-default",draggable:"false",onClick:Ue,rel:"nofollow",href:"javascript:;"},b(e.$t("确定")),1)])])]),g("div",be,[g("div",je,[g("div",null,[k(b(e.$t("共")),1),g("em",null,b(h(t).total),1),k(b(e.$t("个商品")),1)])]),g("div",he,[g("span",xe,b(O.value.page)+"/"+b(h(Pe)),1),g("span",{onClick:Ne,class:x(["noPage",{disabled:1==O.value.page}])},"<",2),g("span",{onClick:Me,class:x(["noPage",{disabled:O.value.page===h(Pe)}])},">",2)])])])])])],64)}}}),[["__scopeId","data-v-7770fa37"]]),Ie={style:{"background-color":"#fff"}},we={class:"container"},_e={key:0,class:"nav-selected"},qe={key:1,class:"nav-selected"},Ce={key:1,class:"nav-selected"},$e=C(t({__name:"search",props:{pageType:{type:String,default:"search"}},setup(r){const t=r,s=o(),i=$(),n=S({page:1,categoryId:0,brandIds:[],sortField:"",sortOrder:"",maxPrice:0,minPrice:0,couponId:0,keyword:""});F(()=>{n.page=i.query.page?Number(i.query.page):1,n.categoryId=i.query.cat?Number(i.query.cat):0,n.brandIds=i.query.brand?String(i.query.brand).split(",").map(Number):[],n.sortField=i.query.sort?String(i.query.sort):"",n.sortOrder=i.query.order?String(i.query.order):"",n.maxPrice=i.query.max?Number(i.query.max):0,n.minPrice=i.query.min?Number(i.query.min):0,n.keyword=i.query.keyword?String(i.query.keyword):"",n.couponId=i.query.couponId?Number(i.query.couponId):0});const u=o();d(()=>u.value,e=>{null==e?.brand&&s.value?.clearMultipleBrandIds()});const k=c(()=>{let e={};return n.page>1&&(e.page=n.page),n.categoryId>0&&(e.cat=n.categoryId),n.couponId>0&&(e.couponId=n.couponId),n.brandIds.length>0&&(e.brand=n.brandIds.join(",")),""!=n.sortField&&["sale","price","time"].includes(n.sortField)&&(e.sort=n.sortField),""!=n.sortOrder&&["desc","asc"].includes(n.sortOrder)&&(e.order=n.sortOrder),n.maxPrice>0&&(e.max=n.maxPrice),n.minPrice>0&&(e.min=n.minPrice),""!=n.keyword&&(e.keyword=n.keyword),e}),x=(e=1)=>{n.page=e,U({path:"/"+t.pageType+"/",query:k.value})},P=o(null),I=()=>{const e=P.value;e&&e.scrollIntoView()};return(t,i)=>{const o=e,c=a,d=l,w=Pe,_=B,q=R;return p(),v("div",Ie,[y(o),y(c,{title:h(n).keyword?`${h(n).keyword} - 商品搜索`:"商品搜索"},null,8,["title"]),g("div",we,[h(N)()&&h(n).keyword?(p(),O(W,{key:0,keyword:h(n).keyword,style:{"flex-shrink":"0"}},null,8,["keyword"])):j("",!0),y(d,{id:h(n).categoryId,"onUpdate:id":i[3]||(i[3]=e=>h(n).categoryId=e),isSearchPage:"",onChange:x,style:{"flex-shrink":"0"}},{default:f(()=>[u.value?(p(),v(m,{key:0},[h(n).brandIds.length>0&&u.value.brand?(p(),v("div",_e,[g("div",{class:"item",onClick:i[0]||(i[0]=e=>{h(n).brandIds=[],x()})},[g("span",null,b(t.$t("品牌"))+"：",1),g("span",null,b(u.value.brand),1)])])):j("",!0),h(n).minPrice>0||h(n).maxPrice>0?(p(),v("div",qe,[g("div",{class:"item",onClick:i[1]||(i[1]=e=>{h(n).maxPrice=0,h(n).minPrice=0,x()})},[g("span",null,b(t.$t("价格"))+"：",1),g("span",null,b(h(n).minPrice??0)+" "+b(h(n).maxPrice>0?" - "+h(n).maxPrice:t.$t("以上")),1)])])):j("",!0)],64)):j("",!0),h(n).keyword?(p(),v("div",Ce,[h(n).keyword?(p(),v("div",{key:0,class:"item",onClick:i[2]||(i[2]=e=>{h(n).keyword="",x()})},[g("span",null,b(t.$t("搜索"))+"：",1),g("span",null,'"'+b(h(n).keyword)+'"',1)])):j("",!0)])):j("",!0)]),_:1},8,["id"]),g("div",{ref_key:"FilterRef",ref:P},[y(w,{ref_key:"filterRef",ref:s,filter:h(n),"onUpdate:filter":i[4]||(i[4]=e=>M(n)?n.value=e:null),filterSeleted:u.value,"onUpdate:filterSeleted":i[5]||(i[5]=e=>u.value=e),queryParams:h(k),"onUpdate:queryParams":i[6]||(i[6]=e=>M(k)?k.value=e:null),pageType:r.pageType,isSearchPage:"",onChange:x},null,8,["filter","filterSeleted","queryParams","pageType"])],512),y(_,{queryParams:h(k),"onUpdate:queryParams":i[7]||(i[7]=e=>M(k)?k.value=e:null),filter:h(n),"onUpdate:filter":i[8]||(i[8]=e=>M(n)?n.value=e:null),onChange:x,onPageChange:I},null,8,["queryParams","filter"])]),y(q)])}}}),[["__scopeId","data-v-3b8842ea"]]);export{$e as default};
