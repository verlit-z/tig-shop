import{b as e}from"./C0PQcRxs.js";import{_ as a}from"./BDziKWme.js";import{_ as l}from"./SixI1hze.js";import{_ as o}from"./CACs9nxh.js";import{_ as t}from"./CUjxzVkc.js";import{a4 as s,M as i,bW as n,N as r,O as d,dC as u,bV as c,dD as m,P as v,e as p,Q as f,R as b,r as h,v as y,bB as g,bm as x,bO as V,a3 as w,H as j,c as k,o as I,i as C,F as T,m as $,x as S,j as _,b as N,w as O,ad as P,n as U,aP as F,ae as R,Z as H,q as M,t as A,c4 as B,a2 as L,ag as D,f as E,z,y as J,ar as q,ah as W,p as Q,a as X,d as Z,k as K,s as Y,E as G,_ as ee}from"./BoLQ9Xhu.js";import{u as ae,b as le,d as oe,e as te,f as se}from"./Cy_EVX_n.js";import{U as ie,C as ne}from"./k79prmI0.js";import{E as re}from"./7KO-WwAc.js";import{E as de}from"./BYBCH-HF.js";import{_ as ue}from"./DFo55n29.js";import{g as ce,u as me}from"./C9YexJld.js";import{U as ve}from"./De9yxv7K.js";import"./Bk7c1JMx.js";import"./MzbMzCCn.js";import"./BSss4uk8.js";import"./nqCHxoJt.js";import"./DEVzVrts.js";import"./DCawybvr.js";import"./7ACzQoE5.js";import"./BmDvg8bE.js";import"./C_oH9tmG.js";import"./D5wp6cRH.js";import"./Y9Rb4YJs.js";/* empty css        */import"./C-LthTfX.js";import"./DwsKuIG7.js";import"./oOeuh3JC.js";import"./C4BNlK69.js";import"./DFr8_2Ck.js";import"./mHIovD83.js";const pe=i({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:d([Array,Object]),default:()=>r(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:d([Array,Object]),default:()=>[u,u,u]},voidIcon:{type:c,default:()=>m},disabledVoidIcon:{type:c,default:()=>u},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:d(Array),default:()=>r(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:n,clearable:Boolean,...ae(["ariaLabel"])}),fe={[ne]:e=>s(e),[ie]:e=>s(e)},be=p({name:"ElRate"});const he=D(v(p({...be,props:pe,emits:fe,setup(e,{expose:a,emit:l}){const o=e;function t(e,a){const l=e=>x(e),o=Object.keys(a).map(e=>+e).filter(o=>{const t=a[o];return!!l(t)&&t.excluded?e<o:e<=o}).sort((e,a)=>e-a),t=a[o[0]];return l(t)&&t.value||t}const s=f(te,void 0),i=f(se,void 0),n=le(),r=b("rate"),{inputId:d,isLabeledByFormItem:u}=oe(o,{formItemContext:i}),c=h(o.modelValue),m=h(-1),v=h(!0),p=y(()=>[r.b(),r.m(n.value)]),D=y(()=>o.disabled||(null==s?void 0:s.disabled)),E=y(()=>r.cssVarBlock({"void-color":o.voidColor,"disabled-void-color":o.disabledVoidColor,"fill-color":W.value})),z=y(()=>{let e="";return o.showScore?e=o.scoreTemplate.replace(/\{\s*value\s*\}/,D.value?`${o.modelValue}`:`${c.value}`):o.showText&&(e=o.texts[Math.ceil(c.value)-1]),e}),J=y(()=>100*o.modelValue-100*Math.floor(o.modelValue)),q=y(()=>g(o.colors)?{[o.lowThreshold]:o.colors[0],[o.highThreshold]:{value:o.colors[1],excluded:!0},[o.max]:o.colors[2]}:o.colors),W=y(()=>{const e=t(c.value,q.value);return x(e)?"":e}),Q=y(()=>{let e="";return D.value?e=`${J.value}%`:o.allowHalf&&(e="50%"),{color:W.value,width:e}}),X=y(()=>{let e=g(o.icons)?[...o.icons]:{...o.icons};return e=V(e),g(e)?{[o.lowThreshold]:e[0],[o.highThreshold]:{value:e[1],excluded:!0},[o.max]:e[2]}:e}),Z=y(()=>t(o.modelValue,X.value)),K=y(()=>D.value?w(o.disabledVoidIcon)?o.disabledVoidIcon:V(o.disabledVoidIcon):w(o.voidIcon)?o.voidIcon:V(o.voidIcon)),Y=y(()=>t(c.value,X.value));function G(e){const a=D.value&&J.value>0&&e-1<o.modelValue&&e>o.modelValue,l=o.allowHalf&&v.value&&e-.5<=c.value&&e>c.value;return a||l}function ee(e){o.clearable&&e===o.modelValue&&(e=0),l(ie,e),o.modelValue!==e&&l(ne,e)}function ae(e){if(D.value)return;let a=c.value;const t=e.code;return t===L.up||t===L.right?(o.allowHalf?a+=.5:a+=1,e.stopPropagation(),e.preventDefault()):t!==L.left&&t!==L.down||(o.allowHalf?a-=.5:a-=1,e.stopPropagation(),e.preventDefault()),a=a<0?0:a,a=a>o.max?o.max:a,l(ie,a),l(ne,a),a}function re(e,a){if(!D.value){if(o.allowHalf&&a){let l=a.target;B(l,r.e("item"))&&(l=l.querySelector(`.${r.e("icon")}`)),(0===l.clientWidth||B(l,r.e("decimal")))&&(l=l.parentNode),v.value=2*a.offsetX<=l.clientWidth,c.value=v.value?e-.5:e}else c.value=e;m.value=e}}function de(){D.value||(o.allowHalf&&(v.value=o.modelValue!==Math.floor(o.modelValue)),c.value=o.modelValue,m.value=-1)}return j(()=>o.modelValue,e=>{c.value=e,v.value=o.modelValue!==Math.floor(o.modelValue)}),o.modelValue||l(ie,0),a({setCurrentValue:re,resetCurrentValue:de}),(e,a)=>{var l;return I(),k("div",{id:_(d),class:S([_(p),_(r).is("disabled",_(D))]),role:"slider","aria-label":_(u)?void 0:e.ariaLabel||"rating","aria-labelledby":_(u)?null==(l=_(i))?void 0:l.labelId:void 0,"aria-valuenow":c.value,"aria-valuetext":_(z)||void 0,"aria-valuemin":"0","aria-valuemax":e.max,tabindex:"0",style:M(_(E)),onKeydown:ae},[(I(!0),k(T,null,$(e.max,(e,a)=>(I(),k("span",{key:a,class:S(_(r).e("item")),onMousemove:a=>re(e,a),onMouseleave:de,onClick:a=>{return l=e,void(D.value||(o.allowHalf&&v.value?ee(c.value):ee(l)));var l}},[N(_(H),{class:S([_(r).e("icon"),{hover:m.value===e},_(r).is("active",e<=c.value)])},{default:O(()=>[G(e)?C("v-if",!0):(I(),k(T,{key:0},[P((I(),U(F(_(Y)),null,null,512)),[[R,e<=c.value]]),P((I(),U(F(_(K)),null,null,512)),[[R,!(e<=c.value)]])],64)),G(e)?(I(),k(T,{key:1},[(I(),U(F(_(K)),{class:S([_(r).em("decimal","box")])},null,8,["class"])),N(_(H),{style:M(_(Q)),class:S([_(r).e("icon"),_(r).e("decimal")])},{default:O(()=>[(I(),U(F(_(Z))))]),_:1},8,["style","class"])],64)):C("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),e.showText||e.showScore?(I(),k("span",{key:0,class:S(_(r).e("text")),style:M({color:e.textColor})},A(_(z)),7)):C("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}}),[["__file","rate.vue"]])),ye={class:"container flex"},ge={class:"menu"},xe={class:"info-row"},Ve={class:"collection"},we={class:"nav"},je={class:"collection-list-tag"},ke={key:0,class:"white-card"},Ie={class:"product-left"},Ce=["src"],Te={style:{"line-height":"2"}},$e={class:"product-right"},Se={class:"lab-text"},_e={key:0},Ne={class:"tips"},Oe={class:"lab-text"},Pe={key:0,class:"label-list"},Ue=["onClick"],Fe=["onClick"],Re={key:1,class:"label-edit-input"},He=["onClick"],Me={key:1,class:"label-list"},Ae={class:"label-item-txt"},Be={class:"lab-text"},Le={key:1},De={class:"tips"},Ee={class:"lab-text"},ze={key:1},Je=ee(p({__name:"Info",setup(s){const i=E(),{t:n}=z(),r=h(["1分","2分","3分","4分","5分"]),d=h(!0),u=h(["送货快","质量很好","服务周到","正品","很划算","包装仔细","价格实惠","还可以","相当好"]),c=h([]);J(()=>{m()});const m=async()=>{try{c.value=[];const e=await ce({id:v.currentRoute.value.query.id});e.items.map(e=>{e.allCommentTag=JSON.parse(JSON.stringify(u.value)),Object.assign(e,{commentRank:0,content:"",showPics:[],commentTag:[],isAdd:!1,rankVerification:!0,contentVerification:!0,isCommentInfo:!!e.commentInfo},e.commentInfo)}),Object.assign(c.value,e.items);c.value.every(e=>1===e.isShowed)&&W("/member/comment/list?orderType=2")}catch(e){Q.error(e.message)}finally{d.value=!1}},v=q(),p=h(""),f=(e,a)=>{let l=c.value[e].commentTag;l.includes(a)?c.value[e].commentTag=l.filter(e=>e!==a):l.push(a)};return(s,d)=>{const u=e,v=a,b=l,h=o,y=t,g=he,x=re,V=G,w=de,j=ue;return I(),k(T,null,[N(u),N(v,{title:"评价晒单"}),X("div",ye,[X("div",ge,[N(b)]),X("div",xe,[X("div",Ve,[X("div",we,[X("div",je,A(s.$t("订单评价")),1),X("div",null,[Z(A(s.$t("评价立送")),1),d[1]||(d[1]=X("span",{class:"font-color"},"5",-1)),Z(A(s.$t(_(i).integralName))+"，"+A(s.$t("晒单额外赠送")),1),d[2]||(d[2]=X("span",{class:"font-color"},"5",-1)),Z(A(s.$t(_(i).integralName)),1)])]),(I(!0),k(T,null,$(c.value,(e,a)=>(I(),k("div",null,[e.isShowed?C("",!0):(I(),k("div",ke,[X("div",Ie,[N(y,{title:e.productName,to:("urlFormat"in s?s.urlFormat:_(Y))({path:"product",id:e.productId,sn:e.productSn}),class:"nuxt",target:"_blank"},{default:O(()=>[X("div",null,[X("img",{alt:"",src:("imageFormat"in s?s.imageFormat:_(K))(e.picThumb)},null,8,Ce)]),X("div",null,[X("div",Te,[X("a",null,A(e.productName),1)]),X("div",null,[N(h,{modelValue:e.price,"onUpdate:modelValue":a=>e.price=a,showText:!1},null,8,["modelValue","onUpdate:modelValue"])])])]),_:2},1032,["title","to"])]),X("div",$e,[X("div",null,[X("span",Se,A(s.$t("商品评分"))+"：",1),X("span",null,[N(g,{disabled:e.isCommentInfo,modelValue:e.commentRank,"onUpdate:modelValue":a=>e.commentRank=a,size:"large",texts:r.value,"show-text":""},null,8,["disabled","modelValue","onUpdate:modelValue","texts"])])]),e.rankVerification?C("",!0):(I(),k("div",_e,[d[3]||(d[3]=X("span",{class:"lab-text"},null,-1)),X("p",Ne,A(s.$t("请先评价商品")),1)])),X("div",null,[X("div",Oe,A(s.$t("评价标签"))+"：",1),e.isCommentInfo?(I(),k("div",Me,[(I(!0),k(T,null,$(e.commentTag,e=>(I(),k("div",Ae,[X("span",null,A(e),1)]))),256))])):(I(),k("div",Pe,[(I(!0),k(T,null,$(e.allCommentTag,l=>(I(),k("div",{style:M({border:e.commentTag.includes(l)?" 2px solid var(--general)":" 1px solid #ccc"}),class:"label-item",onClick:e=>f(a,l)},[X("span",null,A(s.$t(l)),1)],12,Ue))),256)),e.isAdd?(I(),k("div",Re,[X("div",null,[N(x,{modelValue:p.value,"onUpdate:modelValue":d[0]||(d[0]=e=>p.value=e),autofocus:""},null,8,["modelValue"])]),X("p",{onClick:e=>(e=>{if(""!==p.value){const a=JSON.parse(JSON.stringify(c.value[e].allCommentTag));a.push(p.value),c.value[e].allCommentTag=a,f(e,p.value)}p.value="",c.value[e].isAdd=!1})(a)},A(s.$t("确定")),9,He)])):(I(),k("div",{key:0,class:"label-edit",onClick:e=>(e=>{c.value[e].isAdd=!c.value[e].isAdd})(a)},[d[4]||(d[4]=X("div",null,null,-1)),X("p",null,A(s.$t("自定义")),1)],8,Fe))]))]),X("div",null,[X("div",Be,A(s.$t("购物心得"))+"：",1),N(x,{class:"label-textarea","show-word-limit":!0,modelValue:e.content,"onUpdate:modelValue":a=>e.content=a,disabled:e.isCommentInfo,rows:5,type:"textarea",maxlength:500,placeholder:s.$t("商品是否给力？快分享你的购买心得吧~")},null,8,["modelValue","onUpdate:modelValue","disabled","placeholder"])]),e.contentVerification?C("",!0):(I(),k("div",Le,[d[5]||(d[5]=X("span",{class:"lab-text"},null,-1)),X("p",De,A(s.$t("请填写购买心得")),1)])),X("div",null,[X("div",Ee,A(s.$t("晒单"))+"：",1),e.isShowed?(I(),k("div",ze,[(I(!0),k(T,null,$(e.showPics,e=>(I(),U(V,{src:("imageFormat"in s?s.imageFormat:_(K))(e.picThumb),loading:"lazy",style:{height:"80px",width:"80px",transition:"opacity 0.2s linear","margin-right":"10px"}},null,8,["src"]))),256))])):(I(),U(ve,{key:0,uploadList:e.showPics,"onUpdate:uploadList":a=>e.showPics=a,limit:9,fileTypes:["jpeg","png"]},null,8,["uploadList","onUpdate:uploadList"]))]),X("div",null,[N(w,{type:"primary",onClick:a=>(async e=>{if(e.commentRank<1)e.rankVerification=!1;else if(""!=e.content)try{const a={productId:e.productId,orderId:e.orderId,orderItemId:e.itemId,shopId:e.shopId,commentRank:e.commentRank,commentTag:e.commentTag,content:e.content,showPics:e.showPics};await me(a),e.rankVerification=!0,e.contentVerification=!0,Q.success(n("评价成功")),m()}catch(a){Q.error(a.message)}else e.contentVerification=!1})(e)},{default:O(()=>[Z(A(s.$t("提交评论")),1)]),_:2},1032,["onClick"])])])]))]))),256))])])]),N(j)],64)}}}),[["__scopeId","data-v-503c735a"]]);export{Je as default};
