import{aR as a,aN as t,aQ as e,r as s,e as o,cA as l,f as r,ar as d,aA as c,H as u,c as i,o as p,F as n,a as m,i as v,m as y,b as f,j as h,s as g,w as k,E as b,k as _,d as I,t as P,al as $,n as j,ad as S,as as C,x,_ as V}from"./BoLQ9Xhu.js";import{_ as q}from"./CUjxzVkc.js";import{_ as z}from"./CACs9nxh.js";import{E as U}from"./BYBCH-HF.js";import{B as w}from"./CxiTASIj.js";import{u as N}from"./BXXR0KLv.js";import{P as M}from"./DkwbP8TR.js";import{g as T}from"./D0GOQlI4.js";const E=t=>a({url:"search/search/getFilter",method:"get",params:t}),Q=e("search",()=>({total:s(0)})),A={class:"goods-list-c"},B={class:"wrap"},F={class:"g-item-warp"},L={class:"pic"},D={class:"info"},G={class:"name"},H={key:0,class:"shop-info"},O={key:1,class:"shop-name"},R={class:"promotion-box"},W={key:0,class:"activity"},Z={key:1,class:"promotion"},J={class:"ticket-type"},K={class:"ticket-content"},X={class:"item_cart_num"},Y={class:"shopping_num"},aa=["onUpdate:modelValue","onInput"],ta=["onClick"],ea=["onClick"],sa={class:"shopping_act"},oa={key:0,class:"search-empty"},la={class:"bd"},ra={class:"pagination"},da=V(o({__name:"CatGoodsList",props:l({queryParams:{type:Object,default:{}}},{filter:{},filterModifiers:{},queryParams:{},queryParamsModifiers:{},loadingProduct:{},loadingProductModifiers:{}}),emits:l(["change","pageChange"],["update:filter","update:queryParams","update:loadingProduct"]),setup(a,{emit:e}){const o=r(),l=a,V=Q(),E=d(),da=s(25),ca=e,ua=c(a,"filter"),ia=c(a,"queryParams"),pa=c(a,"loadingProduct"),na=s([]),ma=s({}),va=async()=>{try{pa.value=!0,na.value=[];const e=await(a={...l.queryParams,size:da.value},t({url:"search/search/getProduct",method:"get",params:a}));na.value=e.records,V.total=e.total??0,na.value.forEach(a=>{a.number=1});const s=e.records.map(a=>({productId:a.productId}));ya({products:s,from:"list"})}catch(e){}finally{pa.value=!1}var a},ya=async a=>{try{const t=await N({products:a.products,shopId:a.shopId,from:a.from});ma.value=t}catch(t){console.error(t)}},fa={1:"秒杀价",2:"券",3:"满减",4:"折扣",5:"满赠",6:"限时折扣"};u(()=>ia.value,()=>{va()},{deep:!0,immediate:!0});const ha=s(null),ga=()=>{ca("change",ua.value.page),ca("pageChange")},ka=()=>{E.back()};return(a,t)=>{const e=b,s=q,l=z,r=U,d=w;return p(),i(n,null,[m("div",{class:"goods-list__box",ref_key:"productBox",ref:ha},[m("div",A,[m("div",B,[(p(!0),i(n,null,y(na.value,(c,u)=>(p(),i("div",{class:"item",key:u},[m("div",F,[m("div",L,[f(s,{to:h(g)({path:"product",id:c.productId,sn:c.productSn}),target:"_blank"},{default:k(()=>[f(e,{class:"ease",lazy:"",src:h(_)(c.picUrl)},null,8,["src"])]),_:2},1032,["to"])]),m("div",D,[f(l,{class:"",modelValue:c.price,"onUpdate:modelValue":a=>c.price=a},null,8,["modelValue","onUpdate:modelValue"]),m("div",G,[f(s,{to:h(g)({path:"product",id:c.productId,sn:c.productSn}),target:"_blank"},{default:k(()=>[I(P(c.productName),1)]),_:2},1032,["to"])]),h($)()?(p(),i("div",H,[c.shop?(p(),j(s,{key:0,class:"shop-name",to:h(g)({path:"shop",id:c.shopId}),target:"_blank"},{default:k(()=>[I(P(a.$t(c.shop.shopTitle)),1)]),_:2},1032,["to"])):(p(),i("div",O,P(h(o).defaultShopName?a.$t(h(o).defaultShopName):a.$t("官方自营")),1))])):v("",!0),m("div",R,[ma.value[c.productId]&&ma.value[c.productId].activityInfo&&ma.value[c.productId].activityInfo.length>0?(p(!0),i(n,{key:0},y(ma.value[c.productId].activityInfo,e=>{return p(),i("div",{class:"promotion-box-item",key:e.productId},[2!=e.type?(p(),i("div",W,P(a.$t((s=e.type,fa[s]))),1)):v("",!0),2==e.type?(p(),i("div",Z,[m("div",J,[I(P(a.$t("券"))+" ",1),t[1]||(t[1]=m("span",{class:"ticket-line"},null,-1))]),m("div",K,P(e.data.promotionDesc),1)])):v("",!0)]);var s}),128)):v("",!0)]),m("div",X,[m("div",Y,[S(m("input",{"onUpdate:modelValue":a=>c.number=a,type:"text",onInput:a=>((a,t)=>{const e=a?.target.value.replace(/[^0-9]/g,"");t.number=e?Math.max(1,Number(e)):void 0})(a,c)},null,40,aa),[[C,c.number,void 0,{number:!0}]]),m("span",null,[m("a",{class:"add",href:"javascript:;",onClick:a=>(a=>{a.number&&a.number++})(c)},null,8,ta),m("a",{class:x(["decrease",c.number&&c.number<=1?"disabled":""]),href:"javascript:;",onClick:a=>(a=>{a.number&&a.number>1&&a.number--})(c)},null,10,ea)])]),m("div",sa,[c.productSku&&c.productSku.length>0?(p(),j(s,{key:0,to:h(g)({path:"product",id:c.productId,sn:c.productSn})},{default:k(()=>[f(r,{size:"small",type:"primary"},{default:k(()=>[I(P(a.$t(h(T)(c.productType))),1)]),_:2},1024)]),_:2},1032,["to"])):(p(),j(d,{key:1,isQuick:1!==c.productType,id:c.productId,disabled:0==c.productStock||0==c.seckillStock,number:c.number},{default:k(()=>[f(r,{disabled:0==c.productStock||0==c.seckillStock,size:"small",type:"primary"},{default:k(()=>[I(P(a.$t(h(T)(c.productType))),1)]),_:2},1032,["disabled"])]),_:2},1032,["isQuick","id","disabled","number"]))])])])])]))),128)),0!==na.value.length||pa.value?v("",!0):(p(),i("div",oa,[m("div",la,[m("h4",null,P(a.$t("好狠的筛选条件啊，把相关的商品都埋没了！")),1),m("p",null,P(a.$t("建议您")),1),m("p",null,P(a.$t("1、适当减少筛选条件")),1),m("p",null,P(a.$t("2、调整价格区间")),1),m("p",null,P(a.$t("3、尝试其他关键字")),1),f(r,{class:"graybtn mt10",onClick:ka},{default:k(()=>[I(P(a.$t("返回上一步")),1)]),_:1})])]))])])],512),m("div",ra,[h(V).total>0?(p(),j(h(M),{key:0,page:ua.value.page,"onUpdate:page":t[0]||(t[0]=a=>ua.value.page=a),size:da.value,total:h(V).total,onCallback:ga},null,8,["page","size","total"])):v("",!0)])],64)}}}),[["__scopeId","data-v-b9df2de2"]]);export{da as C,E as g,Q as u};
