import{a0 as e,d as a,K as l,k as s,r as t,a5 as o,c as u,w as n,B as i,E as d,o as r,g,i as c,f as m,t as p,I as h,O as v,J as f,V as y,a as _,Z as V,N as w,_ as k}from"./index-DE5OqlOG.js";import{b as I}from"./tig-layout.fowSnIDi.js";const N=k(a({__name:"selectRegion",props:{show:{type:Boolean,default:!1,required:!0},height:{type:String,default:"60vh"},modelValue:{type:Array,default:()=>[]}},emits:["update:show","update:modelValue","sendRegionNames"],setup(a,{emit:k}){const{t:N}=l(),j=a,C=k,R=s({get:()=>j.show,set:()=>{C("update:show",!1)}}),b=t([]),E=t(0),x=async()=>{try{let a="";j.modelValue.length>0&&(a=j.modelValue.join(","));const l=await(a=>e({url:"sys/region/getRegion",method:"get",params:{regionIds:a}}))(a);Object.assign(b.value,l),b.value.length>1?b.value[b.value.length-1].length>0?E.value=b.value.length-1:E.value=b.value.length-2:E.value=0}catch(a){}};o(()=>j.modelValue,(e,a)=>{e&&x()},{immediate:!0,deep:!0});const B=e=>j.modelValue.includes(e),O=s(()=>{let e=[];return b.value.forEach((a,l)=>{if(a.length>0){let s=!1;a.forEach(a=>{B(a.regionId)&&(e[l]=a.regionName,s=!0)}),0==s&&(e[l]=N("请选择地区"))}}),e});return(e,a)=>{const l=c,s=V,t=i(d("tig-popup"),I);return r(),u(t,{show:R.value,"onUpdate:show":a[0]||(a[0]=e=>R.value=e),position:"bottom"},{default:n(()=>[g(l,{class:"select-region-main"},{default:n(()=>[g(l,{class:"popup-title"},{default:n(()=>[m(p(e.$t("选择地区")),1)]),_:1}),g(l,{class:"content"},{default:n(()=>[g(l,{class:"region-menu"},{default:n(()=>[(r(!0),h(f,null,v(O.value,(a,s)=>(r(),u(l,{key:s,class:y(["region-menu-item",{active:E.value===s}]),onClick:e=>E.value=s},{default:n(()=>[m(p(a||e.$t("请选择")),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}),(r(!0),h(f,null,v(b.value,(e,a)=>(r(),h(f,{key:a},[E.value===a?(r(),u(s,{key:0,"scroll-y":"true",class:"region-list"},{default:n(()=>[(r(!0),h(f,null,v(e,e=>(r(),u(l,{key:e.regionId,class:y(["region-list-item",{active:B(e.regionId)}]),onClick:w(l=>(async(e,a)=>{e>=0&&e<=j.modelValue.length&&(j.modelValue[e]=a,j.modelValue.splice(e+1)),await x(),b.value.length==e+1||0==b.value[e+1].length?(C("update:modelValue",j.modelValue),C("update:show",!1),C("sendRegionNames",O.value)):E.value=e+1})(a,e.regionId),["stop"])},{default:n(()=>[m(p(e.regionName),1)]),_:2},1032,["class","onClick"]))),128))]),_:2},1024)):_("",!0)],64))),128))]),_:1})]),_:1})]),_:1},8,["show"])}}}),[["__scopeId","data-v-99998d04"]]);export{N as s};
