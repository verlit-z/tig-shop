import{d as e,K as a,r as l,U as t,aM as s,B as u,E as o,c,o as n,i as r,w as i,g as d,I as p,O as m,h as f,f as v,t as _,J as y,a2 as b,a9 as g,aa as h,n as $,_ as k,k as x,a as V,V as C,Q as j,l as I,q as w}from"./index-DE5OqlOG.js";import{e as A,d as M,_ as O}from"./tig-layout.fowSnIDi.js";import{_ as U}from"./tig-image.h_tgFjnN.js";import{_ as q}from"./format-price.Cc34639m.js";import{_ as N}from"./loading-box.Cxf-hKGE.js";import{a as P}from"./order.Yb7sr44P.js";import{_ as S}from"./uni-easyinput.Cpml7ZWU.js";import{_ as B,a as z}from"./uni-forms.DRg_j8ip.js";import{_ as D}from"./tig-fixed-placeholder.OF5rBWLr.js";import{g as J,u as L,c as R}from"./invoiceManagemen.BS2rG0JA.js";import"./uni-icons.BITEJ68A.js";const T=k(e({__name:"invoiceList",setup(e,{expose:k}){const{t:x}=a(),V=l([]),C=t({page:1,size:10,orderStatus:5}),j=l(!1),I=l(0),w=async()=>{C.page>1?j.value=!0:g({title:x("加载中")});try{const e=await P(C);V.value=[...V.value,...e.records],I.value=e.total}catch(e){console.error(e)}finally{h(),j.value=!1}},M=e=>{switch(e){case 0:return x("待审核");case 1:return x("通过");default:return x("失败/作废")}};return s(()=>{w()}),k({__getOrderList:w,filterParams:C,total:I}),(e,a)=>{const l=f,t=r,s=u(o("tig-image"),U),g=u(o("format-price"),q),h=b,k=u(o("tig-button"),A),x=u(o("loading-box"),N);return n(),c(t,{class:""},{default:i(()=>[d(t,{class:"invoice-list"},{default:i(()=>[(n(!0),p(y,null,m(V.value,a=>(n(),c(t,{key:a.orderId,class:"invoice-list-item"},{default:i(()=>[d(t,{class:"invoice-list-item-header"},{default:i(()=>[d(l,{class:"special-text"},{default:i(()=>[v(_(e.$t("订单编号"))+"：",1),d(l,{class:"special-color"},{default:i(()=>[v(_(a.orderSn),1)]),_:2},1024)]),_:2},1024),a.invoiceData?(n(),c(l,{key:0},{default:i(()=>[v(_(M(a.invoiceData.status)),1)]),_:2},1024)):(n(),c(l,{key:1},{default:i(()=>[v(_(e.$t("可申请")),1)]),_:1}))]),_:2},1024),d(t,{class:"invoice-list-item-content"},{default:i(()=>[d(t,{class:"item-content-product"},{default:i(()=>[(n(!0),p(y,null,m(a.items,e=>(n(),c(h,{key:e.itemId,url:"/pages/product/index?id="+e.productId,"hover-class":"navigator-hover"},{default:i(()=>[d(t,{class:"item-content-product-item"},{default:i(()=>[d(t,{class:"item-content-product-img"},{default:i(()=>[d(s,{src:e.picThumb},null,8,["src"])]),_:2},1024),d(t,{class:"item-content-product-info"},{default:i(()=>[d(t,{class:"product-item-title"},{default:i(()=>[v(_(e.productName),1)]),_:2},1024),d(t,{class:"product-item-price"},{default:i(()=>[d(g,{"show-text":!1,"decimals-style":{fontSize:"25rpx"},"currency-style":{fontSize:"23rpx"},class:"product-item-pricenum","price-data":e.price},null,8,["price-data"]),d(t,{class:"product-item-quantity"},{default:i(()=>[v("x "+_(e.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["url"]))),128))]),_:2},1024),d(t,{class:"item-content-pay"},{default:i(()=>[d(t,{class:"item-content-pay-box"},{default:i(()=>[d(t,{class:"pay-item total-money"},{default:i(()=>[v(_(e.$t("总额"))+"：",1),d(g,{"show-text":!1,"is-bottom":!1,"price-data":a.totalAmount},null,8,["price-data"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),d(t,{class:"invoice-list-item-btn"},{default:i(()=>[d(t,{class:"item-btn-box"},{default:i(()=>[a.invoiceData?(n(),c(k,{key:0,"custom-style":{width:"150rpx",height:"60rpx"},plain:!0,"plain-main-color":!0,onClick:e=>((e,a)=>{e.orderSn=a;const l=encodeURIComponent(JSON.stringify(e));$({url:"/pages/user/invoiceManagement/invoiceInfo?invoiceData="+l})})(a.invoiceData,a.orderSn)},{default:i(()=>[v(_(e.$t("查看")),1)]),_:2},1032,["onClick"])):(n(),c(k,{key:1,plain:!0,"custom-style":{width:"150rpx",height:"60rpx"},"plain-main-color":!0,onClick:e=>{return l=a.orderId,void $({url:`/pages/user/invoiceManagement/applyInvoice?orderId=${l}`});var l}},{default:i(()=>[v(_(e.$t("申请")),1)]),_:2},1032,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),d(x,{modelValue:j.value,"onUpdate:modelValue":a[0]||(a[0]=e=>j.value=e),page:C.page,length:V.value.length},null,8,["modelValue","page","length"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-ee377ce2"]]),E=k(e({__name:"certification",setup(e){const{t:t}=a(),m=l({}),b={companyName:{rules:[{required:!0,errorMessage:t("单位名称不能为空!")}]},companyCode:{rules:[{required:!0,errorMessage:t("纳税人识别码不能为空!")}]},companyAddress:{rules:[{required:!0,errorMessage:t("注册地址不能为空!")}]},companyPhone:{rules:[{required:!0,errorMessage:t("注册电话不能为空!")}]},companyBank:{rules:[{required:!0,errorMessage:t("开户银行不能为空!")}]},companyAccount:{rules:[{required:!0,errorMessage:t("银行账户不能为空!")}]}},g=l(!1),h=l(!1),$=l({}),k=async()=>{try{const e=await J();Object.assign(m.value,e)}catch(e){}};s(()=>{k()});const I=()=>{$.value=JSON.parse(JSON.stringify(m.value)),h.value=!0},w=x(()=>{switch(m.value.status){case 0:return t("未申请专用发票");case 1:return t("审核通过");case 2:return t("已申请，待审核");case 3:return t("审核未通过");default:return""}}),O=l(),U=()=>{O.value.validate().then(e=>{if(!g.value)return j({title:t("需要确认勾选才能继续"),icon:"none"});q()}).catch(e=>{console.log("表单错误信息：",e)})},q=async()=>{try{$.value.isConfirm=g.value?1:0,$.value.titleType=2,$.value.invoiceType=1,$.value.isAdd=0==$.value.status?1:0,$.value.invoiceId?await L({id:$.value.invoiceId,...$.value}):await R($.value),j({title:t("提交成功"),icon:"none"}),k(),h.value=!1}catch(e){}},N=()=>{};return(e,a)=>{const l=r,t=f,s=u(o("uni-easyinput"),S),k=u(o("uni-forms-item"),B),x=u(o("uni-forms"),z),j=u(o("tig-checkbox"),M),q=u(o("tig-button"),A),P=u(o("tig-fixed-placeholder"),D);return Object.keys(m.value).length>0?(n(),c(l,{key:0,class:"certification safe-padding"},{default:i(()=>[d(l,{class:"tip-box"},{default:i(()=>[d(l,{class:"tig-title"},{default:i(()=>[v(_(e.$t("温馨提示")),1)]),_:1}),d(l,null,{default:i(()=>[v(_(e.$t("首次开具增值税专用发票"))+"，"+_(e.$t("请添加资质后并提交"))+"。",1)]),_:1}),d(l,null,{default:i(()=>[v(_(e.$t("我们会在一个工作日内完成审核工作"))+"。",1)]),_:1}),d(l,null,{default:i(()=>[v(" 1."+_(e.$t("补发流程"))+"： ",1),d(t,{class:"specaial-text"},{default:i(()=>[v(_(e.$t("资质未审核通过"))+"-"+_(e.$t("登录会员中心"))+"->"+_(e.$t("增票资质"))+"->"+_(e.$t("填写资质信息"))+"->"+_(e.$t("提交"))+"。",1)]),_:1})]),_:1}),d(l,null,{default:i(()=>[v(" 2. "+_(e.$t("资质审核结果查询时间"))+"：",1),d(t,{class:"specaial-text"},{default:i(()=>[v(_(e.$t("资质上传一到两个工作日后即可查询"))+"。",1)]),_:1})]),_:1}),d(l,null,{default:i(()=>[v(" 3. "+_(e.$t("注意有效增值税专用发票开票资质仅为一个"))+"。",1)]),_:1})]),_:1}),d(l,{class:"status-box"},{default:i(()=>[d(l,{class:"status-text"},{default:i(()=>[d(l,null,{default:i(()=>[v(_(e.$t("您的增票资质状态"))+"：",1)]),_:1}),d(l,{class:"specaial-text"},{default:i(()=>[v(_(w.value),1)]),_:1})]),_:1})]),_:1}),d(l,{class:"certification-content"},{default:i(()=>[h.value?(n(),c(l,{key:0,class:"content-title"},{default:i(()=>[v(_(e.$t("填写增票资质信息")),1),d(t,{class:"specaial-text"},{default:i(()=>[v("（"+_(e.$t("所有信息均为必填"))+"）",1)]),_:1})]),_:1})):!h.value&&Object.keys(m.value).length>0?(n(),c(l,{key:1,class:"content-title"},{default:i(()=>[v(_(e.$t("增票资质信息")),1)]),_:1})):V("",!0),d(l,null,{default:i(()=>[h.value?(n(),p(y,{key:0},[d(x,{ref_key:"formRef",ref:O,"model-value":$.value,rules:b,"label-width":"180rpx"},{default:i(()=>[d(k,{label:e.$t("单位名称"),name:"companyName"},{default:i(()=>[d(s,{modelValue:$.value.companyName,"onUpdate:modelValue":a[0]||(a[0]=e=>$.value.companyName=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入单位名称")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(k,{label:e.$t("纳税人识别码"),name:"companyCode"},{default:i(()=>[d(s,{modelValue:$.value.companyCode,"onUpdate:modelValue":a[1]||(a[1]=e=>$.value.companyCode=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入纳税人识别码")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(k,{label:e.$t("注册地址"),name:"companyAddress"},{default:i(()=>[d(s,{modelValue:$.value.companyAddress,"onUpdate:modelValue":a[2]||(a[2]=e=>$.value.companyAddress=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入注册地址")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(k,{label:e.$t("注册电话"),name:"companyPhone"},{default:i(()=>[d(s,{modelValue:$.value.companyPhone,"onUpdate:modelValue":a[3]||(a[3]=e=>$.value.companyPhone=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入注册电话")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(k,{label:"开户银行",name:"companyBank"},{default:i(()=>[d(s,{modelValue:$.value.companyBank,"onUpdate:modelValue":a[4]||(a[4]=e=>$.value.companyBank=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入开户银行")},null,8,["modelValue","placeholder"])]),_:1}),d(k,{label:e.$t("开户银行"),name:"companyAccount"},{default:i(()=>[d(s,{modelValue:$.value.companyAccount,"onUpdate:modelValue":a[5]||(a[5]=e=>$.value.companyAccount=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入银行账户")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model-value"]),d(l,{class:"agreement-box"},{default:i(()=>[d(j,{checked:g.value,"onUpdate:checked":a[6]||(a[6]=e=>g.value=e),"checked-size":.7},null,8,["checked"]),v(" "+_(e.$t("我已阅读并同意")),1),d(t,{class:"specaial-text",onClick:N},{default:i(()=>[v("《"+_(e.$t("增票资质确认书"))+"》",1)]),_:1})]),_:1})],64)):V("",!0),0!==m.value.status||h.value?!h.value&&Object.keys(m.value).length>0?(n(),c(x,{key:2,ref_key:"formRef",ref:O,class:C({readonly:!h.value}),"model-value":m.value,rules:b,"label-width":"180rpx"},{default:i(()=>[d(k,{label:e.$t("单位名称")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[v(_(m.value.companyName),1)]),_:1})]),_:1},8,["label"]),d(k,{label:e.$t("纳税人识别码")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[v(_(m.value.companyCode),1)]),_:1})]),_:1},8,["label"]),d(k,{label:e.$t("注册地址")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[v(_(m.value.companyAddress),1)]),_:1})]),_:1},8,["label"]),d(k,{label:e.$t("注册电话")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[v(_(m.value.companyPhone),1)]),_:1})]),_:1},8,["label"]),d(k,{label:e.$t("开户银行")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[v(_(m.value.companyBank),1)]),_:1})]),_:1},8,["label"]),d(k,{label:e.$t("银行账户")},{default:i(()=>[d(l,{class:"disabled-text"},{default:i(()=>[v(_(m.value.companyAccount),1)]),_:1})]),_:1},8,["label"])]),_:1},8,["class","model-value"])):V("",!0):(n(),c(l,{key:1,class:"empty-text"},{default:i(()=>[v(_(e.$t("暂无增票资质信息"))+"!",1)]),_:1}))]),_:1})]),_:1}),h.value?(n(),c(P,{key:0,"background-color":"#fff"},{default:i(()=>[d(l,{class:"btn-box"},{default:i(()=>[d(q,{class:"btn",plain:"",onClick:a[7]||(a[7]=e=>h.value=!1)},{default:i(()=>[v(_(e.$t("取消")),1)]),_:1}),d(q,{class:"btn",onClick:U},{default:i(()=>[v(_(e.$t("提交")),1)]),_:1})]),_:1})]),_:1})):(n(),c(P,{key:1,"background-color":"#fff"},{default:i(()=>[d(l,{class:"btn-box"},{default:i(()=>[d(q,{onClick:I},{default:i(()=>[v(_(0===m.value.status?e.$t("添加增票资质"):e.$t("修改并重新审核")),1)]),_:1})]),_:1})]),_:1}))]),_:1})):V("",!0)}}}),[["__scopeId","data-v-9edc59da"]]),F=k(e({__name:"index",setup(e){const a=[{type:"list",value:"发票申请"},{type:"invoice",value:"增票资质"}],t=l(),s=l("list");return I(e=>{e&&e.type&&(s.value=e.type)}),w(()=>{"list"===s.value&&t.value.filterParams.page<Math.ceil(t.value.total/t.value.filterParams.size)&&(t.value.filterParams.page++,t.value.__getOrderList())}),(e,l)=>{const b=f,g=r,h=u(o("tig-layout"),O);return n(),c(h,{title:"发票管理"},{default:i(()=>[d(g,{class:"invoice-management"},{default:i(()=>[d(g,{class:"invoice-menu"},{default:i(()=>[(n(),p(y,null,m(a,a=>d(g,{key:a.type,class:C(["invoice-menu-item",{active:s.value===a.type}]),onClick:e=>{return l=a.type,void(s.value=l);var l}},{default:i(()=>[d(b,{class:"invoice-menu-item-text"},{default:i(()=>[v(_(e.$t(a.value)),1)]),_:2},1024)]),_:2},1032,["class","onClick"])),64))]),_:1}),d(g,{class:"placeholder"}),d(g,{class:"invoice-content"},{default:i(()=>["list"===s.value?(n(),c(T,{key:0,ref_key:"invoiceListRef",ref:t},null,512)):V("",!0),"invoice"===s.value?(n(),c(E,{key:1})):V("",!0)]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-2b414249"]]);export{F as default};
