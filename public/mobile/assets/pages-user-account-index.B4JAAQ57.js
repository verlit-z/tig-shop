import{d as a,K as e,a1 as t,r as l,U as u,q as c,B as o,E as s,I as n,o as r,c as d,a as i,g as p,i as v,w as m,J as f,O as y,f as b,t as _,h as g,b as h,F as k,G as x,a9 as T,aa as $,_ as N,bF as D,ba as w,V,Q as C,n as I,a4 as z,k as j,s as U,af as S,az as M,bj as W,bG as E,b7 as B,bH as F,a2 as G,l as O,bI as R,W as q,X as H}from"./index-DE5OqlOG.js";import{_ as J}from"./format-price.Cc34639m.js";import{e as K,_ as L}from"./tig-layout.fowSnIDi.js";import{_ as Q}from"./loading-box.Cxf-hKGE.js";import{g as X,a as A,b as P,u as Y,c as Z,d as aa}from"./account.2c1rkbIz.js";import{_ as ea}from"./tig-fixed-placeholder.OF5rBWLr.js";const ta=N(a({__name:"detail",props:{activeTab:{},activeTabModifiers:{}},emits:["update:activeTab"],setup(a){const{t:N}=e(),D=t(a,"activeTab"),w=l(0),V=l(!1),C=l(!1),I=u({page:1,size:10,status:1}),z=l([]),j=async()=>{I.page>1?V.value=!0:T({title:N("加载中")});try{const a=await X({...I});w.value=a.total,z.value=[...z.value,...a.records]}catch(a){console.error(a)}finally{$(),V.value=!1,C.value=!0}};return j(),c(()=>{D.value&&"detail"===D.value&&I.page<Math.ceil(w.value/I.size)&&(I.page++,j())}),(a,e)=>{const t=v,l=g,u=h,c=o(s("loading-box"),Q);return r(),n(f,null,[z.value.length>0?(r(),d(t,{key:0,class:"log-main"},{default:m(()=>[(r(!0),n(f,null,y(z.value,(a,e)=>(r(),d(t,{key:e,class:"item"},{default:m(()=>[p(t,{class:"tit"},{default:m(()=>[b(_(a.changeTypeName),1)]),_:2},1024),p(t,{class:"time"},{default:m(()=>[b(_(a.changeTime),1)]),_:2},1024),p(t,{class:"desc"},{default:m(()=>[b(_(a.changeDesc),1)]),_:2},1024),p(t,{class:"real_total"},{default:m(()=>["增加"===a.changeTypeName?(r(),d(l,{key:0},{default:m(()=>[b("+")]),_:1})):(r(),d(l,{key:1},{default:m(()=>[b("-")]),_:1})),p(l,null,{default:m(()=>[b(_(a.balance),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):i("",!0),0===z.value.length&&!0===C.value?(r(),d(t,{key:1,class:"empty-box"},{default:m(()=>[p(t,{class:"pictrue"},{default:m(()=>[p(u,{src:k(x)("common/data_empty.png")},null,8,["src"])]),_:1}),p(t,{class:"txt"},{default:m(()=>[b(_(a.$t("暂无数据")),1)]),_:1})]),_:1})):i("",!0),p(c,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=a=>V.value=a),page:I.page,length:z.value.length},null,8,["modelValue","page","length"])],64)}}}),[["__scopeId","data-v-125423cf"]]),la=N(a({__name:"log",props:{activeTab:{},activeTabModifiers:{}},emits:["update:activeTab"],setup(a){const{t:g}=e(),N=t(a,"activeTab"),D=l(0),w=l(!1),V=l(!1),C=u({page:1,size:10}),I=l([]),z=async()=>{C.page>1?w.value=!0:T({title:g("加载中")});try{const a=await A({...C});D.value=a.total,I.value=[...I.value,...a.records]}catch(a){console.error(a)}finally{$(),w.value=!1,V.value=!0}};return z(),c(()=>{N.value&&"log"===N.value&&C.page<Math.ceil(D.value/C.size)&&(C.page++,z())}),(a,e)=>{const t=v,l=o(s("format-price"),J),u=h,c=o(s("loading-box"),Q);return r(),n(f,null,[I.value.length>0?(r(),d(t,{key:0,class:"log-main"},{default:m(()=>[(r(!0),n(f,null,y(I.value,(e,u)=>(r(),d(t,{key:u,class:"item"},{default:m(()=>[p(t,{class:"tit"},{default:m(()=>[b(_(e.type),1)]),_:2},1024),p(t,{class:"time"},{default:m(()=>[b(_(e.addTime),1)]),_:2},1024),p(t,{class:"real_total"},{default:m(()=>[p(l,{"show-text":!1,"decimals-style":{fontSize:"25rpx",fontWeight:"bold"},"currency-style":{fontSize:"23rpx",fontWeight:"bold"},"price-data":e.amount},null,8,["price-data"])]),_:2},1024),p(t,{class:"actions"},{default:m(()=>[p(t,{class:"txt"},{default:m(()=>[b(_(a.$t("管理员备注"))+"："+_(e.postscript||a.$t("无")),1)]),_:2},1024),p(t,{class:"status"},{default:m(()=>[b(_(e.statusType),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):i("",!0),0===I.value.length&&!0===V.value?(r(),d(t,{key:1,class:"empty-box"},{default:m(()=>[p(t,{class:"pictrue"},{default:m(()=>[p(u,{src:k(x)("common/data_empty.png")},null,8,["src"])]),_:1}),p(t,{class:"txt"},{default:m(()=>[b(_(a.$t("暂无数据"))+"！",1)]),_:1})]),_:1})):i("",!0),p(c,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=a=>w.value=a),page:C.page,length:I.value.length},null,8,["modelValue","page","length"])],64)}}}),[["__scopeId","data-v-6459bed6"]]),ua=N(a({__name:"deposit",emits:["backDetail"],setup(a,{emit:t}){const{t:u}=e(),c=l([]);D(()=>{(async()=>{T({title:u("加载中")});try{const a=await P();c.value=a;let e={rechargeId:0};c.value.push(e),c.value.forEach(a=>{a.selected=!1})}catch(a){console.log(a.message)}finally{$()}})()});const g=l(!1),h=a=>{g.value=5===a,c.value.forEach((e,t)=>{e.selected=t===a})},k=l({id:0,amount:0,money:"",payType:"recharge"}),x=()=>{let a=!1;if(c.value.forEach((e,t)=>{e.selected&&(a=!0,k.value.id=e.rechargeId,0!=e.rechargeId?(k.value.amount=null,k.value.money=e.money):k.value.money=k.value.amount)}),!k.value.money)return C({title:u("请输入充值金额"),icon:"none"});a?N(k.value):C({title:u("请选择充值金额"),icon:"none"})},N=async a=>{try{const e=await Y(a);I({url:`/pages/order/pay?orderId=${e.orderId}&type=recharge`})}catch(e){C({title:e.message,icon:"none",duration:1e3})}},z=t,j=()=>{z("backDetail")};return(a,e)=>{const t=o(s("format-price"),J),l=v,u=o(s("up-input"),w),g=o(s("tig-button"),K),T=o(s("tig-fixed-placeholder"),ea);return r(),n(f,null,[p(l,{class:"recharge-box"},{default:m(()=>[c.value.length>0?(r(),d(l,{key:0,class:"recharge-wrap"},{default:m(()=>[(r(!0),n(f,null,y(c.value,(c,o)=>(r(),n(f,{key:o},[0!=c.rechargeId?(r(),d(l,{key:0,class:V(["recharge-item",{selected:c.selected}]),onClick:a=>h(o)},{default:m(()=>[p(l,{class:"recharge-amount"},{default:m(()=>[p(t,{"show-text":!1,"price-data":c.money,"decimals-style":{fontSize:"25rpx"},"currency-style":{fontSize:"23rpx"}},null,8,["price-data"])]),_:2},1024),Number(c.discountMoney)>0?(r(),d(l,{key:0,class:"recharge-give"},{default:m(()=>[b(_(a.$t("赠送"))+" ",1),p(t,{"show-text":!1,"price-data":c.discountMoney,"is-bottom":!1,"font-style":{fontSize:"11px"}},null,8,["price-data"])]),_:2},1024)):i("",!0)]),_:2},1032,["class","onClick"])):(r(),d(l,{key:1,class:V(["recharge-item",{selected:c.selected}]),onClick:a=>h(o)},{default:m(()=>[p(l,{class:"recharge-amount"},{default:m(()=>[c.selected?(r(),d(u,{key:0,modelValue:k.value.amount,"onUpdate:modelValue":e[0]||(e[0]=a=>k.value.amount=a),type:"digit",color:"var(--color)","input-align":"center",border:"none"},null,8,["modelValue"])):(r(),d(l,{key:1,style:{height:"42rpx"}}))]),_:2},1024),p(l,{class:"recharge-give"},{default:m(()=>[b(_(a.$t("自定义金额")),1)]),_:1})]),_:2},1032,["class","onClick"]))],64))),128))]),_:1})):i("",!0)]),_:1}),p(T,{"background-color":"#fff"},{default:m(()=>[p(l,{class:"btn-box"},{default:m(()=>[p(g,{class:"btn",plain:"",onClick:j},{default:m(()=>[b(_(a.$t("取消充值")),1)]),_:1}),p(g,{class:"btn",onClick:x},{default:m(()=>[b(_(a.$t("提交申请")),1)]),_:1})]),_:1})]),_:1})],64)}}}),[["__scopeId","data-v-eba84b11"]]),ca=N(a({__name:"raplyToCard",props:{balance:{type:[Number,String],default:0}},emits:["backDetail"],setup(a,{emit:t}){const{t:u}=e(),c=[{title:"银行卡",accountType:1},{title:"支付宝",accountType:2},{title:"微信",accountType:3}],g=z(),h=l(1),k=()=>{N.value={id:"",text:u("请选择")},Q.value={accountData:{accountNo:"",accountName:"",accountType:h.value,bankName:""},amount:""}},x=l(!1),N=l({id:"",text:u("请选择")}),I=()=>{x.value=!1},O=a=>{x.value=!1,N.value.id=a.value[0].id,N.value.text=a.value[0].text,R(a.value[0].id)},R=a=>{let e=(1===Q.value.accountData.accountType?q:2===Q.value.accountData.accountType?H:J).value[0].find(e=>e.accountId===a);Q.value.accountData.accountNo=null==e?void 0:e.accountNo,Q.value.accountData.accountName=null==e?void 0:e.accountName,Q.value.accountData.bankName=null==e?void 0:e.bankName},q=l([]),H=l([]),J=l([]),L=async a=>{T({title:u("加载中")});try{let e={accountType:a};const t=await Z({...e});let l=[];1==a?(l=t.records.map(a=>({id:a.accountId,text:a.accountNo,...a})),q.value.push(l)):2===a?(l=t.records.map(a=>({id:a.accountId,text:a.accountNo,...a})),H.value.push(l)):(l=t.records.map(a=>({id:a.accountId,text:a.accountNo,...a})),J.value.push(l))}catch(e){console.error(e.message)}finally{$()}};D(()=>{L(h.value)});const Q=l({accountData:{accountNo:"",accountName:"",accountType:1,bankName:""},amount:""}),X=j(()=>{switch(Q.value.accountData.accountType){case 1:return u("银行卡");case 2:return u("支付宝");case 3:return u("微信");default:return""}}),A=j(()=>{switch(Q.value.accountData.accountType){case 1:return q.value;case 2:return H.value;case 3:return J.value;default:return[]}}),P={amount:{validator:(a,e,t)=>(0==e&&uni.$u.toast(u("提现金额必须大于0")),e>0),message:u("请输入提现金额"),trigger:["blur"]}};U(()=>{S(()=>{g.value.setRules(P)})});const Y=async()=>{0!==N.value.id.length?g.value.validate().then(async a=>{if(a)try{await aa({...Q.value});C({title:u("操作成功"),icon:"success",duration:1e3}),setTimeout(()=>{la()},1500)}catch(e){console.error(e),uni.$u.toast(e.message)}}).catch(()=>{}):C({title:u("请选择需要提现的账号"),icon:"none",duration:1e3})},ta=t,la=()=>{ta("backDetail")};return(a,e)=>{const t=v,l=o(s("up-picker"),M),u=o(s("up-button"),W),T=o(s("up-form-item"),E),$=G,D=o(s("up-input"),w),C=o(s("up-textarea"),B),z=o(s("up-form"),F),j=o(s("tig-button"),K),U=o(s("tig-fixed-placeholder"),ea);return r(),n(f,null,[p(t,{class:"custom-tabs"},{default:m(()=>[(r(),n(f,null,y(c,(e,l)=>p(t,{key:l,class:V([{"active-tab":h.value===e.accountType},"tab"]),onClick:a=>(async a=>{a!==h.value&&(h.value=a,Q.value.accountData.accountType=a,q.value=[],H.value=[],J.value=[],k(),L(a))})(e.accountType)},{default:m(()=>[p(t,null,{default:m(()=>[b(_(a.$t(e.title)),1)]),_:2},1024)]),_:2},1032,["class","onClick"])),64))]),_:1}),p(t,{class:"reply-main"},{default:m(()=>[p(t,{class:"reply-content"},{default:m(()=>[p(z,{ref_key:"formRef",ref:g,model:Q.value,"label-width":"170rpx","error-type":"toast"},{default:m(()=>[p(T,{label:a.$t("提现至")},{default:m(()=>[p(l,{show:x.value,columns:A.value,"key-name":"text",onConfirm:O,onCancel:I},null,8,["show","columns"]),p(u,{style:{"justify-content":"flex-start"},onClick:e[0]||(e[0]=a=>x.value=!0)},{default:m(()=>[b(_(N.value.text),1)]),_:1})]),_:1},8,["label"]),p(t,{class:"tips"},{default:m(()=>[b(_(a.$t("当前"))+_(X.value)+_(a.$t("账号已不用"))+"？",1),p($,{url:"/pages/user/account/cardManagement/list",class:"font-color"},{default:m(()=>[b(_(a.$t("点击这里")),1)]),_:1}),b(_(a.$t("去添加新的"))+_(X.value)+_(a.$t("账号"))+"。",1)]),_:1}),p(T,{label:a.$t("提现姓名"),prop:"accountData.accountName"},{default:m(()=>[p(D,{modelValue:Q.value.accountData.accountName,"onUpdate:modelValue":e[1]||(e[1]=a=>Q.value.accountData.accountName=a),placeholder:`请选择${X.value}账号`,disabled:"","font-size":"12"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),1===Q.value.accountData.accountType?(r(),d(T,{key:0,label:a.$t("银行详情"),prop:"accountData.bankName"},{default:m(()=>[p(C,{modelValue:Q.value.accountData.bankName,"onUpdate:modelValue":e[2]||(e[2]=a=>Q.value.accountData.bankName=a),placeholder:a.$t("请选择银行卡账号"),disabled:"","font-size":"12"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):i("",!0),p(T,{label:a.$t("提现金额"),prop:"amount"},{default:m(()=>[p(D,{modelValue:Q.value.amount,"onUpdate:modelValue":e[3]||(e[3]=a=>Q.value.amount=a),type:"number",placeholder:a.$t("请输入提现金额"),clearable:"","font-size":"12"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1})]),_:1}),p(U,{"background-color":"#fff"},{default:m(()=>[p(t,{class:"btn-box"},{default:m(()=>[p(j,{class:"btn",plain:"",onClick:la},{default:m(()=>[b(_(a.$t("返回列表")),1)]),_:1}),p(j,{class:"btn",onClick:Y},{default:m(()=>[b(_(a.$t("提交申请")),1)]),_:1})]),_:1})]),_:1})],64)}}}),[["__scopeId","data-v-e88d535d"]]),oa=N(a({__name:"index",setup(a){const e=l({}),t=[{title:"账户明细",action:"detail"},{title:"申请记录",action:"log"}],u=l("detail"),c=a=>{a!==u.value&&(u.value=a)},g=()=>{u.value="detail"};return O(()=>{(async()=>{try{const a=await R();Object.assign(e.value,a)}catch(a){console.error(a.message)}})()}),(a,l)=>{const h=v,k=o(s("format-price"),J),x=o(s("tig-layout"),L);return r(),d(x,{title:"资金管理"},{default:m(()=>[p(h,{class:"top-card"},{default:m(()=>[p(h,{class:"balance-row"},{default:m(()=>[b(_(a.$t("可用余额")),1)]),_:1}),p(h,{class:"amount-row"},{default:m(()=>[p(k,{"show-text":!1,"price-data":e.value.balance,"decimals-style":{fontSize:"40rpx",fontWeight:"bold"},"currency-style":{fontSize:"38rpx",fontWeight:"bold"}},null,8,["price-data"])]),_:1}),p(h,{class:"button-row"},{default:m(()=>[p(h,{class:V(["round-button",{active:"deposit"===u.value}]),onClick:l[0]||(l[0]=a=>c("deposit"))},{default:m(()=>[b(_(a.$t("充值")),1)]),_:1},8,["class"]),p(h,{class:V(["round-button",{active:"raplytocard"===u.value}]),onClick:l[1]||(l[1]=a=>c("raplytocard"))},{default:m(()=>[b(_(a.$t("提现")),1)]),_:1},8,["class"])]),_:1})]),_:1}),"detail"===u.value||"log"===u.value?(r(),d(h,{key:0,class:"custom-tabs"},{default:m(()=>[(r(),n(f,null,y(t,(e,t)=>p(h,{key:t,class:V([{"active-tab":u.value===e.action},"tab"]),onClick:a=>c(e.action)},{default:m(()=>[p(h,null,{default:m(()=>[b(_(a.$t(e.title)),1)]),_:2},1024)]),_:2},1032,["class","onClick"])),64))]),_:1})):i("",!0),q(p(h,null,{default:m(()=>[p(ta,{"active-tab":u.value,"onUpdate:activeTab":l[2]||(l[2]=a=>u.value=a)},null,8,["active-tab"])]),_:1},512),[[H,"detail"===u.value]]),q(p(h,null,{default:m(()=>[p(la,{"active-tab":u.value,"onUpdate:activeTab":l[3]||(l[3]=a=>u.value=a)},null,8,["active-tab"])]),_:1},512),[[H,"log"===u.value]]),"deposit"===u.value?(r(),d(ua,{key:1,onBackDetail:g})):i("",!0),"raplytocard"===u.value?(r(),d(ca,{key:2,balance:e.value.balance,onBackDetail:g},null,8,["balance"])):i("",!0)]),_:1})}}}),[["__scopeId","data-v-e1e77ebb"]]);export{oa as default};
