import{d as e,K as a,r as l,U as o,s as r,af as s,l as t,I as n,g as i,w as u,J as d,B as m,E as c,aq as p,o as f,i as g,f as b,t as h,Q as v,ap as _,ar as V,_ as y}from"./index-DE5OqlOG.js";import{_ as $}from"./uni-easyinput.Cpml7ZWU.js";import{_ as j,a as w}from"./uni-forms.DRg_j8ip.js";import{_ as U,e as q}from"./tig-layout.fowSnIDi.js";import{_ as N}from"./tig-fixed-placeholder.OF5rBWLr.js";import{s as x}from"./selectRegion.DbznQmKa.js";import{a as I,b as D,u as R}from"./address.Dw0Z0wUY.js";import"./uni-icons.BITEJ68A.js";const k=y(e({__name:"editRegion",setup(e){const{t:y}=a(),k=l("添加地址"),M=l(null),C=o({consignee:"",regionIds:[],address:"",mobile:"",telephone:"",email:"",regionNames:"",isDefault:0}),F=l(!1),T={consignee:{rules:[{required:!0,errorMessage:y("请您填写收货人姓名")}]},regionNames:{rules:[{required:!0,errorMessage:y("请选择所在地区")},{validateFunction:function(e,a,l,o){return C.regionIds.length<1&&o(y("请选择所在地区")),!0}}]},address:{rules:[{required:!0,errorMessage:y("请您填写详细收货地址")}]},mobile:{rules:[{required:!0,errorMessage:y("请您填写收货人手机号码")},{validateFunction:function(e,a,l,o){return/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(a)||o(y("请输入正确的手机号码")),!0}}]}};r(()=>{s(()=>{Q.value.setRules(T)})}),t(e=>{e&&e.id&&(k.value="编辑地址",M.value=e.id,B())});const B=async()=>{try{const e=await I({id:M.value}),{regionNames:a}=e;Object.assign(C,e),C.regionNames=a.join(" "),F.value=1===C.isDefault}catch(e){console.error(e)}},E=e=>{C.regionNames=e.join(" ")},J=l(!1),K=()=>{J.value=!0},O=l(!1),Q=l(),S=()=>{Q.value.validate().then(()=>{C.isDefault=F.value?1:0,M.value?A():z()}).catch(e=>{console.log("表单错误信息：",e)})},z=async()=>{O.value=!0;try{await D(C),v({title:y("添加地址成功"),icon:"none",duration:1e3}),setTimeout(()=>{_({success:function(e){V("refreshData"),O.value=!1}})},1e3)}catch(e){console.error(e),v({title:e.message,icon:"none",duration:1e3}),O.value=!1}},A=async()=>{O.value=!0;try{await R({id:M.value,...C}),v({title:y("编辑地址成功"),icon:"none",duration:1e3}),setTimeout(()=>{_({success:function(e){V("refreshData"),O.value=!1}})},1e3)}catch(e){console.error(e),v({title:e.message,icon:"none",duration:1e3})}};return(e,a)=>{const l=m(c("uni-easyinput"),$),o=m(c("uni-forms-item"),j),r=g,s=m(c("u-switch"),p),t=m(c("uni-forms"),w),v=m(c("tig-button"),q),_=m(c("tig-fixed-placeholder"),N),V=m(c("tig-layout"),U);return f(),n(d,null,[i(V,{title:k.value},{default:u(()=>[i(r,{class:"address-edit-main"},{default:u(()=>[i(r,{class:"address-edit-content"},{default:u(()=>[i(t,{ref_key:"formRef",ref:Q,"model-value":C,"label-width":"165rpx"},{default:u(()=>[i(o,{label:e.$t("收货人："),name:"consignee",required:""},{default:u(()=>[i(l,{modelValue:C.consignee,"onUpdate:modelValue":a[0]||(a[0]=e=>C.consignee=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入姓名")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("所在地区："),name:"regionNames",required:""},{default:u(()=>[i(r,{class:"region-input",onClick:K},{default:u(()=>[i(l,{modelValue:C.regionNames,"onUpdate:modelValue":a[1]||(a[1]=e=>C.regionNames=e),"suffix-icon":"right","primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("点击选择所在地区"),readonly:"",class:"no-pointer"},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["label"]),i(o,{label:e.$t("详细地址："),name:"address",required:""},{default:u(()=>[i(l,{modelValue:C.address,"onUpdate:modelValue":a[2]||(a[2]=e=>C.address=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请您填写详细收货地址")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("手机号码："),name:"mobile",required:""},{default:u(()=>[i(l,{modelValue:C.mobile,"onUpdate:modelValue":a[3]||(a[3]=e=>C.mobile=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入手机号码")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("固定电话："),name:"telephone"},{default:u(()=>[i(l,{modelValue:C.telephone,"onUpdate:modelValue":a[4]||(a[4]=e=>C.telephone=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入固定电话")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("邮箱地址："),name:"email"},{default:u(()=>[i(l,{modelValue:C.email,"onUpdate:modelValue":a[5]||(a[5]=e=>C.email=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入邮箱地址")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(o,{label:e.$t("默认地址"),name:"email"},{default:u(()=>[i(r,{class:"switch"},{default:u(()=>[i(s,{modelValue:F.value,"onUpdate:modelValue":a[6]||(a[6]=e=>F.value=e),"active-color":"var(--general)"},null,8,["modelValue"])]),_:1})]),_:1},8,["label"])]),_:1},8,["model-value"])]),_:1})]),_:1}),i(_,{"background-color":"#fff"},{default:u(()=>[i(r,{class:"btn-box"},{default:u(()=>[i(v,{loading:O.value,onClick:S},{default:u(()=>[b(h(e.$t("提交")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["title"]),i(x,{show:J.value,"onUpdate:show":a[7]||(a[7]=e=>J.value=e),modelValue:C.regionIds,"onUpdate:modelValue":a[8]||(a[8]=e=>C.regionIds=e),onSendRegionNames:E},null,8,["show","modelValue"])],64)}}}),[["__scopeId","data-v-09a648a3"]]);export{k as default};
