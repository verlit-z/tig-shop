import{b6 as t,_ as e,c as o,o as n,w as s,a as i,g as a,h as l,H as u,f as r,t as d,i as h,d as c,r as y,B as m,E as p}from"./index-DE5OqlOG.js";const f={en:{"uni-countdown.day":"day","uni-countdown.h":"h","uni-countdown.m":"m","uni-countdown.s":"s"},"zh-Hans":{"uni-countdown.day":"天","uni-countdown.h":"时","uni-countdown.m":"分","uni-countdown.s":"秒"},"zh-Hant":{"uni-countdown.day":"天","uni-countdown.h":"時","uni-countdown.m":"分","uni-countdown.s":"秒"}},{t:w}=t(f);const S=e({name:"UniCountdown",emits:["timeup"],props:{showDay:{type:Boolean,default:!0},showHour:{type:Boolean,default:!0},showMinute:{type:Boolean,default:!0},showColon:{type:Boolean,default:!0},start:{type:Boolean,default:!0},backgroundColor:{type:String,default:""},color:{type:String,default:"#333"},fontSize:{type:Number,default:14},splitorColor:{type:String,default:"#333"},day:{type:Number,default:0},hour:{type:Number,default:0},minute:{type:Number,default:0},second:{type:Number,default:0},timestamp:{type:Number,default:0},filterShow:{type:Object,default:()=>({})}},data:()=>({timer:null,syncFlag:!1,d:"00",h:"00",i:"00",s:"00",leftTime:0,seconds:0}),computed:{dayText:()=>w("uni-countdown.day"),hourText:t=>w("uni-countdown.h"),minuteText:t=>w("uni-countdown.m"),secondText:t=>w("uni-countdown.s"),timeStyle(){const{color:t,backgroundColor:e,fontSize:o}=this;return{color:t,backgroundColor:e,fontSize:`${o}px`,width:22*o/14+"px",lineHeight:20*o/14+"px",borderRadius:3*o/14+"px"}},splitorStyle(){const{splitorColor:t,fontSize:e,backgroundColor:o}=this;return{color:t,fontSize:12*e/14+"px",margin:o?4*e/14+"px":""}}},watch:{day(t){this.changeFlag()},hour(t){this.changeFlag()},minute(t){this.changeFlag()},second(t){this.changeFlag()},start:{immediate:!0,handler(t,e){if(t)this.startData();else{if(!e)return;clearInterval(this.timer)}}}},created:function(t){this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.countDown()},unmounted(){clearInterval(this.timer)},methods:{toSeconds:(t,e,o,n,s)=>t?t-parseInt((new Date).getTime()/1e3,10):60*e*60*24+60*o*60+60*n+s,timeUp(){clearInterval(this.timer),this.$emit("timeup")},countDown(){let t=this.seconds,[e,o,n,s]=[0,0,0,0];t>0?(e=Math.floor(t/86400),o=Math.floor(t/3600)-24*e,n=Math.floor(t/60)-24*e*60-60*o,s=Math.floor(t)-24*e*60*60-60*o*60-60*n):this.timeUp(),this.d=String(e).padStart(this.validFilterShow(this.filterShow.d),"0"),this.h=String(o).padStart(this.validFilterShow(this.filterShow.h),"0"),this.i=String(n).padStart(this.validFilterShow(this.filterShow.m),"0"),this.s=String(s).padStart(this.validFilterShow(this.filterShow.s),"0")},validFilterShow:t=>t&&t>0?t:2,startData(){if(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.seconds<=0)return this.seconds=this.toSeconds(0,0,0,0,0),void this.countDown();clearInterval(this.timer),this.countDown(),this.timer=setInterval(()=>{this.seconds--,this.seconds<0?this.timeUp():this.countDown()},1e3)},update(){this.startData()},changeFlag(){this.syncFlag||(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.startData(),this.syncFlag=!0)}}},[["render",function(t,e,c,y,m,p){const f=l,w=h;return n(),o(w,{class:"uni-countdown"},{default:s(()=>[c.showDay?(n(),o(f,{key:0,style:u([p.timeStyle]),class:"uni-countdown__number"},{default:s(()=>[r(d(m.d),1)]),_:1},8,["style"])):i("",!0),c.showDay?(n(),o(f,{key:1,style:u([p.splitorStyle]),class:"uni-countdown__splitor"},{default:s(()=>[r(d(p.dayText),1)]),_:1},8,["style"])):i("",!0),c.showHour?(n(),o(f,{key:2,style:u([p.timeStyle]),class:"uni-countdown__number"},{default:s(()=>[r(d(m.h),1)]),_:1},8,["style"])):i("",!0),c.showHour?(n(),o(f,{key:3,style:u([p.splitorStyle]),class:"uni-countdown__splitor"},{default:s(()=>[r(d(c.showColon?":":p.hourText),1)]),_:1},8,["style"])):i("",!0),c.showMinute?(n(),o(f,{key:4,style:u([p.timeStyle]),class:"uni-countdown__number"},{default:s(()=>[r(d(m.i),1)]),_:1},8,["style"])):i("",!0),c.showMinute?(n(),o(f,{key:5,style:u([p.splitorStyle]),class:"uni-countdown__splitor"},{default:s(()=>[r(d(c.showColon?":":p.minuteText),1)]),_:1},8,["style"])):i("",!0),a(f,{style:u([p.timeStyle]),class:"uni-countdown__number"},{default:s(()=>[r(d(m.s),1)]),_:1},8,["style"]),c.showColon?i("",!0):(n(),o(f,{key:6,style:u([p.splitorStyle]),class:"uni-countdown__splitor"},{default:s(()=>[r(d(p.secondText),1)]),_:1},8,["style"]))]),_:1})}],["__scopeId","data-v-ca85a7fa"]]),g=c({__name:"tig-countdown",props:{color:{type:String,default:"#fff"},backgroundColor:{type:String,default:""},splitorColor:{type:String,default:"#fff"},startTime:{type:String,default:""},endTime:{type:String,default:""},fontSize:{type:Number,default:12}},setup(t){const e=t,i=y(0),l=y(0),u=y(0),r=y(0);return(()=>{let t=(t=>{const e=t.split(" "),[o,n,s]=e[0].split("-"),[i,a,l]=e[1].split(":");return new Date(o,n-1,s,i,a,l).getTime()})(e.endTime)-(new Date).getTime();t>0&&(t=>{i.value=Math.floor(t/864e5),t-=864e5*i.value,l.value=Math.floor(t/36e5),t-=36e5*l.value,u.value=Math.floor(t/6e4),t-=6e4*u.value,r.value=Math.floor(t/1e3)})(t)})(),(e,d)=>{const c=m(p("uni-countdown"),S),y=h;return n(),o(y,{class:"tig-countdown"},{default:s(()=>[a(c,{color:t.color,"background-color":t.backgroundColor,"font-size":t.fontSize,"splitor-color":t.splitorColor,"show-day":i.value>0,day:i.value,hour:l.value,minute:u.value,second:r.value},null,8,["color","background-color","font-size","splitor-color","show-day","day","hour","minute","second"])]),_:1})}}});export{g as _};
