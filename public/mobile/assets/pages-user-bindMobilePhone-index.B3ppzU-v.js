import{a0 as e,d as a,K as o,aw as l,r as t,U as s,k as i,c as d,w as r,B as n,E as u,ba as p,bG as m,bH as b,o as c,g as f,i as h,f as v,t as g,F as _,ah as k,Q as y,L as x,P as w,S as V,_ as C}from"./index-DE5OqlOG.js";import{_ as U,e as z}from"./tig-layout.fowSnIDi.js";import{V as $,a as D}from"./index.CrA6UYZE.js";const T=C(a({__name:"index",setup(a){const{t:C}=o(),T=l(),M=t(),P=t(),j={mobile:{validator:(e,a,o)=>(/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(a)||o(C("请输入正确的手机号码")),!0),message:C("请输入正确的手机号码!"),trigger:["change","blur"]}},q=t(""),E=t(!0),I=s({mobile:"",mobileCode:"",password:"",openData:{}}),A=t(!1),B=e=>{y({title:e,duration:1500,icon:"none"})},F=i(()=>!(I.mobile&&I.mobileCode&&I.password)),G=async()=>{A.value=!0;try{await M.value.validate(),I.openData=x("openData");const o=await(a=I,e({url:"user/login/bindMobile",method:"post",data:a}));T.setToken(o.token),T.getUserInfo(),T.setAuthType(""),y({title:C("绑定成功"),duration:1500,icon:"success"}),setTimeout(()=>{w("openData",""),V({url:"/pages/user/index"})},1500)}catch(o){console.error(o),1002==o.code&&P.value?P.value.show():o.code>0&&(y({title:o.message,duration:1500,icon:"none"}),q.value="")}finally{A.value=!1}var a},H=e=>{q.value=e.verifyToken,G()};return(e,a)=>{const o=h,l=n(u("up-input"),p),t=n(u("up-form-item"),m),s=n(u("up-form"),b),i=n(u("tig-button"),z),y=n(u("tig-layout"),U);return c(),d(y,{title:"绑定"},{default:r(()=>[f(o,{class:"bindMobilePhone"},{default:r(()=>[f(o,{class:"bindMobilePhone-title"},{default:r(()=>[v(g(e.$t("手机号绑定")),1)]),_:1}),f(s,{ref_key:"formRef",ref:M,"label-position":"left",model:I,rules:j,"error-type":"toast"},{default:r(()=>[f(t,{label:"",prop:"mobile"},{default:r(()=>[f(l,{modelValue:I.mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>I.mobile=e),placeholder:e.$t("请输入手机号"),"font-size":"28rpx",border:"bottom"},null,8,["modelValue","placeholder"])]),_:1}),f(t,{label:"",prop:""},{default:r(()=>[f(o,{class:"flex flex1"},{default:r(()=>[f(l,{modelValue:I.mobileCode,"onUpdate:modelValue":a[1]||(a[1]=e=>I.mobileCode=e),placeholder:e.$t("请输入验证码"),"font-size":"28rpx",border:"bottom"},{suffix:r(()=>[]),_:1},8,["modelValue","placeholder"]),f($,{mobile:I.mobile,"onUpdate:mobile":a[2]||(a[2]=e=>I.mobile=e),"is-checked":E.value,"onUpdate:isChecked":a[3]||(a[3]=e=>E.value=e),"verify-token-data":q.value,"onUpdate:verifyTokenData":a[4]||(a[4]=e=>q.value=e),style:{height:"65rpx","margin-left":"15rpx"},"request-api":_(k),onMobileErrorCallback:B},null,8,["mobile","is-checked","verify-token-data","request-api"])]),_:1})]),_:1}),f(t,{label:"",prop:""},{default:r(()=>[f(l,{modelValue:I.password,"onUpdate:modelValue":a[5]||(a[5]=e=>I.password=e),placeholder:e.$t("请输入密码"),"font-size":"28rpx",password:"",border:"bottom"},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model"]),f(i,{loading:A.value,disabled:F.value,onClick:G},{default:r(()=>[v(g(e.$t("确 认")),1)]),_:1},8,["loading","disabled"])]),_:1}),f(D,{ref_key:"verify",ref:P,mode:"pop","captcha-type":"blockPuzzle","img-size":{width:"310px",height:"155px"},onOkCallback:H},null,512)]),_:1})}}}),[["__scopeId","data-v-db89cae5"]]);export{T as default};
