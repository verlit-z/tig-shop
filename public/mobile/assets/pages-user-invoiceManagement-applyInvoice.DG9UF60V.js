import{d as e,K as a,U as l,r as o,l as t,s as n,c as r,w as m,B as c,E as d,am as i,an as s,o as u,g as p,i as y,f as b,t as f,h as _,V as h,I as v,J as g,$,_ as V}from"./index-DE5OqlOG.js";import{_ as k,a as A}from"./uni-forms.DRg_j8ip.js";import{_ as T}from"./uni-easyinput.Cpml7ZWU.js";import{_ as x,e as C}from"./tig-layout.fowSnIDi.js";import{_ as M}from"./tig-fixed-placeholder.OF5rBWLr.js";import{a as N,g as U}from"./invoice.xNaTKHhj.js";import{o as B,a as P}from"./invoiceManagemen.BS2rG0JA.js";import"./uni-icons.BITEJ68A.js";const j=V(e({__name:"applyInvoice",setup(e){const{t:V}=a(),j=l({titleType:1,invoiceType:1,companyName:"",mobile:"",email:"",companyCode:"",companyAddress:"",companyPhone:"",companyBank:"",companyAccount:""}),q={companyCode:{rules:[{required:!0,errorMessage:V("纳税人识号不能为空!")}]},companyAddress:{rules:[{required:!0,errorMessage:V("单位地址不能为空!")}]},companyPhone:{rules:[{required:!0,errorMessage:V("单位电话不能为空!")}]},companyBank:{rules:[{required:!0,errorMessage:V("开户银行不能为空!")}]},companyAccount:{rules:[{required:!0,errorMessage:V("银行账户不能为空!")}]},mobile:{rules:[{required:!0,errorMessage:V("手机不能为空!")}]}},w=o(0),I=o(!1),R=async()=>{try{const e=await U({invoiceType:j.invoiceType,titleType:j.titleType});e.item&&(1===j.invoiceType&&1===j.titleType?(j.companyName=e.item.companyName,j.mobile=e.item.mobile,j.email=e.item.email):(j.companyCode=e.item.companyCode,j.companyName=e.item.companyName,j.companyAddress=e.item.companyAddress,j.companyPhone=e.item.companyPhone,j.companyBank=e.item.companyBank,j.companyAccount=e.item.companyAccount),j.mobile=e.item.mobile,j.email=e.item.email)}catch(e){console.error(e)}},E=e=>{j.invoiceType=e,j.titleType=2===e?2:1,j.companyName="",j.mobile="",j.email="",j.companyCode="",j.companyAddress="",j.companyPhone="",j.companyBank="",j.companyAccount="",R()},J=o(),K=o("insert"),O=()=>{J.value.validate().then(e=>{"insert"===K.value?(async()=>{try{const e={...j,id:w.value};await B(e),$({url:"/pages/user/invoiceManagement/index?type=list"})}catch(e){console.error(e)}})():(async()=>{try{const e={...j,id:w.value};await P(e),$({url:"/pages/user/invoiceManagement/index?type=list"})}catch(e){console.error(e)}})()}).catch(e=>{console.log("表单错误信息：",e)})};t(e=>{e&&(e.type&&(K.value=e.type),e.orderId&&(w.value=e.orderId))}),n(()=>{(async()=>{try{const e=await N();e&&Object.keys(e).length>0?I.value=!0:I.value=!1}catch(e){console.error(e)}})(),R()});const S=()=>{$({url:"/pages/user/invoiceManagement/index?type=invoice"})};return(e,a)=>{const l=_,o=y,t=c(d("up-radio"),i),n=c(d("up-radio-group"),s),$=c(d("uni-forms-item"),k),V=c(d("uni-easyinput"),T),N=c(d("uni-forms"),A),U=c(d("tig-button"),C),B=c(d("tig-fixed-placeholder"),M),P=c(d("tig-layout"),x);return u(),r(P,{title:"发票申请"},{default:m(()=>[p(o,{class:"invoice-popup-content"},{default:m(()=>[p(o,{class:"invoice-typemenu"},{default:m(()=>[p(o,{class:"invoice-explain"},{default:m(()=>[b(f(e.$t("我公司依法开具发票，请您按照税法规定使用发票。根据现行税收政策，部分公司提供数电票"))+", "+f(e.$t("数电（专用发票）法律效力与现有增值税专用发票相同;如商品由第三方卖家销售，发票类型和内容将由该卖家决定，发票由卖家开具并提供。如您为企业采购，需要多单合并开具或批量提交发票可注册企业用户"))+"；",1),p(l,{class:"main-color"},{default:m(()=>[b(f(e.$t("使用礼品卡支付部分的金额，不支持开发票")),1)]),_:1})]),_:1}),p(o,{class:h(["invoice-typemenu-item",{active:1===j.invoiceType}]),onClick:a[0]||(a[0]=e=>E(1))},{default:m(()=>[b(f(e.$t("普通发票")),1)]),_:1},8,["class"]),p(o,{class:h(["invoice-typemenu-item",{active:2===j.invoiceType}]),onClick:a[1]||(a[1]=e=>E(2))},{default:m(()=>[b(f(e.$t("增值税专用发票")),1)]),_:1},8,["class"])]),_:1}),p(o,{class:"invoice-formState"},{default:m(()=>[p(N,{ref_key:"formRef",ref:J,"model-value":j,rules:q,"label-width":"170rpx"},{default:m(()=>[1===j.invoiceType?(u(),v(g,{key:0},[p($,{label:e.$t("发票抬头"),name:"name"},{default:m(()=>[p(o,{class:"item-layout"},{default:m(()=>[p(n,{modelValue:j.titleType,"onUpdate:modelValue":a[2]||(a[2]=e=>j.titleType=e),placement:"row"},{default:m(()=>[p(t,{"custom-style":{marginRight:"22rpx"},name:1,"active-color":"var(--general)",label:e.$t("个人")},null,8,["label"]),p(t,{name:2,"active-color":"var(--general)",label:e.$t("企业")},null,8,["label"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"]),1==j.titleType?(u(),r($,{key:0,label:e.$t("个人名称"),name:"companyName",rules:[{required:!0,errorMessage:e.$t("个人名称不能为空")}]},{default:m(()=>[p(V,{modelValue:j.companyName,"onUpdate:modelValue":a[3]||(a[3]=e=>j.companyName=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入个人名称")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):(u(),v(g,{key:1},[p($,{label:e.$t("企业名称"),name:"companyName",rules:[{required:!0,errorMessage:"企业名称不能为空"}]},{default:m(()=>[p(V,{modelValue:j.companyName,"onUpdate:modelValue":a[4]||(a[4]=e=>j.companyName=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入企业名称")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p($,{label:e.$t("纳税人识号"),name:"companyCode"},{default:m(()=>[p(V,{modelValue:j.companyCode,"onUpdate:modelValue":a[5]||(a[5]=e=>j.companyCode=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入纳税人识号")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p($,{label:e.$t("单位地址"),name:"companyAddress"},{default:m(()=>[p(V,{modelValue:j.companyAddress,"onUpdate:modelValue":a[6]||(a[6]=e=>j.companyAddress=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入单位地址")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p($,{label:e.$t("单位电话"),name:"companyPhone"},{default:m(()=>[p(V,{modelValue:j.companyPhone,"onUpdate:modelValue":a[7]||(a[7]=e=>j.companyPhone=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入单位电话")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p($,{label:e.$t("开户银行"),name:"companyBank"},{default:m(()=>[p(V,{modelValue:j.companyBank,"onUpdate:modelValue":a[8]||(a[8]=e=>j.companyBank=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入开户银行")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p($,{label:e.$t("银行账户"),name:"companyAccount"},{default:m(()=>[p(V,{modelValue:j.companyAccount,"onUpdate:modelValue":a[9]||(a[9]=e=>j.companyAccount=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入银行账户")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])],64)),p($,{label:e.$t("收票人手机"),name:"mobile"},{default:m(()=>[p(V,{modelValue:j.mobile,"onUpdate:modelValue":a[10]||(a[10]=e=>j.mobile=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入收票人手机")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p($,{label:e.$t("收票人邮箱"),name:"email"},{default:m(()=>[p(V,{modelValue:j.email,"onUpdate:modelValue":a[11]||(a[11]=e=>j.email=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入收票人邮箱")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])],64)):2===j.invoiceType&&I.value?(u(),v(g,{key:1},[p($,{label:e.$t("单位名称")},{default:m(()=>[p(o,{class:"disabled-text"},{default:m(()=>[b(f(j.companyName),1)]),_:1})]),_:1},8,["label"]),p($,{label:e.$t("纳税人识别码")},{default:m(()=>[p(o,{class:"disabled-text"},{default:m(()=>[b(f(j.companyCode),1)]),_:1})]),_:1},8,["label"]),p($,{label:e.$t("注册地址")},{default:m(()=>[p(o,{class:"disabled-text"},{default:m(()=>[b(f(j.companyAddress),1)]),_:1})]),_:1},8,["label"]),p($,{label:e.$t("注册电话")},{default:m(()=>[p(o,{class:"disabled-text"},{default:m(()=>[b(f(j.companyPhone),1)]),_:1})]),_:1},8,["label"]),p($,{label:e.$t("开户银行")},{default:m(()=>[p(o,{class:"disabled-text"},{default:m(()=>[b(f(j.companyBank),1)]),_:1})]),_:1},8,["label"]),p($,{label:e.$t("银行账户")},{default:m(()=>[p(o,{class:"disabled-text"},{default:m(()=>[b(f(j.companyAccount),1)]),_:1})]),_:1},8,["label"]),p($,{label:e.$t("收票人手机"),name:"mobile"},{default:m(()=>[p(V,{modelValue:j.mobile,"onUpdate:modelValue":a[12]||(a[12]=e=>j.mobile=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入收票人手机")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p($,{label:e.$t("收票人邮箱"),name:"email"},{default:m(()=>[p(V,{modelValue:j.email,"onUpdate:modelValue":a[13]||(a[13]=e=>j.email=e),"primary-color":"rgb(192, 196, 204)","input-border":!1,placeholder:e.$t("请输入收票人邮箱")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])],64)):(u(),r(o,{key:2,class:"notPass"},{default:m(()=>[p(o,null,{default:m(()=>[b(f(e.$t("您还未通过增票资质申请，暂时无法开具增值税专用发票"))+" ",1),p(l,{class:"notPassBtn",onClick:S},{default:m(()=>[b(f(e.$t("去申请")),1)]),_:1})]),_:1})]),_:1}))]),_:1},8,["model-value"])]),_:1})]),_:1}),p(B,{"background-color":"#fff"},{default:m(()=>[p(o,{class:"btn-box"},{default:m(()=>[p(U,{disabled:2===j.invoiceType&&!I.value,onClick:O},{default:m(()=>[b(f(e.$t("提交")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-b71f127f"]]);export{j as default};
