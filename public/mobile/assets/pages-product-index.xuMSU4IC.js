import{d as e,k as t,B as a,E as l,c as s,o,w as i,g as u,i as c,f as n,t as r,I as d,O as p,b as f,F as m,G as v,J as _,S as y,_ as h,a6 as g,j as k,r as b,H as x,h as w,V as I,aM as $,aS as V,aO as S,a as C,W as T,aF as N,ab as P,X as j,e as z,aE as L,aT as U,K as D,aL as A,aU as O,Q as F,L as B,aV as E,aW as R,aX as X,aY as M,aZ as W,N as Y,a_ as Z,aB as H,aw as J,a5 as K,a$ as q,n as G,l as Q,Z as ee,aK as te,ai as ae,b0 as le,a3 as se,a1 as oe,b1 as ie,b2 as ue,m as ce,b3 as ne,s as re,y as de,z as pe,b4 as fe,af as me,P as ve,Y as _e,T as ye,b5 as he,v as ge,aN as ke}from"./index-DE5OqlOG.js";import{_ as be}from"./tig-image.h_tgFjnN.js";import{_ as xe}from"./uni-badge.C1M7jQhD.js";import{b as we,e as Ie,u as $e,_ as Ve}from"./tig-layout.fowSnIDi.js";import{_ as Se}from"./tig-back-top.vue_vue_type_script_setup_true_lang.Dshf9tCI.js";import{_ as Ce}from"./tig-loadingpage.vue_vue_type_script_setup_true_lang.ClZKVkre.js";import{_ as Te}from"./format-price.Cc34639m.js";import{d as Ne,u as Pe,g as je,a as ze,b as Le,c as Ue,e as De,f as Ae,h as Oe}from"./product.xxdbZFp6.js";import{a as Fe}from"./activityCard.mdMMZqu3.js";import{_ as Be}from"./tig-countdown.vue_vue_type_script_setup_true_lang.Bay3baQr.js";import{_ as Ee}from"./uni-icons.BITEJ68A.js";import{_ as Re}from"./uni-rate.BV8u_wWd.js";import{g as Xe,s as Me}from"./specification.BJJ9B7ka.js";import{_ as We}from"./tig-fixed-placeholder.OF5rBWLr.js";import{a as Ye}from"./coupon.cwyGQYgg.js";import{_ as Ze}from"./index.vue_vue_type_script_setup_true_lang.CvdmARV9.js";import{r as He}from"./index.cAM2UeJZ.js";import{b as Je}from"./cart.GGc2DLzy.js";import"./uni-number-box.JWQxtRhY.js";import"./masonry.CqYTyCF5.js";import"./useList.B4FtGhCx.js";const Ke=h(e({__name:"tig-menu",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:h}){const g=e,k=h,b=t({get:()=>g.modelValue,set(e){k("update:modelValue",e)}}),x=[{icon:"common/home.svg",text:"首页",link:"/pages/index/index"},{icon:"common/search.svg",text:"搜索",link:"/pages/search/index"},{icon:"common/user.svg",text:"个人中心",link:"/pages/user/index"},{icon:"common/collection.svg",text:"商品收藏",link:"/pages/user/collectProduct/index"},{icon:"common/history.svg",text:"查看足迹",link:"/pages/user/historyProduct/index"},{icon:"common/message.svg",text:"消息中心",link:"/pages/user/messageLog/index"}];return(e,t)=>{const h=c,g=f,w=a(l("tig-popup"),we);return o(),s(w,{show:b.value,"onUpdate:show":t[0]||(t[0]=e=>b.value=e),position:"top","background-color":"#fff","show-close":!1},{default:i(()=>[u(h,{class:"menu-box"},{default:i(()=>[u(h,{class:"menu-title"},{default:i(()=>[n(r(e.$t("快捷入口")),1)]),_:1}),u(h,{class:"menu-list"},{default:i(()=>[(o(),d(_,null,p(x,(t,a)=>u(h,{key:a,class:"menu-item",onClick:e=>(e=>{k("update:modelValue",!1),y({url:e.link})})(t)},{default:i(()=>[u(h,{class:"menu-item-icon"},{default:i(()=>[u(g,{class:"menu-item-img",src:m(v)(t.icon)},null,8,["src"])]),_:2},1024),u(h,{class:"menu-item-text"},{default:i(()=>[n(r(e.$t(t.text)),1)]),_:2},1024)]),_:2},1032,["onClick"])),64))]),_:1})]),_:1})]),_:1},8,["show"])}}}),[["__scopeId","data-v-7842f184"]]),qe=h(e({__name:"productNav",props:{modelValue:{type:Number,default:0},activeModule:{type:String,default:""},event:{type:Function,default:()=>{}}},emits:["update:modelValue","update:activeModule"],setup(e,{emit:f}){g(e=>({"2c4f2e65":j.value}));const m=k(),v=e,y=f,h=b([{label:"商品",value:".product-area"},{label:"评价",value:".evaluate-area"},{label:"详情",value:".product-detail-area"}]),$=b(250),V=$.value-80,S=t(()=>{let e=1;return v.modelValue>V?e=0:v.modelValue<V&&v.modelValue>0&&(e=(V-v.modelValue)/V),v.modelValue>$.value&&(e=1),e}),C=t(()=>{let e=0;return v.modelValue>$.value?e=1:v.modelValue<$.value&&v.modelValue>0&&(e=v.modelValue/$.value),e}),T=b(!1),N=()=>{T.value=!0},P=()=>{history.back()},j=t(()=>m.saveTop+10+"px");return t(()=>m.menuButtonInfo),(t,f)=>{const m=w,g=c,k=a(l("tig-menu"),Ke);return o(),d(_,null,[u(g,{class:"product-nav"},{default:i(()=>[u(g,{class:"product-nav-container"},{default:i(()=>[u(g,{class:"product-nav-left product-nav-icon",style:x({opacity:S.value}),onClick:P},{default:i(()=>[u(m,{class:I(["iconfont icon-houtui",{change:e.modelValue>$.value}])},null,8,["class"])]),_:1},8,["style"]),u(g,{class:"product-nav-middle",style:x({opacity:C.value})},{default:i(()=>[(o(!0),d(_,null,p(h.value,a=>(o(),s(g,{key:a.label,class:I(["middle-text",{active:a.value===e.activeModule}]),onClick:e=>{return t=a.value,y("update:activeModule",t),void v.event(t);var t}},{default:i(()=>[n(r(t.$t(a.label)),1)]),_:2},1032,["class","onClick"]))),128))]),_:1},8,["style"]),u(g,{class:"product-nav-right product-nav-icon",style:x({opacity:S.value}),onClick:N},{default:i(()=>[u(m,{class:I(["iconfont-h5 icon-gengduo",{change:e.modelValue>$.value}])},null,8,["class"])]),_:1},8,["style"])]),_:1})]),_:1}),u(k,{modelValue:T.value,"onUpdate:modelValue":f[0]||(f[0]=e=>T.value=e)},null,8,["modelValue"])],64)}}}),[["__scopeId","data-v-b319343d"]]),Ge=h(e({__name:"productImg",props:{picList:{default:()=>[]},productInfo:{default:()=>({})},videoList:{default:()=>[]},seckillValue:{}},setup(e){const a=e,l=t(()=>a.seckillValue.seckillStock),v=b(1),y=t(()=>a.videoList[0]?a.videoList[0]:{}),h=t(()=>{var e;return y.value.videoUrl?[{...y.value,picUrl:(null==(e=a.picList[0])?void 0:e.picUrl)||""},...a.picList]:a.picList}),g=e=>{v.value=e.detail.current+1,I.value=!1,null==x||x.pause()},k=S();let x;const I=b(!1),D=()=>{I.value=!0,null==x||x.play()},A=e=>{console.log("video error",e)},O=()=>{I.value=!1},F=()=>{};return $(()=>{x=V("productVideo",k)}),(e,t)=>{const a=c,y=f,k=z,b=N,x=L,$=w;return o(),s(a,{class:"product-pic-con"},{default:i(()=>[u(a,{class:"nav-bg"}),h.value.length>0?(o(),s(a,{key:0,class:"product-bg"},{default:i(()=>[u(x,{"indicator-dots":!1,circular:!0,interval:"3000",duration:"500",onChange:g},{default:i(()=>[(o(!0),d(_,null,p(h.value,(t,c)=>(o(),s(b,{key:c},{default:i(()=>{var p;return[t.videoUrl?(o(),s(a,{key:1,class:"video-box"},{default:i(()=>[T(u(a,{class:"cover-box",onClick:D},{default:i(()=>[u(y,{src:m(P)(t.videoCover?t.videoCover:t.picUrl||""),class:"slide-image"},null,8,["src"]),u(a,{class:"video-icon"})]),_:2},1536),[[j,!I.value]]),T(u(k,{id:"productVideo",class:"product-video",src:m(P)(t.videoUrl),autoplay:!1,"enable-progress-gesture":!1,controls:"",loop:!1,onPause:F,onError:A,onEnded:O},null,8,["src"]),[[j,I.value]])]),_:2},1024)):(o(),d(_,{key:0},[u(y,{src:m(P)(t.picUrl||""),class:"slide-image",onClick:e=>(e=>{const t=h.value.map(e=>P(e.picUrl||""));U({current:t[e],urls:t,indicator:"number",loop:!0})})(c)},null,8,["src","onClick"]),1==(null==(p=e.productInfo)?void 0:p.isSeckill)?(o(),d(_,{key:0},[0==l.value?(o(),s(a,{key:0,class:"outsale"},{default:i(()=>[n(r(e.$t("已售罄")),1)]),_:1})):C("",!0)],64)):(o(),d(_,{key:1},[0==e.productInfo.productStock?(o(),s(a,{key:0,class:"outsale"},{default:i(()=>[n(r(e.$t("已售罄")),1)]),_:1})):C("",!0)],64))],64))]}),_:2},1024))),128))]),_:1}),T(u(a,{class:"pages"},{default:i(()=>[u($,null,{default:i(()=>[n(r(v.value),1)]),_:1}),n(" /"+r(h.value.length||1),1)]),_:1},512),[[j,h.value.length>1&&!I.value]])]),_:1})):C("",!0)]),_:1})}}}),[["__scopeId","data-v-f0a4bf6b"]]),Qe=h(e({__name:"poster",props:{modelValue:{type:Boolean},productId:{},productInfo:{},productPrice:{}},emits:["update:modelValue"],setup(e,{emit:t}){const{t:d}=D(),p=S(),m=e,_=b(""),y=b(!1),h=b(0);$(async()=>{const{windowWidth:e}=A();h.value=e/375,await g(),k()});const g=async()=>{try{const e=await O(location.href);_.value=e,F({title:d("正在生成海报，请稍后"),icon:"none",duration:1e3})}catch(e){console.error(e),F({title:e.message,icon:"none"})}},k=async()=>{const e=B("userInfo"),t=E();let a=R("myCanvas",p);a.draw(),a.save(),a.setFillStyle("#ffffff"),a.fillRect(0,0,500,900),a.draw(),a.setFontSize(14),a.setFillStyle("#000000"),a.fillText(e.username??d("普通会员"),100*h.value,48),a.setFontSize(12),a.setFillStyle("#999999"),a.fillText(d("的分享"),100*h.value,68),a.setFontSize(18),a.setFillStyle(t.themeStyle["--general"]),a.fillText(`${m.productPrice}`,20,366*h.value),x(m.productInfo.productName,20,379*h.value,a),a.save();try{const t=await X(e.avatar?P(e.avatar):v("user/default_avatar.jpg"));a.beginPath(),a.arc(50,50,28,0,2*Math.PI),a.clip(),a.drawImage(t.path,20,20,70*h.value,70*h.value),a.restore(),a.draw(!0,async()=>{a.save();const e=await X(P(m.productInfo.picOriginal));a.drawImage(e.path,15,92,245*h.value,245*h.value),a.draw(!0,()=>{a.drawImage(_.value,165,360*h.value,100*h.value,100*h.value),a.draw(!0,()=>{I()})})})}catch(l){console.error(l)}},x=(e,t,a,l)=>{let s=[];for(let o=0,i=e.length;o<i/11;o++){let t=e.slice(11*o,11*(o+1));s.push(t)}s.forEach((e,s)=>{s>3||(a+=20,l.setFontSize(12),l.setFillStyle("#333333"),l.fillText(e,t,a))})},w=b(""),I=()=>{M({fileType:"jpg",canvasId:"myCanvas",quality:1,success:function(e){w.value=e.tempFilePath,y.value=!0},fail:e=>{F({title:JSON.stringify(e),icon:"none",duration:3e3}),y.value=!1,console.log(e)}},p)},V=()=>{};return(e,t)=>{const d=W,p=f,m=c,v=a(l("tig-popup"),we);return o(),s(m,null,{default:i(()=>[u(d,{id:"myCanvas",class:"canvas-content","canvas-id":"myCanvas"}),u(v,{show:y.value,"onUpdate:show":t[1]||(t[1]=e=>y.value=e),"background-color":"transparent",position:"center","show-close":!1,onClose:t[2]||(t[2]=t=>e.$emit("update:modelValue",!1))},{default:i(()=>[u(m,{class:"poster-box",onTouchmove:t[0]||(t[0]=Y(()=>{},["stop","prevent"])),onLongpress:Y(V,["stop"])},{default:i(()=>[u(p,{src:w.value,style:{height:"100%",width:"100%"}},null,8,["src"])]),_:1}),u(m,{class:"canvas-tip"},{default:i(()=>[n(r(e.$t("长按可保存海报")),1)]),_:1})]),_:1},8,["show"])]),_:1})}}}),[["__scopeId","data-v-2434ed17"]]);class et{constructor(e,t){this.options=e,this.animation=Z({...e}),this.currentStepAnimates={},this.next=0,this.$=t}_nvuePushAnimates(e,t){let a=this.currentStepAnimates[this.next],l={};if(l=a||{styles:{},config:{}},tt.includes(e)){l.styles.transform||(l.styles.transform="");let a="";"rotate"===e&&(a="deg"),l.styles.transform+=`${e}(${t+a}) `}else l.styles[e]=`${t}`;this.currentStepAnimates[this.next]=l}_animateRun(e={},t={}){let a=this.$.$refs.ani.ref;if(a)return new Promise((l,s)=>{nvueAnimation.transition(a,{styles:e,...t},e=>{l()})})}_nvueNextAnimate(e,t=0,a){let l=e[t];if(l){let{styles:s,config:o}=l;this._animateRun(s,o).then(()=>{t+=1,this._nvueNextAnimate(e,t,a)})}else this.currentStepAnimates={},"function"==typeof a&&a(),this.isEnd=!0}step(e={}){return this.animation.step(e),this}run(e){this.$.animationData=this.animation.export(),this.$.timer=setTimeout(()=>{"function"==typeof e&&e()},this.$.durationTime)}}const tt=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function at(e,t){if(t)return clearTimeout(t.timer),new et(e,t)}tt.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach(e=>{et.prototype[e]=function(...t){return this.animation[e](...t),this}});const lt=h({name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default:()=>"fade"},duration:{type:Number,default:300},styles:{type:Object,default:()=>({})},customClass:{type:String,default:""},onceRender:{type:Boolean,default:!1}},data:()=>({isShow:!1,transform:"",opacity:0,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(e){e?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let e={...this.styles,"transition-duration":this.duration/1e3+"s"},t="";for(let a in e){t+=this.toLine(a)+":"+e[a]+";"}return t},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(e={}){e.duration&&(this.durationTime=e.duration),this.animation=at(Object.assign(this.config,e),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(e,t={}){return this.animation?(Object.keys(e).forEach(t=>{const a=e[t];"function"==typeof this.animation[t]&&(Array.isArray(a)?this.animation[t](...a):this.animation[t](a))}),this.animation.step(t),this):this},run(e){this.animation&&this.animation.run(e)},open(){clearTimeout(this.timer),this.isShow=!0,this.transform=this.styleInit(!1).transform||"",this.opacity=this.styleInit(!1).opacity||0,this.$nextTick(()=>{this.timer=setTimeout(()=>{this.animation=at(this.config,this),this.tranfromInit(!1).step(),this.animation.run(()=>{this.transform="",this.opacity=this.styleInit(!1).opacity||1,this.$emit("change",{detail:this.isShow})})},80)})},close(e){this.animation&&this.tranfromInit(!0).step().run(()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:e,transform:t}=this.styleInit(!1);this.opacity=e||1,this.transform=t,this.$emit("change",{detail:this.isShow})})},styleInit(e){let t={transform:"",opacity:1};const a=(e,a)=>{const l=this.animationType(e)[a];a.startsWith("fade")?t.opacity=l:t.transform+=l+" "};return"string"==typeof this.modeClass?a(e,this.modeClass):this.modeClass.forEach(t=>a(e,t)),t},tranfromInit(e){let t=(e,t)=>{let a=null;"fade"===t?a=e?0:1:(a=e?"-100%":"0","zoom-in"===t&&(a=e?.8:1),"zoom-out"===t&&(a=e?1.2:1),"slide-right"===t&&(a=e?"100%":"0"),"slide-bottom"===t&&(a=e?"100%":"0")),this.animation[this.animationMode()[t]](a)};return"string"==typeof this.modeClass?t(e,this.modeClass):this.modeClass.forEach(a=>{t(e,a)}),this.animation},animationType:e=>({fade:e?1:0,"slide-top":`translateY(${e?"0":"-100%"})`,"slide-right":`translateX(${e?"0":"100%"})`,"slide-bottom":`translateY(${e?"0":"100%"})`,"slide-left":`translateX(${e?"0":"-100%"})`,"zoom-in":`scaleX(${e?1:.8}) scaleY(${e?1:.8})`,"zoom-out":`scaleX(${e?1:1.2}) scaleY(${e?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine:e=>e.replace(/([A-Z])/g,"-$1").toLowerCase()}},[["render",function(e,t,a,l,u,n){const r=c;return T((o(),s(r,{ref:"ani",animation:u.animationData,class:I(a.customClass),style:x(n.transformStyles),onClick:n.onClick},{default:i(()=>[H(e.$slots,"default")]),_:3},8,["animation","class","style","onClick"])),[[j,u.isShow]])}]]),st=h(e({__name:"guide",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:d}){const p=k(),_=d,y=b({justifyContent:"center",alignItems:"center",flexDirection:"column",width:"100vw",height:"auto"});return t(()=>p.menuButtonInfo),(t,d)=>{const p=f,h=c,g=a(l("uni-transition"),lt);return e.modelValue?(o(),s(h,{key:0,class:"guide-box",onClick:d[0]||(d[0]=e=>_("update:modelValue",!1))},{default:i(()=>[u(g,{ref:"ani","custom-class":"transition","mode-class":["fade","slide-top"],styles:y.value,show:e.modelValue},{default:i(()=>[u(h,{class:"guide-content"},{default:i(()=>[u(h,{class:"guide-img-box"},{default:i(()=>[u(p,{class:"guide-img",src:m(v)("common/share_arrow.png")},null,8,["src"])]),_:1}),u(h,{class:"guide-text"},{default:i(()=>[n(r(t.$t("立即分享给好友吧")),1)]),_:1}),u(h,null,{default:i(()=>[n(r(t.$t("点击屏幕右上角将本页面分享给好友")),1)]),_:1})]),_:1})]),_:1},8,["styles","show"])]),_:1})):C("",!0)}}}),[["__scopeId","data-v-9ca55e33"]]),ot=h(e({__name:"productShare",props:{modelValue:{type:Boolean},productId:{},productInfo:{},productPrice:{}},emits:["update:modelValue"],setup(e,{emit:d}){const{t:p}=D(),f=k();J();const m=e,v=d,_=b(m.productInfo);K(()=>m.productInfo,e=>{_.value=e});const y=t({get:()=>m.modelValue,set(e){v("update:modelValue",e)}}),h=b(!1),g=()=>{v("update:modelValue",!1),h.value=!0},x=()=>{v("update:modelValue",!1),I()},I=()=>{q(window.location.href,()=>{F({title:p("复制成功"),icon:"none"})})},$=t(()=>"miniProgram"===f.XClientType||"wechat"===f.XClientType),V=b(!1),S=()=>{v("update:modelValue",!1),V.value=!0};return(e,t)=>{const d=c,p=w,f=a(l("tig-popup"),we);return o(),s(d,{class:"share"},{default:i(()=>[u(f,{show:y.value,"onUpdate:show":t[0]||(t[0]=e=>y.value=e),position:"bottom"},{default:i(()=>[u(d,{class:"share-title"},{default:i(()=>[n(r(e.$t("分享")),1)]),_:1}),u(d,{class:"share-content"},{default:i(()=>[$.value?(o(),s(d,{key:0,class:"share-item",onClick:S},{default:i(()=>[u(p,{class:"iconfont-h5 icon-haoyou"}),u(p,{class:"share-item-text"},{default:i(()=>[n(r(e.$t("分享给好友")),1)]),_:1})]),_:1})):C("",!0),u(d,{class:"share-item",onClick:x},{default:i(()=>[u(p,{class:"iconfont-h5 icon-link"}),u(p,{class:"share-item-text"},{default:i(()=>[n(r(e.$t("复制链接")),1)]),_:1})]),_:1}),u(d,{class:"share-item",onClick:g},{default:i(()=>[u(p,{class:"iconfont-h5 icon-tupian"}),u(p,{class:"share-item-text"},{default:i(()=>[n(r(e.$t("生成商品海报")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),h.value?(o(),s(Qe,{key:0,modelValue:h.value,"onUpdate:modelValue":t[1]||(t[1]=e=>h.value=e),"product-id":e.productId,"product-info":_.value,"product-price":e.productPrice},null,8,["modelValue","product-id","product-info","product-price"])):C("",!0),u(st,{modelValue:V.value,"onUpdate:modelValue":t[2]||(t[2]=e=>V.value=e)},null,8,["modelValue"])]),_:1})}}}),[["__scopeId","data-v-7b77e734"]]),it=h(e({__name:"productTitleInfo",props:{productInfo:{type:Object,default:()=>({})},productPrice:{type:[String,Number],default:"0"},isSeckill:{type:Number,default:0},isDiscount:{type:Number,default:0},promotionList:{type:Array,default:()=>[]},showCoupon:{type:Boolean,default:!1},type:{type:String,default:""},exchangeIntegral:{type:Number,default:0}},emits:["update:showCoupon"],setup(e,{emit:t}){const y=k(),h=J(),g=e,x=t,{t:$}=D(),V=b(!1),S=b(0),T=()=>{x("update:showCoupon",!0)},N=async e=>{try{const t=await je({id:e});V.value=t}catch(t){if(401===t.code)return V.value=!1;F({title:t.message,icon:"none"})}},P=async()=>{try{V.value?await Ne({id:S.value}):await Pe({productId:S.value}),F({title:V.value?$("取消收藏成功"):$("收藏成功"),icon:"none"}),await N(S.value)}catch(e){F({title:e.message,icon:"none"})}},j=b(!1),z=()=>{h.token?j.value=!0:G({url:"/pages/login/index"})};return K(()=>g.productInfo,e=>{e&&(S.value=e.productId,N(e.productId))}),(t,h)=>{const g=c,k=a(l("format-price"),Te),b=w,x=f;return o(),s(g,{class:"product-title-info"},{default:i(()=>[u(g,{class:"title-info-top"},{default:i(()=>[e.isSeckill||e.isDiscount?(o(),s(g,{key:0,class:"title-info-bottom line2"},{default:i(()=>[n(r(e.productInfo.productName),1)]),_:1})):(o(),s(g,{key:1,class:"title-top-price"},{default:i(()=>[u(k,{"font-style":{fontSize:"36rpx"},"decimals-style":{fontSize:"25rpx"},"currency-style":{fontSize:"23rpx"},"price-data":e.productPrice},null,8,["price-data"]),"exchange"===e.type?(o(),s(g,{key:0,class:"exchange-box"},{default:i(()=>[u(b,{class:"exchange-icon"},{default:i(()=>[n("+")]),_:1}),u(x,{class:"exchange-img",src:m(v)("exchange/exchange.png")},null,8,["src"]),u(b,{class:"exchange-text"},{default:i(()=>[n(r(e.exchangeIntegral),1)]),_:1})]),_:1})):C("",!0),"exchange"!==e.type&&m(y).showMarketprice&&e.productInfo.marketPrice&&Number(e.productInfo.marketPrice)>0?(o(),s(g,{key:1,class:"title-top-market_price"},{default:i(()=>[u(k,{"is-bottom":!1,"price-data":e.productInfo.marketPrice},null,8,["price-data"])]),_:1})):C("",!0)]),_:1})),u(g,{class:"title-top-panle"},{default:i(()=>[u(g,{class:"title-top-panle-collect",onClick:P},{default:i(()=>[u(g,{class:I(["iconfont-h5 icon-shoucang1",{"icon-yishoucang":V.value}])},{default:i(()=>[u(b)]),_:1},8,["class"]),u(g,{class:"title-panle-collect-text"},{default:i(()=>[n(r(t.$t("收藏")),1)]),_:1})]),_:1}),u(g,{class:"title-top-panle-collect",onClick:Y(z,["stop"])},{default:i(()=>[u(g,{class:"iconfont-h5 icon-fenxiang"}),u(g,{class:"title-panle-collect-text"},{default:i(()=>[n(r(t.$t("分享")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e.promotionList.length>0?(o(),s(g,{key:0,class:"activity-box",onClick:T},{default:i(()=>[u(g,{class:"flex"},{default:i(()=>[(o(!0),d(_,null,p(e.promotionList.length>2?e.promotionList.slice(0,2):e.promotionList,e=>(o(),s(Fe,{key:e.promotionId,"activity-info":e,"card-type":"detail"},null,8,["activity-info"]))),128))]),_:1}),u(g,{class:"activity-btn"},{default:i(()=>[n(r(t.$t("领券")),1),u(b,{class:"iconfont-h5 icon-youjiantou"})]),_:1})]),_:1})):C("",!0),e.isSeckill||e.isDiscount?C("",!0):(o(),d(_,{key:1},[u(g,{class:"title-info-bottom line2"},{default:i(()=>[n(r(e.productInfo.productName),1)]),_:1}),e.productInfo.productBrief?(o(),s(g,{key:0,class:"description line2"},{default:i(()=>[n(r(e.productInfo.productBrief),1)]),_:1})):C("",!0)],64)),u(ot,{modelValue:j.value,"onUpdate:modelValue":h[0]||(h[0]=e=>j.value=e),"product-id":Number(S.value),"product-info":e.productInfo,"product-price":e.productPrice},null,8,["modelValue","product-id","product-info","product-price"])]),_:1})}}}),[["__scopeId","data-v-4585651e"]]),ut=h(e({__name:"productSeckillTitle",props:{productInfo:{},productPrice:{},productOriginPrice:{},seckillValue:{}},setup(e){const d=e;console.log("seckillValue",d.seckillValue);const p=t(()=>d.seckillValue.seckillStock),f=t(()=>{return e=d.seckillValue.seckillSales,t=d.seckillValue.seckillStock,Math.round(e/(t+e)*100)+"%";var e,t});return(e,t)=>{const d=a(l("format-price"),Te),m=c,v=a(l("tig-countdown"),Be);return o(),s(m,{class:"product-seckill-title flex justify-between align-center"},{default:i(()=>[u(m,{class:"seckill-price-box"},{default:i(()=>[u(m,{class:"title-top-price"},{default:i(()=>[u(m,{class:"price-box"},{default:i(()=>[u(m,{class:"price"},{default:i(()=>[u(d,{"font-style":{fontWeight:"bold"},"decimals-style":{fontSize:"24rpx",fontWeight:"bold"},"currency-style":{fontSize:"23rpx",fontWeight:"bold"},"price-data":e.productPrice},null,8,["price-data"])]),_:1}),u(m,{class:"tag-text-box"},{default:i(()=>[u(m,{class:"tag-text"},{default:i(()=>[n(r(e.$t("秒杀价")),1)]),_:1})]),_:1})]),_:1}),u(m,{class:"title-top-market_price flex align-center"},{default:i(()=>[e.productOriginPrice&&Number(e.productOriginPrice)>Number(e.productPrice)?(o(),s(m,{key:0,class:"originalprice-box"},{default:i(()=>[n(r(e.$t("价格"))+" ",1),u(m,null,{default:i(()=>[u(d,{"is-bottom":!1,"price-data":e.productOriginPrice,"font-style":{"text-decoration":"line-through"}},null,8,["price-data"])]),_:1})]),_:1})):C("",!0)]),_:1})]),_:1})]),_:1}),u(m,{class:"seckill-time-box"},{default:i(()=>[u(m,{class:"countdown-box flex align-center"},{default:i(()=>[u(m,{class:"title-top-time"},{default:i(()=>[n(r(e.$t("距结束还剩")),1)]),_:1}),u(v,{"end-time":e.seckillValue.seckillEndTime,"font-size":11,color:"#fff"},null,8,["end-time"])]),_:1}),u(m,{class:"stock-progress"},{default:i(()=>[u(m,{class:"progress-line-box"},{default:i(()=>[u(m,{class:"progress-line",style:x({width:`${f.value}`})},null,8,["style"])]),_:1}),u(m,{class:"progress-text"},{default:i(()=>[n(r(e.$t("仅剩"))+" "+r(p.value)+" "+r(e.$t("件")),1)]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-575520e7"]]),ct=h(e({__name:"productDiscountTitle",props:{productInfo:{},productPrice:{},productOriginPrice:{},discountValue:{},productStock:{}},setup:e=>(e,t)=>{const d=a(l("format-price"),Te),p=c,f=a(l("tig-countdown"),Be);return o(),s(p,{class:"product-seckill-title flex justify-between align-center"},{default:i(()=>[u(p,{class:"seckill-price-box"},{default:i(()=>[u(p,{class:"title-top-price"},{default:i(()=>[u(p,{class:"price-box"},{default:i(()=>[u(p,{class:"price"},{default:i(()=>[u(d,{"font-style":{fontWeight:"bold"},"decimals-style":{fontSize:"24rpx",fontWeight:"bold"},"currency-style":{fontSize:"23rpx",fontWeight:"bold"},"price-data":e.productPrice},null,8,["price-data"])]),_:1}),u(p,{class:"tag-text-box"},{default:i(()=>[u(p,{class:"tag-text"},{default:i(()=>[n(r(e.$t("直降"))+" ",1),u(d,{"is-bottom":!1,"font-style":{fontWeight:"bold"},"price-data":e.discountValue.discountPrice},null,8,["price-data"])]),_:1})]),_:1})]),_:1}),u(p,{class:"title-top-market_price flex align-center"},{default:i(()=>[e.productOriginPrice&&Number(e.productOriginPrice)>Number(e.productPrice)?(o(),s(p,{key:0,class:"originalprice-box"},{default:i(()=>[n(r(e.$t("价格"))+" ",1),u(p,null,{default:i(()=>[u(d,{"is-bottom":!1,"price-data":e.productOriginPrice,"font-style":{"text-decoration":"line-through"}},null,8,["price-data"])]),_:1})]),_:1})):C("",!0),u(p,{class:"discountStock"},{default:i(()=>[u(p,null,{default:i(()=>[n(r(e.$t("剩余"))+" "+r(e.productStock),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),u(p,{class:"seckill-time-box"},{default:i(()=>[u(p,{class:"type-box"},{default:i(()=>[u(p,{class:"type-text"},{default:i(()=>[n(r(e.$t("限时折扣")),1)]),_:1})]),_:1}),u(p,{class:"countdown-box flex align-center"},{default:i(()=>[u(p,{class:"title-top-time"},{default:i(()=>[n(r(e.$t("距结束还剩")),1)]),_:1}),u(f,{"background-color":"rgba(0, 0, 0, .06)","end-time":e.discountValue.discountEndTime,"font-size":11,color:"#fff"},null,8,["end-time"])]),_:1})]),_:1})]),_:1})}}),[["__scopeId","data-v-f6f4456a"]]),nt=h(e({__name:"productComment",props:{productId:{}},emits:["change"],setup(e,{emit:t}){const v=b(!1),y=b({}),h=b([]),g=b(1),k=b(10),x=e=>{G({url:e})},I=b([]),$=b(0);return Q(e=>{if(e){const{id:t}=e;t&&((async e=>{v.value=!0;try{const t=await ze(e);y.value=t}catch(t){}finally{v.value=!1}})(t),(async e=>{v.value=!0;try{const t=await Le(e,{type:1,page:g.value});h.value=t.records}catch(t){F({title:t.message,icon:"none"})}finally{v.value=!1}})(t),(async e=>{try{const t=await Ue({productId:e,page:g.value,size:k.value});I.value=t.records,$.value=t.total}catch(t){}finally{v.value=!1}})(t))}}),(e,t)=>{const v=w,g=c,k=a(l("uni-icons"),Ee),b=f,I=a(l("uni-rate"),Re);return o(),s(g,{class:"product-comment-card"},{default:i(()=>[u(g,{class:"comment-title flex justify-between align-center"},{default:i(()=>[u(g,{class:"txt"},{default:i(()=>[n(r(e.$t("评价")),1),u(v,null,{default:i(()=>[n("("+r(y.value.total??0)+")",1)]),_:1})]),_:1}),u(g,{class:"more",onClick:t[0]||(t[0]=t=>x(`/pages/product/comment?id=${e.productId}`))},{default:i(()=>[n(r(e.$t("好评")),1),u(v,null,{default:i(()=>[n(r(y.value.goodPercent??0)+"%",1)]),_:1}),u(k,{type:"right",size:"16",color:"#bfbfbf"})]),_:1})]),_:1}),h.value.length>0?(o(!0),d(_,{key:0},p(h.value.slice(0,2),(e,t)=>(o(),s(g,{key:t,class:"comment-item"},{default:i(()=>[u(g,{class:"user-info flex justify-between align-center"},{default:i(()=>[u(g,{class:"user-name flex align-center"},{default:i(()=>[u(g,{class:"head_logo"},{default:i(()=>[u(b,{src:m(P)((null==e?void 0:e.avatar)||"")},null,8,["src"])]),_:2},1024),u(g,null,{default:i(()=>[u(v,null,{default:i(()=>[n(r(e.username),1)]),_:2},1024),u(I,{readonly:!0,value:e.commentRank,size:"14",color:"#bfbfbf","active-color":"#ffa800"},null,8,["value"])]),_:2},1024)]),_:2},1024),u(g,{class:"time"},{default:i(()=>[n(r(e.addTime),1)]),_:2},1024)]),_:2},1024),u(g,{class:"user-content"},{default:i(()=>[n(r(e.content),1)]),_:2},1024),u(g,{class:"user-imgs flex-wrap align-center"},{default:i(()=>[(o(!0),d(_,null,p(e.showPics,(e,t)=>(o(),s(b,{key:t,src:m(P)(e.picThumb),onClick:t=>{return a=m(P)((null==e?void 0:e.picUrl)||""),void U({urls:[a]});var a}},null,8,["src","onClick"]))),128))]),_:2},1024)]),_:2},1024))),128)):(o(),s(g,{key:1,class:"no-data"},{default:i(()=>[n(r(e.$t("暂无评价"))+"~ ",1)]),_:1})),u(g,{class:"comment-btn-box flex align-center justify-around"},{default:i(()=>[u(g,{class:"btn flex align-center",onClick:t[1]||(t[1]=t=>x(`/pages/product/comment?id=${e.productId}`))},{default:i(()=>[u(k,{type:"chat",size:"20",color:"#333"}),u(v,null,{default:i(()=>[n(r(e.$t("全部评价"))+"("+r(y.value.total??0)+")",1)]),_:1})]),_:1}),u(g,{class:"btn flex align-center",onClick:t[2]||(t[2]=t=>x(`/pages/product/consult?id=${e.productId}`))},{default:i(()=>[u(k,{type:"chatboxes",size:"20",color:"#333"}),u(v,null,{default:i(()=>[n(r(e.$t("购买咨询"))+"("+r($.value??0)+")",1)]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-2ca28625"]]),rt=h(e({__name:"productCoupon",props:{modelValue:{type:Boolean,default:!1},promotionList:{type:Array,default:()=>[]},productId:{type:Number,default:0}},emits:["update:modelValue"],setup(e,{emit:f}){const{t:m}=D(),v=e;console.log(v.promotionList);const y=f,h=t({get:()=>v.modelValue,set(e){y("update:modelValue",e)}}),g={3:m("满减"),4:m("满折"),5:m("满赠")},k=t(()=>v.promotionList.filter(e=>3===e.type||4===e.type)),x=t(()=>v.promotionList.filter(e=>5===e.type)),w=(b(!1),(e,t,a)=>0===t?1===e?"已领取":a>0?"再次领取":"马上领":0===e?"马上领":a>=t?"已领取":"再次领取"),$=b([]),V=async()=>{try{const e=await De(Number(v.productId));$.value=e}catch(e){console.error(e.message)}};return K(()=>v.productId,e=>{e&&e>0&&V()}),(e,t)=>{const f=c,v=a(l("format-price"),Te),y=a(l("tig-image"),be),b=ee,S=a(l("tig-button"),Ie),T=a(l("tig-fixed-placeholder"),We),N=a(l("tig-popup"),we);return o(),s(N,{show:h.value,"onUpdate:show":t[1]||(t[1]=e=>h.value=e),"z-index":999,"show-close":!1,"background-color":"#fff"},{default:i(()=>[u(f,{class:"coupon-content"},{default:i(()=>[u(f,{class:"coupon-title"},{default:i(()=>[n(r(e.$t("优惠")),1)]),_:1}),u(b,{"scroll-y":"true",class:"promotion-box"},{default:i(()=>[u(f,{class:"promotion-content"},{default:i(()=>[C("",!0),k.value.length>0||x.value.length>0?(o(),s(f,{key:1,class:"activity-box"},{default:i(()=>[u(f,{class:"public-title"},{default:i(()=>[n(r(e.$t("促销")),1)]),_:1}),k.value.length>0?(o(!0),d(_,{key:0},p(k.value,e=>(o(),s(f,{key:e.promotionId,class:"activity-item"},{default:i(()=>[u(f,{class:"activity-item-label"},{default:i(()=>[n(r(g[e.type]),1)]),_:2},1024),u(f,{class:"activity-item-value"},{default:i(()=>[u(f,{class:"activity-item-name"},{default:i(()=>[n(r(e.data.promotionName),1)]),_:2},1024),u(f,{class:"activity-item-time"},{default:i(()=>{var t;return[n(r(null==(t=null==e?void 0:e.data)?void 0:t.startTime)+"~"+r(e.data.endTime),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):C("",!0),x.value.length>0?(o(!0),d(_,{key:1},p(x.value,t=>(o(),d(_,{key:t.promotionId},[(o(!0),d(_,null,p(t.data.promotionDesc,t=>(o(),s(f,{key:t.giftId,class:"activity-item"},{default:i(()=>[u(f,{class:"activity-item-label"},{default:i(()=>[n(r(e.$t("满赠")),1)]),_:1}),u(f,{class:"activity-product"},{default:i(()=>[u(f,{class:"activity-name"},{default:i(()=>[n(r(t.desc),1)]),_:2},1024),u(b,{class:"scroll-x","scroll-x":"true"},{default:i(()=>[u(f,{class:"activity-product-item",onClick:e=>{return a=t.gift.productInfo.productId,void G({url:`/pages/product/index?id=${a}`});var a}},{default:i(()=>[u(y,{src:t.gift.productInfo.picThumb,class:"gift-img"},null,8,["src"]),u(f,{class:"gift-price"},{default:i(()=>[u(v,{"show-text":!1,"font-style":{fontSize:"18rpx",fontWeight:"bold"},"is-bottom":!1,"price-data":t.gift.productInfo.productPrice},null,8,["price-data"])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))],64))),128)):C("",!0)]),_:1})):C("",!0),$.value.length>0?(o(),s(f,{key:2,class:"coupon-box"},{default:i(()=>[u(f,{class:"public-title"},{default:i(()=>[n(r(e.$t("可领优惠券")),1)]),_:1}),(o(!0),d(_,null,p($.value,t=>(o(),s(f,{key:t.couponId,class:"coupon-item"},{default:i(()=>[u(f,{class:"left"},{default:i(()=>[u(f,{class:"col-1"},{default:i(()=>[u(f,{class:"title"},{default:i(()=>[n(r(t.couponName),1)]),_:2},1024)]),_:2},1024),t.couponDesc?(o(),s(f,{key:0,class:"col-2"},{default:i(()=>[n(r(t.couponDesc),1)]),_:2},1024)):C("",!0),1===t.sendType?(o(),s(f,{key:1,class:I(["col-3",{"special-col":!t.couponDesc}])},{default:i(()=>[n(r(e.$t("有效期"))+"："+r(t.useEndDate),1)]),_:2},1032,["class"])):C("",!0),0===t.sendType&&t.delayDay>0?(o(),s(f,{key:2,class:I(["col-3",{"special-col":!t.couponDesc}])},{default:i(()=>[n(r(`领券${t.delayDay}天后生效，有效期${t.useDay}天`),1)]),_:2},1032,["class"])):C("",!0),0===t.sendType&&0===t.delayDay?(o(),s(f,{key:3,class:I(["col-3",{"special-col":!t.couponDesc}])},{default:i(()=>[n(r(`领券当日起${t.useDay}天内可用`),1)]),_:2},1032,["class"])):C("",!0)]),_:2},1024),u(f,{class:"right"},{default:i(()=>[u(f,{class:"right-1"},{default:i(()=>[2===t.couponType?(o(),d(_,{key:0},[u(f,{class:"zhekou"},{default:i(()=>[n(r(t.couponDiscount),1)]),_:2},1024),u(f,{class:"zhe"},{default:i(()=>[n(r(e.$t("折")),1)]),_:1})],64)):(o(),s(v,{key:1,"show-text":!1,"font-style":{fontSize:"48rpx",lineHeight:1,fontWeight:"400"},"currency-style":{selfAlign:"end",fontSize:"28rpx"},"price-data":t.couponMoney},null,8,["price-data"]))]),_:2},1024),"已领取"!==w(t.isReceive,t.limitNum,t.receiveNum)?(o(),s(f,{key:0,class:"right-2"},{default:i(()=>[u(f,null,{default:i(()=>[u(S,{"custom-style":{height:"55rpx"},onClick:e=>(async e=>{if(!(1===e.isReceive&&e.limitNum>0&&e.receiveNum>=e.limitNum))try{await Ye({couponId:e.couponId}),F({title:m("领取成功"),duration:1e3}),setTimeout(()=>{V()},500)}catch(t){console.log("error",t),F({title:t.message,icon:"none"})}})(t)},{default:i(()=>[n(r(w(t.isReceive,t.limitNum,t.receiveNum)),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):(o(),s(f,{key:1,class:"already-received-box"},{default:i(()=>[u(f,{class:"already-received-content"},{default:i(()=>[u(f,{class:"already-received-text"},{default:i(()=>[n(r(w(t.isReceive,t.limitNum,t.receiveNum)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))]),_:2},1024),u(f,{class:"dotted-line"})]),_:2},1024))),128))]),_:1})):C("",!0),u(T,{"background-color":"#fff"},{default:i(()=>[u(f,{class:"btn-box"},{default:i(()=>[u(S,{onClick:t[0]||(t[0]=t=>e.$emit("update:modelValue",!1))},{default:i(()=>[n(r(e.$t("我知道了")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])}}}),[["__scopeId","data-v-039c745e"]]),dt=h(e({__name:"afterSaleService",props:{id:{type:[String,Number],default:""}},setup(e){const t=e,a=b({});return te(()=>{t.id&&(async e=>{try{const t=await Ae(e);Object.assign(a.value,t)}catch(t){F({title:t.message,icon:"none"})}})(t.id)}),(e,t)=>{const l=ae,n=c;return o(),s(n,null,{default:i(()=>[u(n,{class:"tab_body"},{default:i(()=>[u(l,{nodes:a.value.templateContent},null,8,["nodes"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-1aab8d0a"]]),pt=h(e({__name:"productContent",props:{descArr:{type:Array,default:()=>[]},productId:{type:Number,default:0},productType:{type:Number,default:1},isBuy:{type:Number,default:0},paidContent:{type:Array,default:()=>[]}},setup(e){const t=b(0);return(a,l)=>{const v=c,y=f,h=ae;return o(),s(v,{class:"product-card-row product-detail-area"},{default:i(()=>[u(v,{class:"tab-box flex align-center justify-around"},{default:i(()=>[u(v,{class:I(["tab",{active:0==t.value}]),onClick:l[0]||(l[0]=e=>t.value=0)},{default:i(()=>[n(r(a.$t("商品介绍")),1)]),_:1},8,["class"]),u(v,{class:I(["tab",{active:1==t.value}]),onClick:l[1]||(l[1]=e=>t.value=1)},{default:i(()=>[n(r(a.$t("售后服务")),1)]),_:1},8,["class"])]),_:1}),0==t.value?(o(),s(v,{key:0,class:"default"},{default:i(()=>[(o(!0),d(_,null,p(e.descArr,(e,t)=>(o(),d(_,{key:t},["pic"==e.type?(o(),s(v,{key:0,class:"desc-pic-item"},{default:i(()=>[u(y,{"lazy-load":"",src:m(P)((null==e?void 0:e.pic)||""),class:"slide-image",mode:"widthFix"},null,8,["src"])]),_:2},1024)):C("",!0),"text"==e.type?(o(),s(h,{key:1,class:"desc-text-item",nodes:m(le)(e.html)},null,8,["nodes"])):C("",!0)],64))),128))]),_:1})):C("",!0),T(u(v,{class:"default"},{default:i(()=>[u(dt,{id:e.productId},null,8,["id"])]),_:1},512),[[j,1==t.value]])]),_:1})}}}),[["__scopeId","data-v-926caadc"]]),ft=h(e({__name:"animation",props:se({animationPosition:{},styleVariable:{}},{modelValue:{default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(e){g(e=>({"308cbeac":t.animationPosition.top+"px","15ec9c58":t.animationPosition.left+"px"}));const t=e,a=oe(e,"modelValue"),l=()=>{a.value=!1};return(e,t)=>{const n=c;return o(),s(n,{class:I(["animation-box",{animation:a.value}]),style:x({...e.styleVariable})},{default:i(()=>[u(n,{class:"animation-content",onAnimationend:l})]),_:1},8,["class","style"])}}}),[["__scopeId","data-v-ff3fea6d"]]),mt=h(e({__name:"error",setup(e){const t=()=>{y({url:"/pages/index/index"}),console.log("Redirecting to home page")};return(e,a)=>{const l=c;return o(),s(l,{class:"error-page"},{default:i(()=>[u(l,{class:"error-content"},{default:i(()=>[u(l,{class:"error-image"}),u(l,{class:"error-text"},{default:i(()=>[n(r(e.$t("页面失效")),1)]),_:1}),u(l,{class:"error-btn-box"},{default:i(()=>[u(l,{theme:"",class:"error-btn",onClick:t},{default:i(()=>[n(r(e.$t("进店逛逛")),1)]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-4bf9452b"]]),vt=h(e({__name:"index",setup(e){const h=J(),{scrollTop:g}=$e(),I=b(0),$=b(!1),V=k(),N=b(),z=b(0),L=b({top:0,left:0}),U=b(),D=b(""),O=b(0),F=()=>{$.value=!0},E=()=>{N.value&&N.value.handleShowPopup()},R=b({productId:0,productStock:0}),X=b({}),M=b([]),W=b([]),Z=b([]),H=b({}),K=b([]),q=b([]),te=b([]),ae=b(!1),le=b(!0),se=()=>{le.value=!1},oe=b(""),Ie=b("0"),Te=b("0"),Ne=b(0),Pe=b(0),je=b({}),ze=b(1),Le=b([]),Ue=b(0),De=b({}),Ae=b(""),Fe=e=>{e.productSkuId&&e.skuStr&&(oe.value=e.skuStr),Ne.value=e.productStock,Le.value=e.promotionList,Ie.value=e.productPrice,Te.value=e.productOriginPrice,ze.value=e.productNumber,Pe.value=e.isSeckill,je.value=e.seckillValue,Ue.value=e.isDiscount,De.value=e.discountValue,Ae.value=e.discountEndTime},Be=b(0),Ee=async()=>{try{const e=await Je();Be.value=e}catch(e){}},Re=b(!1),We=t(()=>{if(X.value.normal&&X.value.normal.length){return X.value.normal.map(e=>e.attrName).join("/")}return""}),Ye=()=>{ye({url:"/pages/index/index"})},Ke=()=>{G({url:"/pages/search/result"})},Qe=S(),et=b(A()),tt=e=>{const t=he().in(Qe);t.select(e).boundingClientRect(),t.selectViewport().scrollOffset(()=>{}),t.exec(e=>{ge({scrollTop:e[0].top+e[1].scrollTop-50,duration:0})})},at=b(".product-area");let lt,st,ot;const dt=(e,t)=>{e.relativeToViewport({bottom:-(et.value.windowHeight-200)}).observe(t,e=>{e.intersectionRatio>0&&(at.value=t)})};ie(()=>{lt=ue(Qe),st=ue(Qe),ot=ue(Qe),dt(lt,".product-area"),dt(st,".evaluate-area"),dt(ot,".product-detail-area")}),ce(()=>{lt&&lt.disconnect(),lt=null,st&&st.disconnect(),st=null,ot&&ot.disconnect(),ot=null,ne()});const vt=b(0);Q(e=>{e&&(e.type&&(D.value=e.type),e.id&&(async e=>{try{let t={};"exchange"===D.value?(t=await Xe(e),O.value=t.exchangeInfo.exchangeIntegral,Ne.value=t.exchangeInfo.productStock,Ie.value=t.exchangeInfo.discountsPrice||"0",z.value=t.exchangeInfo.id):(t=await Oe(e),Ne.value=t.item.productStock,Ie.value=t.item.productPrice||"0",z.value=t.item.productId),I.value=t.item.productId,R.value=t.item,X.value=t.attrList,W.value=t.picList,te.value=t.videoList,H.value=t.rankDetail,M.value=t.skuList,q.value=t.checkedValue,K.value=t.descArr,Z.value=t.serviceList,fe({title:t.item.productName}),me(()=>{var e;null==(e=U.value)||e.handleLog()})}catch(t){console.error(t),ae.value=!0,le.value=!1}})(Number(e.id)),e.skuId&&(vt.value=Number(e.skuId)),e.salesmanId&&((e,t)=>{let a=B("salesmanProducts")||[];if(a.length>0){const l=a.findIndex(e=>e.productId==t);-1!==l&&(a[l].salesmanId=e)}a=[...a,{salesmanId:e,productId:t}],ve("salesmanProducts",a)})(e.salesmanId,e.id))}),re(()=>{Ee()});const _t=b(!1),yt=async e=>{await kt(".cart-position"),await ht(".cart"),_t.value=e,Ee()},ht=async e=>{const t=await ke(e);if(t){const{width:e,height:a,top:l,left:s}=t;L.value.top=l-a/2,L.value.left=s+e/2}},gt=b({left:0,top:0}),kt=async e=>{const t=await ke(e);if(t){const{width:e,height:a,top:l,left:s}=t;gt.value.top=l-a/2,gt.value.left=s+e/2}},bt=t(()=>({"--x":gt.value.left-L.value.left+"px","--y":"8px"}));de(()=>({title:R.value.productName,imageUrl:P(R.value.picUrl)})),pe(()=>({title:R.value.productName,imageUrl:P(R.value.picUrl)}));const xt=t(()=>h.serviceConfig.show);return(e,t)=>{const h=c,k=f,b=a(l("tig-image"),be),S=w,P=a(l("uni-badge"),xe),A=ee,B=a(l("tig-popup"),we),M=a(l("tig-back-top"),Se),H=a(l("tig-layout"),Ve),J=a(l("tig-loadingpage"),Ce);return o(),s(h,null,{default:i(()=>[u(H,{ref_key:"layoutRef",ref:U,"immediate-log":!1,"product-id":I.value,"shop-id":R.value.shopId},{default:i(()=>[ae.value?(o(),d(_,{key:1},[u(mt),u(He,{"title-bg":"#fff"})],64)):T((o(),s(h,{key:0},{default:i(()=>[u(qe,{modelValue:m(g),"onUpdate:modelValue":t[0]||(t[0]=e=>_e(g)?g.value=e:null),"active-module":at.value,"onUpdate:activeModule":t[1]||(t[1]=e=>at.value=e),event:tt},null,8,["modelValue","active-module"]),u(Ge,{class:"product-area","video-list":te.value,"pic-list":W.value,"product-info":R.value,"seckill-value":je.value},null,8,["video-list","pic-list","product-info","seckill-value"]),Pe.value?(o(),s(ut,{key:0,"product-info":R.value,"product-origin-price":Te.value,"product-price":Ie.value,"seckill-value":je.value},null,8,["product-info","product-origin-price","product-price","seckill-value"])):C("",!0),Ue.value?(o(),s(ct,{key:1,"product-info":R.value,"product-origin-price":Te.value,"product-price":Ie.value,"discount-value":De.value,"product-stock":Ne.value},null,8,["product-info","product-origin-price","product-price","discount-value","product-stock"])):C("",!0),u(h,{class:"productDetail-content",style:x({"padding-bottom":(0===R.value.productStatus||0===Ne.value?160:100)+"rpx"})},{default:i(()=>[u(it,{"show-coupon":Re.value,"onUpdate:showCoupon":t[2]||(t[2]=e=>Re.value=e),"is-seckill":Pe.value,"promotion-list":Le.value,"product-info":R.value,"product-price":Ie.value,"is-discount":Ue.value,type:D.value,"exchange-integral":O.value},null,8,["show-coupon","is-seckill","promotion-list","product-info","product-price","is-discount","type","exchange-integral"]),u(h,{class:"product-card-row"},{default:i(()=>{var t;return[u(h,{class:"cart-item flex align-center justify-between",onClick:E},{default:i(()=>[u(h,{class:"flex align-center"},{default:i(()=>[u(h,{class:"title"},{default:i(()=>[n(r(e.$t("规格")),1)]),_:1}),u(h,{class:"label"},{default:i(()=>[n(r(e.$t(oe.value))+" "+r(e.$t(ze.value))+" "+r(e.$t("件")),1)]),_:1})]),_:1}),u(h,null,{default:i(()=>[u(k,{class:"icon-image",src:m(v)("common/more.png")},null,8,["src"])]),_:1})]),_:1}),m(V).showSelledCount||(null==(t=X.value.normal)?void 0:t.length)>0||1===R.value.fixedShippingType||Z.value.length>0?(o(),s(h,{key:0,class:"card-row-flex"},{default:i(()=>{var t;return[m(V).showSelledCount?(o(),s(h,{key:0,class:"cart-item flex align-center justify-between"},{default:i(()=>[u(h,{class:"flex align-center"},{default:i(()=>[u(h,{class:"title"},{default:i(()=>[n(r(e.$t("销量")),1)]),_:1}),u(h,{class:"label"},{default:i(()=>[n(r(R.value.virtualSales)+" "+r(e.$t("件")),1)]),_:1})]),_:1})]),_:1})):C("",!0),(null==(t=X.value.normal)?void 0:t.length)>0?(o(),s(h,{key:1,class:"cart-item flex align-center justify-between",onClick:F},{default:i(()=>[u(h,{class:"flex align-center"},{default:i(()=>[u(h,{class:"title"},{default:i(()=>[n(r(e.$t("参数")),1)]),_:1}),u(h,{class:"label attr_text line1"},{default:i(()=>[u(h,{class:"shuxin"},{default:i(()=>[n(r(e.$t(We.value)),1)]),_:1})]),_:1})]),_:1}),u(h,null,{default:i(()=>[u(k,{class:"icon-image",":src":m(v)("common/more.png")},null,8,[":src"])]),_:1})]),_:1})):C("",!0),1===R.value.fixedShippingType&&0==Number(R.value.fixedShippingFee)?(o(),s(h,{key:2,class:"cart-item flex align-center justify-between"},{default:i(()=>[u(h,{class:"flex align-center"},{default:i(()=>[u(h,{class:"title"},{default:i(()=>[n(r(e.$t("运费")),1)]),_:1}),u(h,{class:"label attr_text line1"},{default:i(()=>[u(h,{class:"shuxin"},{default:i(()=>[n(r(e.$t("包邮")),1)]),_:1})]),_:1})]),_:1}),u(h,null,{default:i(()=>[u(k,{class:"icon-image",":src":m(v)("common/more.png")},null,8,[":src"])]),_:1})]),_:1})):C("",!0),Z.value.length>0?(o(),s(h,{key:3,class:"cart-item"},{default:i(()=>[u(h,{class:"flex"},{default:i(()=>[u(h,{class:"title"},{default:i(()=>[n(r(e.$t("服务")),1)]),_:1}),u(h,{class:"label flex-wrap align-center servicelist"},{default:i(()=>[(o(!0),d(_,null,p(Z.value,(e,t)=>(o(),d("span",{key:t,class:"flex align-center service-item"},[e.icoImg?(o(),s(b,{key:0,style:{width:"15px",height:"15px"},src:e.icoImg},null,8,["src"])):C("",!0),n(r(e.productServiceName),1)]))),128))]),_:1})]),_:1})]),_:1})):C("",!0)]}),_:1})):C("",!0)]}),_:1}),u(nt,{class:"evaluate-area","product-id":R.value.productId},null,8,["product-id"]),u(pt,{"is-buy":R.value.isBuy,"paid-content":R.value.paidContent,"product-type":R.value.productType,"desc-arr":K.value,"product-id":R.value.productId,class:"product-detail-area"},null,8,["is-buy","paid-content","product-type","desc-arr","product-id"])]),_:1},8,["style"]),4!==R.value.productType||1!==R.value.isBuy?(o(),s(h,{key:2,style:x({"padding-bottom":m(V).safeBottom+"rpx"}),class:"bottom-bar-box"},{default:i(()=>[u(h,{class:"bottom-bar flex align-center"},{default:i(()=>[u(h,{class:"icon-box"},{default:i(()=>[u(h,{class:"label",onClick:Ye},{default:i(()=>[u(h,null,{default:i(()=>[u(k,{mode:"widthFix",src:m(v)("product/home.png"),class:"img"},null,8,["src"])]),_:1}),u(h,{class:"label-text"},{default:i(()=>[u(S,null,{default:i(()=>[n(r(e.$t("首页")),1)]),_:1})]),_:1})]),_:1}),xt.value?(o(),s(h,{key:0,class:"label"},{default:i(()=>[u(Ze,{"product-id":I.value},{default:i(()=>[u(h,null,{default:i(()=>[u(k,{mode:"widthFix",src:m(v)("product/service.png"),class:"img"},null,8,["src"])]),_:1}),u(h,{class:"label-text"},{default:i(()=>[u(S,null,{default:i(()=>[n(r(e.$t("客服")),1)]),_:1})]),_:1})]),_:1},8,["product-id"])]),_:1})):C("",!0),u(h,{class:"label cart-position",onClick:t[3]||(t[3]=Y(e=>{y({url:"/pages/cart/cartJump"})},["stop"]))},{default:i(()=>[u(h,null,{default:i(()=>[u(P,{class:"uni-badge-left-margin badgecolor",text:Be.value,absolute:"rightTop",size:"small"},{default:i(()=>[u(k,{mode:"widthFix",src:m(v)("product/cart.png"),class:"img"},null,8,["src"])]),_:1},8,["text"])]),_:1}),u(h,{class:"label-text"},{default:i(()=>[u(S,null,{default:i(()=>[n(r(e.$t("购物车")),1)]),_:1})]),_:1})]),_:1})]),_:1}),u(h,{class:"btn-box"},{default:i(()=>[0===R.value.productStatus||0===Ne.value?(o(),s(h,{key:0,class:"other-products-btn",onClick:Ke},{default:i(()=>[n(r(e.$t("查看其他商品")),1)]),_:1})):(o(),d(_,{key:1},["exchange"===D.value?(o(),s(h,{key:0,class:"other-products-btn",onClick:E},{default:i(()=>[n(r(e.$t("立即兑换")),1)]),_:1})):(o(),d(_,{key:1},[1===R.value.productType?(o(),d(_,{key:0},[u(h,{class:"btn cart",onClick:E},{default:i(()=>[n(r(e.$t("加入购物车")),1)]),_:1}),u(h,{class:"btn buy",onClick:E},{default:i(()=>[n(r(e.$t("立即购买")),1)]),_:1})],64)):(o(),s(h,{key:1,class:"other-products-btn",onClick:E},{default:i(()=>[n(r(e.$t("立即购买")),1)]),_:1}))],64))],64))]),_:1}),0===R.value.productStatus||0===Ne.value?(o(),s(h,{key:0,class:"product-status"},{default:i(()=>[n(r(e.$t(0===R.value.productStatus?"商品已下架":"商品已售罄")),1)]),_:1})):C("",!0)]),_:1})]),_:1},8,["style"])):C("",!0),u(Me,{ref_key:"specificationRef",ref:N,modelValue:z.value,"onUpdate:modelValue":t[4]||(t[4]=e=>z.value=e),"sku-id":vt.value,"onUpdate:skuId":t[5]||(t[5]=e=>vt.value=e),type:D.value,onLoadEnd:se,onAddCardSucceed:yt,onSendValue:Fe},null,8,["modelValue","sku-id","type"]),u(rt,{modelValue:Re.value,"onUpdate:modelValue":t[6]||(t[6]=e=>Re.value=e),"product-id":Number(I.value),"promotion-list":Le.value},null,8,["modelValue","product-id","promotion-list"]),u(B,{show:$.value,"onUpdate:show":t[7]||(t[7]=e=>$.value=e)},{default:i(()=>[u(A,{"scroll-y":"true",class:"attr_table-box"},{default:i(()=>[u(h,{class:"popup-title title"},{default:i(()=>[n(r(e.$t("规格参数")),1)]),_:1}),u(h,{class:"attr_table"},{default:i(()=>[(o(!0),d(_,null,p(X.value.normal,(t,a)=>(o(),s(h,{key:a,class:"item flex"},{default:i(()=>[u(h,{class:"lable"},{default:i(()=>[n(r(e.$t(t.attrName)),1)]),_:2},1024),(o(!0),d(_,null,p(t.attrList,(e,t)=>(o(),s(h,{key:t,class:"value"},{default:i(()=>[n(r(e.attrValue),1)]),_:2},1024))),128))]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["show"]),u(M,{"scroll-top":m(g)},null,8,["scroll-top"]),u(ft,{modelValue:_t.value,"onUpdate:modelValue":t[8]||(t[8]=e=>_t.value=e),"style-variable":bt.value,"animation-position":L.value},null,8,["modelValue","style-variable","animation-position"])]),_:1},512)),[[j,!le.value]])]),_:1},8,["product-id","shop-id"]),u(J,{modelValue:le.value,"onUpdate:modelValue":t[9]||(t[9]=e=>le.value=e)},null,8,["modelValue"])]),_:1})}}}),[["__scopeId","data-v-dae91923"]]);export{vt as default};
