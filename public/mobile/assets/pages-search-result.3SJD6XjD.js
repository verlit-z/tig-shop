import{d as e,K as a,r as l,U as t,k as s,l as o,c as u,w as c,Q as r,B as i,E as n,o as d,g as p,i as f,a as m,N as y,f as b,t as v,I as g,J as _,O as k,V as h,W as x,h as w,X as I,F as C,Y as j,Z as z,M as $,$ as V,_ as N}from"./index-DE5OqlOG.js";import{_ as L}from"./uni-icons.BITEJ68A.js";import{_ as U}from"./empty-box.vue_vue_type_script_setup_true_lang.tb7lKy_c.js";import{_ as M}from"./loading-box.Cxf-hKGE.js";import{a as O,_ as S,b as W}from"./tig-layout.fowSnIDi.js";import{m as B}from"./masonry.CqYTyCF5.js";import{g as J,a as K,b as E,c as F}from"./search.BFVjb5qq.js";import{u as P}from"./useList.B4FtGhCx.js";import"./format-price.Cc34639m.js";import"./specification.BJJ9B7ka.js";import"./tig-image.h_tgFjnN.js";import"./uni-number-box.JWQxtRhY.js";import"./product.xxdbZFp6.js";import"./activityCard.mdMMZqu3.js";const Q=N(e({__name:"result",setup(e){const{t:N}=a(),Q=l("商品搜索"),{safeBottom:R}=O(),T=t({page:1,size:10,sort:"",order:"asc",keyword:"",max:"",min:"",cat:0,couponId:0,brand:[],intro:"",pageType:"search"}),X=l([]),Y=l([]),Z=l(""),q=l([]),A=l([]),D={new:N("新品"),hot:N("热销"),best:N("精品")},G=l([]),H=s(()=>q.value.length>3&&!ye.value?q.value.slice(0,3):q.value),ee=s(()=>T.cat?G.value:T.shopCategoryId?A.value:[]),{getList:ae,total:le,data:te,promotionList:se,isLoadMore:oe,isLoading:ue}=P(J,{params:T,path:{dataKey:"records"},needPromotionList:!0}),ce=async()=>{try{T.brand=Y.value.join(",");const e=await K({...T});if(X.value=e.filter.brand,q.value=e.filter.category,A.value=e.filter.shopCategory,Z.value=e.filterSelected.brand,T.cat){const e=await E(T.cat);G.value=e}if(T.shopCategoryId){const e=await F(T.shopCategoryId);A.value=e}}catch(e){r({title:e.message,icon:"none"})}},re=l("default"),ie=l([{label:"默认",value:"default"},{label:"销量",value:"sale"},{label:"价格",value:"price",order:"desc"}]),ne=e=>{switch(e){case"brand":Y.value=[],Z.value="";break;case"price":T.min="",T.max="";break;case"keyword":T.keyword="";break;case"intro":T.intro="";break;case"couponInfo":me.value={},T.couponId=0}ce(),_e(),ae(()=>({brand:Y.value.join(",")}))},de=l(!1),pe=()=>{de.value=!0},fe=()=>{V({url:"/pages/search/index"})},me=l({});o(e=>{console.log(e,"123123"),e&&(e.keyWords&&(T.keyword=e.keyWords),e.intro&&(T.intro=e.intro),e.categoryId&&(T.cat=e.categoryId),e.brandId&&Y.value.push(e.brandId),e.shopCategoryId&&(T.shopCategoryId=e.shopCategoryId),e.couponInfo&&(me.value=JSON.parse(decodeURIComponent(e.couponInfo)),T.couponId=me.value.couponId)),ce(),ae(()=>({brand:Y.value.join(",")}))});const ye=l(!1),be=l(!1),ve=()=>{Number(T.min)>Number(T.max)?r({title:N("最低价不能大于最高价"),icon:"none"}):(ce(),de.value=!1,_e(),ae(()=>({brand:Y.value.join(",")})))},ge=()=>{T.min="",T.max="",Y.value=[],T.cat=0},_e=()=>{le.value=0,T.page=1,T.intro="",te.value=[],se.value={}};return(e,a)=>{const l=i(n("uni-icons"),L),t=f,s=w,o=i(n("empty-box"),U),r=i(n("loading-box"),M),V=$,N=z,O=i(n("tig-popup"),W),J=i(n("tig-layout"),S);return d(),u(J,{title:Q.value},{default:c(()=>[p(t,{class:"pageMain productSort"},{default:c(()=>[p(t,{class:"header acea-row row-center-wrapper"},{default:c(()=>[p(t,{class:"acea-row row-between-wrapper input",onClick:y(fe,["stop"])},{default:c(()=>[p(l,{type:"search",size:"18",class:"sousuo"}),p(t,{class:"txt"},{default:c(()=>[b(v(e.$t("请输入搜索内容")),1)]),_:1})]),_:1})]),_:1}),p(t,{class:"tab-box flex align-center justify-between"},{default:c(()=>[(d(!0),g(_,null,k(ie.value,a=>(d(),u(t,{key:a.value,class:h(["item flex align-center",{active:re.value===a.value}]),onClick:e=>(e=>{"price"==e.value?e.order="desc"===e.order?"asc":"desc":e.order="",re.value=e.value,T.sort=e.value,T.order=e.order,ce(),_e(),ae(()=>T.brand=Y.value.join(","))})(a)},{default:c(()=>[p(s,null,{default:c(()=>[b(v(e.$t(a.label)),1)]),_:2},1024),x(p(t,{class:"price-ico-box flex flex-column"},{default:c(()=>[p(l,{type:"up",size:"8",class:h({order:"price"===re.value&&"asc"===a.order})},null,8,["class"]),p(l,{type:"down",size:"8",class:h({order:"price"===re.value&&"desc"===a.order})},null,8,["class"])]),_:2},1536),[[I,"price"===a.value]])]),_:2},1032,["class","onClick"]))),128)),p(t,{class:"item flex",onClick:pe},{default:c(()=>[p(s,null,{default:c(()=>[b(v(e.$t("筛选")),1)]),_:1}),p(l,{type:"right",size:"12",class:"sanjiaoright"})]),_:1})]),_:1}),p(t,{class:"tag-row"},{default:c(()=>[p(t,{class:"tag-list flex-wrap align-center"},{default:c(()=>[T.keyword?(d(),u(t,{key:0,class:"tag-item mr10 line1",onClick:a[0]||(a[0]=e=>ne("keyword"))},{default:c(()=>[p(s,{class:"line1"},{default:c(()=>[b(v(e.$t("搜索关键词"))+'"'+v(T.keyword)+'"',1)]),_:1}),p(l,{type:"closeempty",size:"10"})]),_:1})):m("",!0),T.intro?(d(),u(t,{key:1,class:"tag-item mr10",onClick:a[1]||(a[1]=e=>ne("intro"))},{default:c(()=>[p(s,null,{default:c(()=>[b(v(D[T.intro]),1)]),_:1}),p(l,{type:"closeempty",size:"10"})]),_:1})):m("",!0),me.value&&me.value.couponName?(d(),u(t,{key:2,class:"tag-item mr10",onClick:a[2]||(a[2]=e=>ne("coupon_info"))},{default:c(()=>[p(s,null,{default:c(()=>[b(v(e.$t("优惠券"))+': "'+v(me.value.couponName)+'"',1)]),_:1}),p(l,{type:"closeempty",size:"10"})]),_:1})):m("",!0),Z.value?(d(),u(t,{key:3,class:"tag-item mr10 brand",onClick:a[3]||(a[3]=e=>ne("brand"))},{default:c(()=>[p(s,null,{default:c(()=>[b(v(Z.value),1)]),_:1}),p(l,{type:"closeempty",size:"10"})]),_:1})):m("",!0),T.max||T.min?(d(),u(t,{key:4,class:"tag-item mr10",onClick:a[4]||(a[4]=e=>ne("price"))},{default:c(()=>[p(s,null,{default:c(()=>[b(v(T.min||0)+" - "+v(T.max||0),1)]),_:1}),p(l,{type:"closeempty",size:"10"})]),_:1})):m("",!0),ee.value.length>0?(d(!0),g(_,{key:5},k(ee.value,(e,a)=>(d(),u(t,{key:a,class:"flex align-center",onClick:e=>(e=>{e>0?T.shopCategoryId?T.shopCategoryId=A.value[e-1].categoryId:T.cat=G.value[e-1].categoryId:T.shopCategoryId?T.shopCategoryId=0:T.cat=0,ce(),_e(),ae(()=>({brand:Y.value.join(",")}))})(a)},{default:c(()=>[p(t,{class:"tag-item"},{default:c(()=>[p(s,null,{default:c(()=>[b(v(e.categoryName),1)]),_:2},1024),p(l,{type:"closeempty",size:"10"})]),_:2},1024),a<ee.value.length-1?(d(),u(t,{key:0,class:"tag-interval"},{default:c(()=>[p(l,{type:"right",size:"10"})]),_:1})):m("",!0)]),_:2},1032,["onClick"]))),128)):m("",!0)]),_:1})]),_:1}),!C(ue)&&C(le)>0?(d(),u(t,{key:0,class:"goods-container"},{default:c(()=>[p(B,{"commodity-list":C(te),"promotion-list":C(se)},null,8,["commodity-list","promotion-list"])]),_:1})):m("",!0),C(ue)||0!==C(le)?m("",!0):(d(),u(o,{key:1,mode:"search",background:"#f5f5f5"})),p(r,{modelValue:C(oe),"onUpdate:modelValue":a[5]||(a[5]=e=>j(oe)?oe.value=e:null),page:T.page,length:C(te).length},null,8,["modelValue","page","length"]),p(O,{show:de.value,"onUpdate:show":a[10]||(a[10]=e=>de.value=e),position:"right","z-index":900,"show-close":!1},{default:c(()=>[p(N,{"scroll-y":"true",class:"search_condition"},{default:c(()=>[p(t,{class:"search_condition-box"},{default:c(()=>[q.value.length>0?(d(),u(t,{key:0,class:"tab_box"},{default:c(()=>[p(t,{class:"title-box flex justify-between"},{default:c(()=>[p(t,{class:"txt"},{default:c(()=>[b(v(e.$t("分类")),1)]),_:1}),p(t,{class:"more",onClick:a[6]||(a[6]=e=>ye.value=!ye.value)},{default:c(()=>[ye.value?(d(),u(l,{key:0,type:"up",size:"16",color:"#bfbfbf"})):(d(),u(l,{key:1,type:"down",size:"16",color:"#bfbfbf"}))]),_:1})]),_:1}),p(t,{class:"tabs flex-wrap"},{default:c(()=>[(d(!0),g(_,null,k(H.value,(e,a)=>(d(),u(t,{key:a,class:h(["item",{active:T.cat==e.categoryId}]),onClick:a=>T.cat=e.categoryId},{default:c(()=>[T.cat==e.categoryId?(d(),u(l,{key:0,type:"checkmarkempty",size:"12"})):m("",!0),b(" "+v(e.categoryName),1)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})):m("",!0),X.value.length>0?(d(),u(t,{key:1,class:"tab_box"},{default:c(()=>[p(t,{class:"title-box flex justify-between"},{default:c(()=>[p(t,{class:"txt"},{default:c(()=>[b(v(e.$t("品牌")),1)]),_:1}),p(t,{class:"more",onClick:a[7]||(a[7]=e=>be.value=!be.value)},{default:c(()=>[be.value?(d(),u(l,{key:0,type:"up",size:"16",color:"#bfbfbf"})):(d(),u(l,{key:1,type:"down",size:"16",color:"#bfbfbf"}))]),_:1})]),_:1}),p(t,{class:"tabs flex-wrap"},{default:c(()=>[(d(!0),g(_,null,k(be.value?X.value:X.value.slice(0,3),(e,a)=>(d(),u(t,{key:a,class:h(["item",{active:Y.value.includes(e.brandId)}]),onClick:a=>(e=>{let a=Y.value.indexOf(e.brandId);-1!==a?Y.value.splice(a,1):Y.value.push(e.brandId)})(e)},{default:c(()=>[Y.value.includes(e.brandId)?(d(),u(l,{key:0,type:"checkmarkempty",size:"12"})):m("",!0),b(" "+v(e.brandName),1)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})):m("",!0),p(t,{class:"tab_box"},{default:c(()=>[p(t,{class:"title-box flex justify-between"},{default:c(()=>[p(t,{class:"txt"},{default:c(()=>[b(v(e.$t("价格")),1)]),_:1})]),_:1}),p(t,{class:"tabs flex justify-between align-center"},{default:c(()=>[p(V,{modelValue:T.min,"onUpdate:modelValue":a[8]||(a[8]=e=>T.min=e),class:"uni-input",type:"number",placeholder:e.$t("最低价")},null,8,["modelValue","placeholder"]),p(t,{class:"xian"}),p(V,{modelValue:T.max,"onUpdate:modelValue":a[9]||(a[9]=e=>T.max=e),class:"uni-input",type:"number",placeholder:e.$t("最高价")},null,8,["modelValue","placeholder"])]),_:1})]),_:1})]),_:1}),p(t,{class:h(["btn-box",{"safe-btn":C(R)>0}])},{default:c(()=>[p(t,{class:"flex btn-flex"},{default:c(()=>[p(t,{class:"btn",onClick:ge},{default:c(()=>[b(v(e.$t("重置")),1)]),_:1}),p(t,{class:"btn submit",onClick:ve},{default:c(()=>[b(v(e.$t("确定")),1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1})]),_:1},8,["show"])]),_:1})]),_:1},8,["title"])}}}),[["__scopeId","data-v-05cd0a5e"]]);export{Q as default};
